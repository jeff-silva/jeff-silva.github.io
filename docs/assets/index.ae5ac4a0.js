import{L as pg,m as UI,t as Ei,v as po,z as wt,A as Et,V as BI,M as pi,N as qI,B as ro,y as In,O as ke,x as kt,P as bu,Q as io,R as Nu,S as ad,T as $I,U as Ou,W as ud,X as WI,Y as zI,Z as GI,$ as HI,a0 as KI,a1 as QI,a2 as jI,a3 as YI,a4 as Xu,a5 as XI,a6 as JI,a7 as ZI,a8 as tA,a9 as eA}from"./entry.b5c9f054.js";var mi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nA(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Eo={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Eo.exports;(function(n,t){(function(){var e,i="4.17.21",o=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",m=500,_="__lodash_placeholder__",w=1,P=2,x=4,z=1,X=2,F=1,lt=2,Ot=4,yt=8,Kt=16,Qt=32,ve=64,Ee=128,rr=256,Hr=512,ls=30,Gm="...",Hm=800,Km=16,Pc=1,Qm=2,jm=3,On=1/0,dn=9007199254740991,Ym=17976931348623157e292,cs=0/0,$e=4294967295,Xm=$e-1,Jm=$e>>>1,Zm=[["ary",Ee],["bind",F],["bindKey",lt],["curry",yt],["curryRight",Kt],["flip",Hr],["partial",Qt],["partialRight",ve],["rearg",rr]],ir="[object Arguments]",hs="[object Array]",t_="[object AsyncFunction]",Kr="[object Boolean]",Qr="[object Date]",e_="[object DOMException]",fs="[object Error]",ds="[object Function]",Vc="[object GeneratorFunction]",xe="[object Map]",jr="[object Number]",n_="[object Null]",Je="[object Object]",Dc="[object Promise]",r_="[object Proxy]",Yr="[object RegExp]",be="[object Set]",Xr="[object String]",gs="[object Symbol]",i_="[object Undefined]",Jr="[object WeakMap]",s_="[object WeakSet]",Zr="[object ArrayBuffer]",sr="[object DataView]",ha="[object Float32Array]",fa="[object Float64Array]",da="[object Int8Array]",ga="[object Int16Array]",pa="[object Int32Array]",ma="[object Uint8Array]",_a="[object Uint8ClampedArray]",ya="[object Uint16Array]",va="[object Uint32Array]",o_=/\b__p \+= '';/g,a_=/\b(__p \+=) '' \+/g,u_=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xc=/&(?:amp|lt|gt|quot|#39);/g,bc=/[&<>"']/g,l_=RegExp(xc.source),c_=RegExp(bc.source),h_=/<%-([\s\S]+?)%>/g,f_=/<%([\s\S]+?)%>/g,Nc=/<%=([\s\S]+?)%>/g,d_=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,g_=/^\w*$/,p_=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ea=/[\\^$.*+?()[\]{}|]/g,m_=RegExp(Ea.source),Ta=/^\s+/,__=/\s/,y_=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,v_=/\{\n\/\* \[wrapped with (.+)\] \*/,E_=/,? & /,T_=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,w_=/[()=,{}\[\]\/\s]/,I_=/\\(\\)?/g,A_=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Oc=/\w*$/,R_=/^[-+]0x[0-9a-f]+$/i,S_=/^0b[01]+$/i,C_=/^\[object .+?Constructor\]$/,P_=/^0o[0-7]+$/i,V_=/^(?:0|[1-9]\d*)$/,D_=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ps=/($^)/,x_=/['\n\r\u2028\u2029\\]/g,ms="\\ud800-\\udfff",b_="\\u0300-\\u036f",N_="\\ufe20-\\ufe2f",O_="\\u20d0-\\u20ff",Mc=b_+N_+O_,Lc="\\u2700-\\u27bf",kc="a-z\\xdf-\\xf6\\xf8-\\xff",M_="\\xac\\xb1\\xd7\\xf7",L_="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",k_="\\u2000-\\u206f",F_=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fc="A-Z\\xc0-\\xd6\\xd8-\\xde",Uc="\\ufe0e\\ufe0f",Bc=M_+L_+k_+F_,wa="['’]",U_="["+ms+"]",qc="["+Bc+"]",_s="["+Mc+"]",$c="\\d+",B_="["+Lc+"]",Wc="["+kc+"]",zc="[^"+ms+Bc+$c+Lc+kc+Fc+"]",Ia="\\ud83c[\\udffb-\\udfff]",q_="(?:"+_s+"|"+Ia+")",Gc="[^"+ms+"]",Aa="(?:\\ud83c[\\udde6-\\uddff]){2}",Ra="[\\ud800-\\udbff][\\udc00-\\udfff]",or="["+Fc+"]",Hc="\\u200d",Kc="(?:"+Wc+"|"+zc+")",$_="(?:"+or+"|"+zc+")",Qc="(?:"+wa+"(?:d|ll|m|re|s|t|ve))?",jc="(?:"+wa+"(?:D|LL|M|RE|S|T|VE))?",Yc=q_+"?",Xc="["+Uc+"]?",W_="(?:"+Hc+"(?:"+[Gc,Aa,Ra].join("|")+")"+Xc+Yc+")*",z_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",G_="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Jc=Xc+Yc+W_,H_="(?:"+[B_,Aa,Ra].join("|")+")"+Jc,K_="(?:"+[Gc+_s+"?",_s,Aa,Ra,U_].join("|")+")",Q_=RegExp(wa,"g"),j_=RegExp(_s,"g"),Sa=RegExp(Ia+"(?="+Ia+")|"+K_+Jc,"g"),Y_=RegExp([or+"?"+Wc+"+"+Qc+"(?="+[qc,or,"$"].join("|")+")",$_+"+"+jc+"(?="+[qc,or+Kc,"$"].join("|")+")",or+"?"+Kc+"+"+Qc,or+"+"+jc,G_,z_,$c,H_].join("|"),"g"),X_=RegExp("["+Hc+ms+Mc+Uc+"]"),J_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Z_=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ty=-1,gt={};gt[ha]=gt[fa]=gt[da]=gt[ga]=gt[pa]=gt[ma]=gt[_a]=gt[ya]=gt[va]=!0,gt[ir]=gt[hs]=gt[Zr]=gt[Kr]=gt[sr]=gt[Qr]=gt[fs]=gt[ds]=gt[xe]=gt[jr]=gt[Je]=gt[Yr]=gt[be]=gt[Xr]=gt[Jr]=!1;var dt={};dt[ir]=dt[hs]=dt[Zr]=dt[sr]=dt[Kr]=dt[Qr]=dt[ha]=dt[fa]=dt[da]=dt[ga]=dt[pa]=dt[xe]=dt[jr]=dt[Je]=dt[Yr]=dt[be]=dt[Xr]=dt[gs]=dt[ma]=dt[_a]=dt[ya]=dt[va]=!0,dt[fs]=dt[ds]=dt[Jr]=!1;var ey={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},ny={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ry={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},iy={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},sy=parseFloat,oy=parseInt,Zc=typeof mi=="object"&&mi&&mi.Object===Object&&mi,ay=typeof self=="object"&&self&&self.Object===Object&&self,Bt=Zc||ay||Function("return this")(),Ca=t&&!t.nodeType&&t,Mn=Ca&&!0&&n&&!n.nodeType&&n,th=Mn&&Mn.exports===Ca,Pa=th&&Zc.process,Te=function(){try{var E=Mn&&Mn.require&&Mn.require("util").types;return E||Pa&&Pa.binding&&Pa.binding("util")}catch{}}(),eh=Te&&Te.isArrayBuffer,nh=Te&&Te.isDate,rh=Te&&Te.isMap,ih=Te&&Te.isRegExp,sh=Te&&Te.isSet,oh=Te&&Te.isTypedArray;function he(E,A,I){switch(I.length){case 0:return E.call(A);case 1:return E.call(A,I[0]);case 2:return E.call(A,I[0],I[1]);case 3:return E.call(A,I[0],I[1],I[2])}return E.apply(A,I)}function uy(E,A,I,O){for(var H=-1,ot=E==null?0:E.length;++H<ot;){var xt=E[H];A(O,xt,I(xt),E)}return O}function we(E,A){for(var I=-1,O=E==null?0:E.length;++I<O&&A(E[I],I,E)!==!1;);return E}function ly(E,A){for(var I=E==null?0:E.length;I--&&A(E[I],I,E)!==!1;);return E}function ah(E,A){for(var I=-1,O=E==null?0:E.length;++I<O;)if(!A(E[I],I,E))return!1;return!0}function gn(E,A){for(var I=-1,O=E==null?0:E.length,H=0,ot=[];++I<O;){var xt=E[I];A(xt,I,E)&&(ot[H++]=xt)}return ot}function ys(E,A){var I=E==null?0:E.length;return!!I&&ar(E,A,0)>-1}function Va(E,A,I){for(var O=-1,H=E==null?0:E.length;++O<H;)if(I(A,E[O]))return!0;return!1}function vt(E,A){for(var I=-1,O=E==null?0:E.length,H=Array(O);++I<O;)H[I]=A(E[I],I,E);return H}function pn(E,A){for(var I=-1,O=A.length,H=E.length;++I<O;)E[H+I]=A[I];return E}function Da(E,A,I,O){var H=-1,ot=E==null?0:E.length;for(O&&ot&&(I=E[++H]);++H<ot;)I=A(I,E[H],H,E);return I}function cy(E,A,I,O){var H=E==null?0:E.length;for(O&&H&&(I=E[--H]);H--;)I=A(I,E[H],H,E);return I}function xa(E,A){for(var I=-1,O=E==null?0:E.length;++I<O;)if(A(E[I],I,E))return!0;return!1}var hy=ba("length");function fy(E){return E.split("")}function dy(E){return E.match(T_)||[]}function uh(E,A,I){var O;return I(E,function(H,ot,xt){if(A(H,ot,xt))return O=ot,!1}),O}function vs(E,A,I,O){for(var H=E.length,ot=I+(O?1:-1);O?ot--:++ot<H;)if(A(E[ot],ot,E))return ot;return-1}function ar(E,A,I){return A===A?Ry(E,A,I):vs(E,lh,I)}function gy(E,A,I,O){for(var H=I-1,ot=E.length;++H<ot;)if(O(E[H],A))return H;return-1}function lh(E){return E!==E}function ch(E,A){var I=E==null?0:E.length;return I?Oa(E,A)/I:cs}function ba(E){return function(A){return A==null?e:A[E]}}function Na(E){return function(A){return E==null?e:E[A]}}function hh(E,A,I,O,H){return H(E,function(ot,xt,ft){I=O?(O=!1,ot):A(I,ot,xt,ft)}),I}function py(E,A){var I=E.length;for(E.sort(A);I--;)E[I]=E[I].value;return E}function Oa(E,A){for(var I,O=-1,H=E.length;++O<H;){var ot=A(E[O]);ot!==e&&(I=I===e?ot:I+ot)}return I}function Ma(E,A){for(var I=-1,O=Array(E);++I<E;)O[I]=A(I);return O}function my(E,A){return vt(A,function(I){return[I,E[I]]})}function fh(E){return E&&E.slice(0,mh(E)+1).replace(Ta,"")}function fe(E){return function(A){return E(A)}}function La(E,A){return vt(A,function(I){return E[I]})}function ti(E,A){return E.has(A)}function dh(E,A){for(var I=-1,O=E.length;++I<O&&ar(A,E[I],0)>-1;);return I}function gh(E,A){for(var I=E.length;I--&&ar(A,E[I],0)>-1;);return I}function _y(E,A){for(var I=E.length,O=0;I--;)E[I]===A&&++O;return O}var yy=Na(ey),vy=Na(ny);function Ey(E){return"\\"+iy[E]}function Ty(E,A){return E==null?e:E[A]}function ur(E){return X_.test(E)}function wy(E){return J_.test(E)}function Iy(E){for(var A,I=[];!(A=E.next()).done;)I.push(A.value);return I}function ka(E){var A=-1,I=Array(E.size);return E.forEach(function(O,H){I[++A]=[H,O]}),I}function ph(E,A){return function(I){return E(A(I))}}function mn(E,A){for(var I=-1,O=E.length,H=0,ot=[];++I<O;){var xt=E[I];(xt===A||xt===_)&&(E[I]=_,ot[H++]=I)}return ot}function Es(E){var A=-1,I=Array(E.size);return E.forEach(function(O){I[++A]=O}),I}function Ay(E){var A=-1,I=Array(E.size);return E.forEach(function(O){I[++A]=[O,O]}),I}function Ry(E,A,I){for(var O=I-1,H=E.length;++O<H;)if(E[O]===A)return O;return-1}function Sy(E,A,I){for(var O=I+1;O--;)if(E[O]===A)return O;return O}function lr(E){return ur(E)?Py(E):hy(E)}function Ne(E){return ur(E)?Vy(E):fy(E)}function mh(E){for(var A=E.length;A--&&__.test(E.charAt(A)););return A}var Cy=Na(ry);function Py(E){for(var A=Sa.lastIndex=0;Sa.test(E);)++A;return A}function Vy(E){return E.match(Sa)||[]}function Dy(E){return E.match(Y_)||[]}var xy=function E(A){A=A==null?Bt:cr.defaults(Bt.Object(),A,cr.pick(Bt,Z_));var I=A.Array,O=A.Date,H=A.Error,ot=A.Function,xt=A.Math,ft=A.Object,Fa=A.RegExp,by=A.String,Ie=A.TypeError,Ts=I.prototype,Ny=ot.prototype,hr=ft.prototype,ws=A["__core-js_shared__"],Is=Ny.toString,ct=hr.hasOwnProperty,Oy=0,_h=function(){var r=/[^.]+$/.exec(ws&&ws.keys&&ws.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),As=hr.toString,My=Is.call(ft),Ly=Bt._,ky=Fa("^"+Is.call(ct).replace(Ea,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rs=th?A.Buffer:e,_n=A.Symbol,Ss=A.Uint8Array,yh=Rs?Rs.allocUnsafe:e,Cs=ph(ft.getPrototypeOf,ft),vh=ft.create,Eh=hr.propertyIsEnumerable,Ps=Ts.splice,Th=_n?_n.isConcatSpreadable:e,ei=_n?_n.iterator:e,Ln=_n?_n.toStringTag:e,Vs=function(){try{var r=qn(ft,"defineProperty");return r({},"",{}),r}catch{}}(),Fy=A.clearTimeout!==Bt.clearTimeout&&A.clearTimeout,Uy=O&&O.now!==Bt.Date.now&&O.now,By=A.setTimeout!==Bt.setTimeout&&A.setTimeout,Ds=xt.ceil,xs=xt.floor,Ua=ft.getOwnPropertySymbols,qy=Rs?Rs.isBuffer:e,wh=A.isFinite,$y=Ts.join,Wy=ph(ft.keys,ft),bt=xt.max,jt=xt.min,zy=O.now,Gy=A.parseInt,Ih=xt.random,Hy=Ts.reverse,Ba=qn(A,"DataView"),ni=qn(A,"Map"),qa=qn(A,"Promise"),fr=qn(A,"Set"),ri=qn(A,"WeakMap"),ii=qn(ft,"create"),bs=ri&&new ri,dr={},Ky=$n(Ba),Qy=$n(ni),jy=$n(qa),Yy=$n(fr),Xy=$n(ri),Ns=_n?_n.prototype:e,si=Ns?Ns.valueOf:e,Ah=Ns?Ns.toString:e;function g(r){if(At(r)&&!Q(r)&&!(r instanceof et)){if(r instanceof Ae)return r;if(ct.call(r,"__wrapped__"))return Sf(r)}return new Ae(r)}var gr=function(){function r(){}return function(s){if(!Tt(s))return{};if(vh)return vh(s);r.prototype=s;var u=new r;return r.prototype=e,u}}();function Os(){}function Ae(r,s){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=e}g.templateSettings={escape:h_,evaluate:f_,interpolate:Nc,variable:"",imports:{_:g}},g.prototype=Os.prototype,g.prototype.constructor=g,Ae.prototype=gr(Os.prototype),Ae.prototype.constructor=Ae;function et(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=$e,this.__views__=[]}function Jy(){var r=new et(this.__wrapped__);return r.__actions__=ae(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=ae(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=ae(this.__views__),r}function Zy(){if(this.__filtered__){var r=new et(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function tv(){var r=this.__wrapped__.value(),s=this.__dir__,u=Q(r),c=s<0,f=u?r.length:0,p=f0(0,f,this.__views__),y=p.start,v=p.end,T=v-y,R=c?v:y-1,S=this.__iteratees__,V=S.length,b=0,k=jt(T,this.__takeCount__);if(!u||!c&&f==T&&k==T)return Qh(r,this.__actions__);var q=[];t:for(;T--&&b<k;){R+=s;for(var J=-1,$=r[R];++J<V;){var tt=S[J],rt=tt.iteratee,pe=tt.type,se=rt($);if(pe==Qm)$=se;else if(!se){if(pe==Pc)continue t;break t}}q[b++]=$}return q}et.prototype=gr(Os.prototype),et.prototype.constructor=et;function kn(r){var s=-1,u=r==null?0:r.length;for(this.clear();++s<u;){var c=r[s];this.set(c[0],c[1])}}function ev(){this.__data__=ii?ii(null):{},this.size=0}function nv(r){var s=this.has(r)&&delete this.__data__[r];return this.size-=s?1:0,s}function rv(r){var s=this.__data__;if(ii){var u=s[r];return u===d?e:u}return ct.call(s,r)?s[r]:e}function iv(r){var s=this.__data__;return ii?s[r]!==e:ct.call(s,r)}function sv(r,s){var u=this.__data__;return this.size+=this.has(r)?0:1,u[r]=ii&&s===e?d:s,this}kn.prototype.clear=ev,kn.prototype.delete=nv,kn.prototype.get=rv,kn.prototype.has=iv,kn.prototype.set=sv;function Ze(r){var s=-1,u=r==null?0:r.length;for(this.clear();++s<u;){var c=r[s];this.set(c[0],c[1])}}function ov(){this.__data__=[],this.size=0}function av(r){var s=this.__data__,u=Ms(s,r);if(u<0)return!1;var c=s.length-1;return u==c?s.pop():Ps.call(s,u,1),--this.size,!0}function uv(r){var s=this.__data__,u=Ms(s,r);return u<0?e:s[u][1]}function lv(r){return Ms(this.__data__,r)>-1}function cv(r,s){var u=this.__data__,c=Ms(u,r);return c<0?(++this.size,u.push([r,s])):u[c][1]=s,this}Ze.prototype.clear=ov,Ze.prototype.delete=av,Ze.prototype.get=uv,Ze.prototype.has=lv,Ze.prototype.set=cv;function tn(r){var s=-1,u=r==null?0:r.length;for(this.clear();++s<u;){var c=r[s];this.set(c[0],c[1])}}function hv(){this.size=0,this.__data__={hash:new kn,map:new(ni||Ze),string:new kn}}function fv(r){var s=Ks(this,r).delete(r);return this.size-=s?1:0,s}function dv(r){return Ks(this,r).get(r)}function gv(r){return Ks(this,r).has(r)}function pv(r,s){var u=Ks(this,r),c=u.size;return u.set(r,s),this.size+=u.size==c?0:1,this}tn.prototype.clear=hv,tn.prototype.delete=fv,tn.prototype.get=dv,tn.prototype.has=gv,tn.prototype.set=pv;function Fn(r){var s=-1,u=r==null?0:r.length;for(this.__data__=new tn;++s<u;)this.add(r[s])}function mv(r){return this.__data__.set(r,d),this}function _v(r){return this.__data__.has(r)}Fn.prototype.add=Fn.prototype.push=mv,Fn.prototype.has=_v;function Oe(r){var s=this.__data__=new Ze(r);this.size=s.size}function yv(){this.__data__=new Ze,this.size=0}function vv(r){var s=this.__data__,u=s.delete(r);return this.size=s.size,u}function Ev(r){return this.__data__.get(r)}function Tv(r){return this.__data__.has(r)}function wv(r,s){var u=this.__data__;if(u instanceof Ze){var c=u.__data__;if(!ni||c.length<o-1)return c.push([r,s]),this.size=++u.size,this;u=this.__data__=new tn(c)}return u.set(r,s),this.size=u.size,this}Oe.prototype.clear=yv,Oe.prototype.delete=vv,Oe.prototype.get=Ev,Oe.prototype.has=Tv,Oe.prototype.set=wv;function Rh(r,s){var u=Q(r),c=!u&&Wn(r),f=!u&&!c&&wn(r),p=!u&&!c&&!f&&yr(r),y=u||c||f||p,v=y?Ma(r.length,by):[],T=v.length;for(var R in r)(s||ct.call(r,R))&&!(y&&(R=="length"||f&&(R=="offset"||R=="parent")||p&&(R=="buffer"||R=="byteLength"||R=="byteOffset")||sn(R,T)))&&v.push(R);return v}function Sh(r){var s=r.length;return s?r[Ja(0,s-1)]:e}function Iv(r,s){return Qs(ae(r),Un(s,0,r.length))}function Av(r){return Qs(ae(r))}function $a(r,s,u){(u!==e&&!Me(r[s],u)||u===e&&!(s in r))&&en(r,s,u)}function oi(r,s,u){var c=r[s];(!(ct.call(r,s)&&Me(c,u))||u===e&&!(s in r))&&en(r,s,u)}function Ms(r,s){for(var u=r.length;u--;)if(Me(r[u][0],s))return u;return-1}function Rv(r,s,u,c){return yn(r,function(f,p,y){s(c,f,u(f),y)}),c}function Ch(r,s){return r&&ze(s,Mt(s),r)}function Sv(r,s){return r&&ze(s,le(s),r)}function en(r,s,u){s=="__proto__"&&Vs?Vs(r,s,{configurable:!0,enumerable:!0,value:u,writable:!0}):r[s]=u}function Wa(r,s){for(var u=-1,c=s.length,f=I(c),p=r==null;++u<c;)f[u]=p?e:Iu(r,s[u]);return f}function Un(r,s,u){return r===r&&(u!==e&&(r=r<=u?r:u),s!==e&&(r=r>=s?r:s)),r}function Re(r,s,u,c,f,p){var y,v=s&w,T=s&P,R=s&x;if(u&&(y=f?u(r,c,f,p):u(r)),y!==e)return y;if(!Tt(r))return r;var S=Q(r);if(S){if(y=g0(r),!v)return ae(r,y)}else{var V=Yt(r),b=V==ds||V==Vc;if(wn(r))return Xh(r,v);if(V==Je||V==ir||b&&!f){if(y=T||b?{}:_f(r),!v)return T?r0(r,Sv(y,r)):n0(r,Ch(y,r))}else{if(!dt[V])return f?r:{};y=p0(r,V,v)}}p||(p=new Oe);var k=p.get(r);if(k)return k;p.set(r,y),Hf(r)?r.forEach(function($){y.add(Re($,s,u,$,r,p))}):zf(r)&&r.forEach(function($,tt){y.set(tt,Re($,s,u,tt,r,p))});var q=R?T?lu:uu:T?le:Mt,J=S?e:q(r);return we(J||r,function($,tt){J&&(tt=$,$=r[tt]),oi(y,tt,Re($,s,u,tt,r,p))}),y}function Cv(r){var s=Mt(r);return function(u){return Ph(u,r,s)}}function Ph(r,s,u){var c=u.length;if(r==null)return!c;for(r=ft(r);c--;){var f=u[c],p=s[f],y=r[f];if(y===e&&!(f in r)||!p(y))return!1}return!0}function Vh(r,s,u){if(typeof r!="function")throw new Ie(l);return di(function(){r.apply(e,u)},s)}function ai(r,s,u,c){var f=-1,p=ys,y=!0,v=r.length,T=[],R=s.length;if(!v)return T;u&&(s=vt(s,fe(u))),c?(p=Va,y=!1):s.length>=o&&(p=ti,y=!1,s=new Fn(s));t:for(;++f<v;){var S=r[f],V=u==null?S:u(S);if(S=c||S!==0?S:0,y&&V===V){for(var b=R;b--;)if(s[b]===V)continue t;T.push(S)}else p(s,V,c)||T.push(S)}return T}var yn=nf(We),Dh=nf(Ga,!0);function Pv(r,s){var u=!0;return yn(r,function(c,f,p){return u=!!s(c,f,p),u}),u}function Ls(r,s,u){for(var c=-1,f=r.length;++c<f;){var p=r[c],y=s(p);if(y!=null&&(v===e?y===y&&!ge(y):u(y,v)))var v=y,T=p}return T}function Vv(r,s,u,c){var f=r.length;for(u=Y(u),u<0&&(u=-u>f?0:f+u),c=c===e||c>f?f:Y(c),c<0&&(c+=f),c=u>c?0:Qf(c);u<c;)r[u++]=s;return r}function xh(r,s){var u=[];return yn(r,function(c,f,p){s(c,f,p)&&u.push(c)}),u}function qt(r,s,u,c,f){var p=-1,y=r.length;for(u||(u=_0),f||(f=[]);++p<y;){var v=r[p];s>0&&u(v)?s>1?qt(v,s-1,u,c,f):pn(f,v):c||(f[f.length]=v)}return f}var za=rf(),bh=rf(!0);function We(r,s){return r&&za(r,s,Mt)}function Ga(r,s){return r&&bh(r,s,Mt)}function ks(r,s){return gn(s,function(u){return on(r[u])})}function Bn(r,s){s=En(s,r);for(var u=0,c=s.length;r!=null&&u<c;)r=r[Ge(s[u++])];return u&&u==c?r:e}function Nh(r,s,u){var c=s(r);return Q(r)?c:pn(c,u(r))}function re(r){return r==null?r===e?i_:n_:Ln&&Ln in ft(r)?h0(r):A0(r)}function Ha(r,s){return r>s}function Dv(r,s){return r!=null&&ct.call(r,s)}function xv(r,s){return r!=null&&s in ft(r)}function bv(r,s,u){return r>=jt(s,u)&&r<bt(s,u)}function Ka(r,s,u){for(var c=u?Va:ys,f=r[0].length,p=r.length,y=p,v=I(p),T=1/0,R=[];y--;){var S=r[y];y&&s&&(S=vt(S,fe(s))),T=jt(S.length,T),v[y]=!u&&(s||f>=120&&S.length>=120)?new Fn(y&&S):e}S=r[0];var V=-1,b=v[0];t:for(;++V<f&&R.length<T;){var k=S[V],q=s?s(k):k;if(k=u||k!==0?k:0,!(b?ti(b,q):c(R,q,u))){for(y=p;--y;){var J=v[y];if(!(J?ti(J,q):c(r[y],q,u)))continue t}b&&b.push(q),R.push(k)}}return R}function Nv(r,s,u,c){return We(r,function(f,p,y){s(c,u(f),p,y)}),c}function ui(r,s,u){s=En(s,r),r=Tf(r,s);var c=r==null?r:r[Ge(Ce(s))];return c==null?e:he(c,r,u)}function Oh(r){return At(r)&&re(r)==ir}function Ov(r){return At(r)&&re(r)==Zr}function Mv(r){return At(r)&&re(r)==Qr}function li(r,s,u,c,f){return r===s?!0:r==null||s==null||!At(r)&&!At(s)?r!==r&&s!==s:Lv(r,s,u,c,li,f)}function Lv(r,s,u,c,f,p){var y=Q(r),v=Q(s),T=y?hs:Yt(r),R=v?hs:Yt(s);T=T==ir?Je:T,R=R==ir?Je:R;var S=T==Je,V=R==Je,b=T==R;if(b&&wn(r)){if(!wn(s))return!1;y=!0,S=!1}if(b&&!S)return p||(p=new Oe),y||yr(r)?gf(r,s,u,c,f,p):l0(r,s,T,u,c,f,p);if(!(u&z)){var k=S&&ct.call(r,"__wrapped__"),q=V&&ct.call(s,"__wrapped__");if(k||q){var J=k?r.value():r,$=q?s.value():s;return p||(p=new Oe),f(J,$,u,c,p)}}return b?(p||(p=new Oe),c0(r,s,u,c,f,p)):!1}function kv(r){return At(r)&&Yt(r)==xe}function Qa(r,s,u,c){var f=u.length,p=f,y=!c;if(r==null)return!p;for(r=ft(r);f--;){var v=u[f];if(y&&v[2]?v[1]!==r[v[0]]:!(v[0]in r))return!1}for(;++f<p;){v=u[f];var T=v[0],R=r[T],S=v[1];if(y&&v[2]){if(R===e&&!(T in r))return!1}else{var V=new Oe;if(c)var b=c(R,S,T,r,s,V);if(!(b===e?li(S,R,z|X,c,V):b))return!1}}return!0}function Mh(r){if(!Tt(r)||v0(r))return!1;var s=on(r)?ky:C_;return s.test($n(r))}function Fv(r){return At(r)&&re(r)==Yr}function Uv(r){return At(r)&&Yt(r)==be}function Bv(r){return At(r)&&to(r.length)&&!!gt[re(r)]}function Lh(r){return typeof r=="function"?r:r==null?ce:typeof r=="object"?Q(r)?Uh(r[0],r[1]):Fh(r):sd(r)}function ja(r){if(!fi(r))return Wy(r);var s=[];for(var u in ft(r))ct.call(r,u)&&u!="constructor"&&s.push(u);return s}function qv(r){if(!Tt(r))return I0(r);var s=fi(r),u=[];for(var c in r)c=="constructor"&&(s||!ct.call(r,c))||u.push(c);return u}function Ya(r,s){return r<s}function kh(r,s){var u=-1,c=ue(r)?I(r.length):[];return yn(r,function(f,p,y){c[++u]=s(f,p,y)}),c}function Fh(r){var s=hu(r);return s.length==1&&s[0][2]?vf(s[0][0],s[0][1]):function(u){return u===r||Qa(u,r,s)}}function Uh(r,s){return du(r)&&yf(s)?vf(Ge(r),s):function(u){var c=Iu(u,r);return c===e&&c===s?Au(u,r):li(s,c,z|X)}}function Fs(r,s,u,c,f){r!==s&&za(s,function(p,y){if(f||(f=new Oe),Tt(p))$v(r,s,y,u,Fs,c,f);else{var v=c?c(pu(r,y),p,y+"",r,s,f):e;v===e&&(v=p),$a(r,y,v)}},le)}function $v(r,s,u,c,f,p,y){var v=pu(r,u),T=pu(s,u),R=y.get(T);if(R){$a(r,u,R);return}var S=p?p(v,T,u+"",r,s,y):e,V=S===e;if(V){var b=Q(T),k=!b&&wn(T),q=!b&&!k&&yr(T);S=T,b||k||q?Q(v)?S=v:St(v)?S=ae(v):k?(V=!1,S=Xh(T,!0)):q?(V=!1,S=Jh(T,!0)):S=[]:gi(T)||Wn(T)?(S=v,Wn(v)?S=jf(v):(!Tt(v)||on(v))&&(S=_f(T))):V=!1}V&&(y.set(T,S),f(S,T,c,p,y),y.delete(T)),$a(r,u,S)}function Bh(r,s){var u=r.length;if(u)return s+=s<0?u:0,sn(s,u)?r[s]:e}function qh(r,s,u){s.length?s=vt(s,function(p){return Q(p)?function(y){return Bn(y,p.length===1?p[0]:p)}:p}):s=[ce];var c=-1;s=vt(s,fe(B()));var f=kh(r,function(p,y,v){var T=vt(s,function(R){return R(p)});return{criteria:T,index:++c,value:p}});return py(f,function(p,y){return e0(p,y,u)})}function Wv(r,s){return $h(r,s,function(u,c){return Au(r,c)})}function $h(r,s,u){for(var c=-1,f=s.length,p={};++c<f;){var y=s[c],v=Bn(r,y);u(v,y)&&ci(p,En(y,r),v)}return p}function zv(r){return function(s){return Bn(s,r)}}function Xa(r,s,u,c){var f=c?gy:ar,p=-1,y=s.length,v=r;for(r===s&&(s=ae(s)),u&&(v=vt(r,fe(u)));++p<y;)for(var T=0,R=s[p],S=u?u(R):R;(T=f(v,S,T,c))>-1;)v!==r&&Ps.call(v,T,1),Ps.call(r,T,1);return r}function Wh(r,s){for(var u=r?s.length:0,c=u-1;u--;){var f=s[u];if(u==c||f!==p){var p=f;sn(f)?Ps.call(r,f,1):eu(r,f)}}return r}function Ja(r,s){return r+xs(Ih()*(s-r+1))}function Gv(r,s,u,c){for(var f=-1,p=bt(Ds((s-r)/(u||1)),0),y=I(p);p--;)y[c?p:++f]=r,r+=u;return y}function Za(r,s){var u="";if(!r||s<1||s>dn)return u;do s%2&&(u+=r),s=xs(s/2),s&&(r+=r);while(s);return u}function Z(r,s){return mu(Ef(r,s,ce),r+"")}function Hv(r){return Sh(vr(r))}function Kv(r,s){var u=vr(r);return Qs(u,Un(s,0,u.length))}function ci(r,s,u,c){if(!Tt(r))return r;s=En(s,r);for(var f=-1,p=s.length,y=p-1,v=r;v!=null&&++f<p;){var T=Ge(s[f]),R=u;if(T==="__proto__"||T==="constructor"||T==="prototype")return r;if(f!=y){var S=v[T];R=c?c(S,T,v):e,R===e&&(R=Tt(S)?S:sn(s[f+1])?[]:{})}oi(v,T,R),v=v[T]}return r}var zh=bs?function(r,s){return bs.set(r,s),r}:ce,Qv=Vs?function(r,s){return Vs(r,"toString",{configurable:!0,enumerable:!1,value:Su(s),writable:!0})}:ce;function jv(r){return Qs(vr(r))}function Se(r,s,u){var c=-1,f=r.length;s<0&&(s=-s>f?0:f+s),u=u>f?f:u,u<0&&(u+=f),f=s>u?0:u-s>>>0,s>>>=0;for(var p=I(f);++c<f;)p[c]=r[c+s];return p}function Yv(r,s){var u;return yn(r,function(c,f,p){return u=s(c,f,p),!u}),!!u}function Us(r,s,u){var c=0,f=r==null?c:r.length;if(typeof s=="number"&&s===s&&f<=Jm){for(;c<f;){var p=c+f>>>1,y=r[p];y!==null&&!ge(y)&&(u?y<=s:y<s)?c=p+1:f=p}return f}return tu(r,s,ce,u)}function tu(r,s,u,c){var f=0,p=r==null?0:r.length;if(p===0)return 0;s=u(s);for(var y=s!==s,v=s===null,T=ge(s),R=s===e;f<p;){var S=xs((f+p)/2),V=u(r[S]),b=V!==e,k=V===null,q=V===V,J=ge(V);if(y)var $=c||q;else R?$=q&&(c||b):v?$=q&&b&&(c||!k):T?$=q&&b&&!k&&(c||!J):k||J?$=!1:$=c?V<=s:V<s;$?f=S+1:p=S}return jt(p,Xm)}function Gh(r,s){for(var u=-1,c=r.length,f=0,p=[];++u<c;){var y=r[u],v=s?s(y):y;if(!u||!Me(v,T)){var T=v;p[f++]=y===0?0:y}}return p}function Hh(r){return typeof r=="number"?r:ge(r)?cs:+r}function de(r){if(typeof r=="string")return r;if(Q(r))return vt(r,de)+"";if(ge(r))return Ah?Ah.call(r):"";var s=r+"";return s=="0"&&1/r==-On?"-0":s}function vn(r,s,u){var c=-1,f=ys,p=r.length,y=!0,v=[],T=v;if(u)y=!1,f=Va;else if(p>=o){var R=s?null:a0(r);if(R)return Es(R);y=!1,f=ti,T=new Fn}else T=s?[]:v;t:for(;++c<p;){var S=r[c],V=s?s(S):S;if(S=u||S!==0?S:0,y&&V===V){for(var b=T.length;b--;)if(T[b]===V)continue t;s&&T.push(V),v.push(S)}else f(T,V,u)||(T!==v&&T.push(V),v.push(S))}return v}function eu(r,s){return s=En(s,r),r=Tf(r,s),r==null||delete r[Ge(Ce(s))]}function Kh(r,s,u,c){return ci(r,s,u(Bn(r,s)),c)}function Bs(r,s,u,c){for(var f=r.length,p=c?f:-1;(c?p--:++p<f)&&s(r[p],p,r););return u?Se(r,c?0:p,c?p+1:f):Se(r,c?p+1:0,c?f:p)}function Qh(r,s){var u=r;return u instanceof et&&(u=u.value()),Da(s,function(c,f){return f.func.apply(f.thisArg,pn([c],f.args))},u)}function nu(r,s,u){var c=r.length;if(c<2)return c?vn(r[0]):[];for(var f=-1,p=I(c);++f<c;)for(var y=r[f],v=-1;++v<c;)v!=f&&(p[f]=ai(p[f]||y,r[v],s,u));return vn(qt(p,1),s,u)}function jh(r,s,u){for(var c=-1,f=r.length,p=s.length,y={};++c<f;){var v=c<p?s[c]:e;u(y,r[c],v)}return y}function ru(r){return St(r)?r:[]}function iu(r){return typeof r=="function"?r:ce}function En(r,s){return Q(r)?r:du(r,s)?[r]:Rf(ut(r))}var Xv=Z;function Tn(r,s,u){var c=r.length;return u=u===e?c:u,!s&&u>=c?r:Se(r,s,u)}var Yh=Fy||function(r){return Bt.clearTimeout(r)};function Xh(r,s){if(s)return r.slice();var u=r.length,c=yh?yh(u):new r.constructor(u);return r.copy(c),c}function su(r){var s=new r.constructor(r.byteLength);return new Ss(s).set(new Ss(r)),s}function Jv(r,s){var u=s?su(r.buffer):r.buffer;return new r.constructor(u,r.byteOffset,r.byteLength)}function Zv(r){var s=new r.constructor(r.source,Oc.exec(r));return s.lastIndex=r.lastIndex,s}function t0(r){return si?ft(si.call(r)):{}}function Jh(r,s){var u=s?su(r.buffer):r.buffer;return new r.constructor(u,r.byteOffset,r.length)}function Zh(r,s){if(r!==s){var u=r!==e,c=r===null,f=r===r,p=ge(r),y=s!==e,v=s===null,T=s===s,R=ge(s);if(!v&&!R&&!p&&r>s||p&&y&&T&&!v&&!R||c&&y&&T||!u&&T||!f)return 1;if(!c&&!p&&!R&&r<s||R&&u&&f&&!c&&!p||v&&u&&f||!y&&f||!T)return-1}return 0}function e0(r,s,u){for(var c=-1,f=r.criteria,p=s.criteria,y=f.length,v=u.length;++c<y;){var T=Zh(f[c],p[c]);if(T){if(c>=v)return T;var R=u[c];return T*(R=="desc"?-1:1)}}return r.index-s.index}function tf(r,s,u,c){for(var f=-1,p=r.length,y=u.length,v=-1,T=s.length,R=bt(p-y,0),S=I(T+R),V=!c;++v<T;)S[v]=s[v];for(;++f<y;)(V||f<p)&&(S[u[f]]=r[f]);for(;R--;)S[v++]=r[f++];return S}function ef(r,s,u,c){for(var f=-1,p=r.length,y=-1,v=u.length,T=-1,R=s.length,S=bt(p-v,0),V=I(S+R),b=!c;++f<S;)V[f]=r[f];for(var k=f;++T<R;)V[k+T]=s[T];for(;++y<v;)(b||f<p)&&(V[k+u[y]]=r[f++]);return V}function ae(r,s){var u=-1,c=r.length;for(s||(s=I(c));++u<c;)s[u]=r[u];return s}function ze(r,s,u,c){var f=!u;u||(u={});for(var p=-1,y=s.length;++p<y;){var v=s[p],T=c?c(u[v],r[v],v,u,r):e;T===e&&(T=r[v]),f?en(u,v,T):oi(u,v,T)}return u}function n0(r,s){return ze(r,fu(r),s)}function r0(r,s){return ze(r,pf(r),s)}function qs(r,s){return function(u,c){var f=Q(u)?uy:Rv,p=s?s():{};return f(u,r,B(c,2),p)}}function pr(r){return Z(function(s,u){var c=-1,f=u.length,p=f>1?u[f-1]:e,y=f>2?u[2]:e;for(p=r.length>3&&typeof p=="function"?(f--,p):e,y&&ie(u[0],u[1],y)&&(p=f<3?e:p,f=1),s=ft(s);++c<f;){var v=u[c];v&&r(s,v,c,p)}return s})}function nf(r,s){return function(u,c){if(u==null)return u;if(!ue(u))return r(u,c);for(var f=u.length,p=s?f:-1,y=ft(u);(s?p--:++p<f)&&c(y[p],p,y)!==!1;);return u}}function rf(r){return function(s,u,c){for(var f=-1,p=ft(s),y=c(s),v=y.length;v--;){var T=y[r?v:++f];if(u(p[T],T,p)===!1)break}return s}}function i0(r,s,u){var c=s&F,f=hi(r);function p(){var y=this&&this!==Bt&&this instanceof p?f:r;return y.apply(c?u:this,arguments)}return p}function sf(r){return function(s){s=ut(s);var u=ur(s)?Ne(s):e,c=u?u[0]:s.charAt(0),f=u?Tn(u,1).join(""):s.slice(1);return c[r]()+f}}function mr(r){return function(s){return Da(rd(nd(s).replace(Q_,"")),r,"")}}function hi(r){return function(){var s=arguments;switch(s.length){case 0:return new r;case 1:return new r(s[0]);case 2:return new r(s[0],s[1]);case 3:return new r(s[0],s[1],s[2]);case 4:return new r(s[0],s[1],s[2],s[3]);case 5:return new r(s[0],s[1],s[2],s[3],s[4]);case 6:return new r(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new r(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var u=gr(r.prototype),c=r.apply(u,s);return Tt(c)?c:u}}function s0(r,s,u){var c=hi(r);function f(){for(var p=arguments.length,y=I(p),v=p,T=_r(f);v--;)y[v]=arguments[v];var R=p<3&&y[0]!==T&&y[p-1]!==T?[]:mn(y,T);if(p-=R.length,p<u)return cf(r,s,$s,f.placeholder,e,y,R,e,e,u-p);var S=this&&this!==Bt&&this instanceof f?c:r;return he(S,this,y)}return f}function of(r){return function(s,u,c){var f=ft(s);if(!ue(s)){var p=B(u,3);s=Mt(s),u=function(v){return p(f[v],v,f)}}var y=r(s,u,c);return y>-1?f[p?s[y]:y]:e}}function af(r){return rn(function(s){var u=s.length,c=u,f=Ae.prototype.thru;for(r&&s.reverse();c--;){var p=s[c];if(typeof p!="function")throw new Ie(l);if(f&&!y&&Hs(p)=="wrapper")var y=new Ae([],!0)}for(c=y?c:u;++c<u;){p=s[c];var v=Hs(p),T=v=="wrapper"?cu(p):e;T&&gu(T[0])&&T[1]==(Ee|yt|Qt|rr)&&!T[4].length&&T[9]==1?y=y[Hs(T[0])].apply(y,T[3]):y=p.length==1&&gu(p)?y[v]():y.thru(p)}return function(){var R=arguments,S=R[0];if(y&&R.length==1&&Q(S))return y.plant(S).value();for(var V=0,b=u?s[V].apply(this,R):S;++V<u;)b=s[V].call(this,b);return b}})}function $s(r,s,u,c,f,p,y,v,T,R){var S=s&Ee,V=s&F,b=s&lt,k=s&(yt|Kt),q=s&Hr,J=b?e:hi(r);function $(){for(var tt=arguments.length,rt=I(tt),pe=tt;pe--;)rt[pe]=arguments[pe];if(k)var se=_r($),me=_y(rt,se);if(c&&(rt=tf(rt,c,f,k)),p&&(rt=ef(rt,p,y,k)),tt-=me,k&&tt<R){var Ct=mn(rt,se);return cf(r,s,$s,$.placeholder,u,rt,Ct,v,T,R-tt)}var Le=V?u:this,un=b?Le[r]:r;return tt=rt.length,v?rt=R0(rt,v):q&&tt>1&&rt.reverse(),S&&T<tt&&(rt.length=T),this&&this!==Bt&&this instanceof $&&(un=J||hi(un)),un.apply(Le,rt)}return $}function uf(r,s){return function(u,c){return Nv(u,r,s(c),{})}}function Ws(r,s){return function(u,c){var f;if(u===e&&c===e)return s;if(u!==e&&(f=u),c!==e){if(f===e)return c;typeof u=="string"||typeof c=="string"?(u=de(u),c=de(c)):(u=Hh(u),c=Hh(c)),f=r(u,c)}return f}}function ou(r){return rn(function(s){return s=vt(s,fe(B())),Z(function(u){var c=this;return r(s,function(f){return he(f,c,u)})})})}function zs(r,s){s=s===e?" ":de(s);var u=s.length;if(u<2)return u?Za(s,r):s;var c=Za(s,Ds(r/lr(s)));return ur(s)?Tn(Ne(c),0,r).join(""):c.slice(0,r)}function o0(r,s,u,c){var f=s&F,p=hi(r);function y(){for(var v=-1,T=arguments.length,R=-1,S=c.length,V=I(S+T),b=this&&this!==Bt&&this instanceof y?p:r;++R<S;)V[R]=c[R];for(;T--;)V[R++]=arguments[++v];return he(b,f?u:this,V)}return y}function lf(r){return function(s,u,c){return c&&typeof c!="number"&&ie(s,u,c)&&(u=c=e),s=an(s),u===e?(u=s,s=0):u=an(u),c=c===e?s<u?1:-1:an(c),Gv(s,u,c,r)}}function Gs(r){return function(s,u){return typeof s=="string"&&typeof u=="string"||(s=Pe(s),u=Pe(u)),r(s,u)}}function cf(r,s,u,c,f,p,y,v,T,R){var S=s&yt,V=S?y:e,b=S?e:y,k=S?p:e,q=S?e:p;s|=S?Qt:ve,s&=~(S?ve:Qt),s&Ot||(s&=~(F|lt));var J=[r,s,f,k,V,q,b,v,T,R],$=u.apply(e,J);return gu(r)&&wf($,J),$.placeholder=c,If($,r,s)}function au(r){var s=xt[r];return function(u,c){if(u=Pe(u),c=c==null?0:jt(Y(c),292),c&&wh(u)){var f=(ut(u)+"e").split("e"),p=s(f[0]+"e"+(+f[1]+c));return f=(ut(p)+"e").split("e"),+(f[0]+"e"+(+f[1]-c))}return s(u)}}var a0=fr&&1/Es(new fr([,-0]))[1]==On?function(r){return new fr(r)}:Vu;function hf(r){return function(s){var u=Yt(s);return u==xe?ka(s):u==be?Ay(s):my(s,r(s))}}function nn(r,s,u,c,f,p,y,v){var T=s&lt;if(!T&&typeof r!="function")throw new Ie(l);var R=c?c.length:0;if(R||(s&=~(Qt|ve),c=f=e),y=y===e?y:bt(Y(y),0),v=v===e?v:Y(v),R-=f?f.length:0,s&ve){var S=c,V=f;c=f=e}var b=T?e:cu(r),k=[r,s,u,c,f,S,V,p,y,v];if(b&&w0(k,b),r=k[0],s=k[1],u=k[2],c=k[3],f=k[4],v=k[9]=k[9]===e?T?0:r.length:bt(k[9]-R,0),!v&&s&(yt|Kt)&&(s&=~(yt|Kt)),!s||s==F)var q=i0(r,s,u);else s==yt||s==Kt?q=s0(r,s,v):(s==Qt||s==(F|Qt))&&!f.length?q=o0(r,s,u,c):q=$s.apply(e,k);var J=b?zh:wf;return If(J(q,k),r,s)}function ff(r,s,u,c){return r===e||Me(r,hr[u])&&!ct.call(c,u)?s:r}function df(r,s,u,c,f,p){return Tt(r)&&Tt(s)&&(p.set(s,r),Fs(r,s,e,df,p),p.delete(s)),r}function u0(r){return gi(r)?e:r}function gf(r,s,u,c,f,p){var y=u&z,v=r.length,T=s.length;if(v!=T&&!(y&&T>v))return!1;var R=p.get(r),S=p.get(s);if(R&&S)return R==s&&S==r;var V=-1,b=!0,k=u&X?new Fn:e;for(p.set(r,s),p.set(s,r);++V<v;){var q=r[V],J=s[V];if(c)var $=y?c(J,q,V,s,r,p):c(q,J,V,r,s,p);if($!==e){if($)continue;b=!1;break}if(k){if(!xa(s,function(tt,rt){if(!ti(k,rt)&&(q===tt||f(q,tt,u,c,p)))return k.push(rt)})){b=!1;break}}else if(!(q===J||f(q,J,u,c,p))){b=!1;break}}return p.delete(r),p.delete(s),b}function l0(r,s,u,c,f,p,y){switch(u){case sr:if(r.byteLength!=s.byteLength||r.byteOffset!=s.byteOffset)return!1;r=r.buffer,s=s.buffer;case Zr:return!(r.byteLength!=s.byteLength||!p(new Ss(r),new Ss(s)));case Kr:case Qr:case jr:return Me(+r,+s);case fs:return r.name==s.name&&r.message==s.message;case Yr:case Xr:return r==s+"";case xe:var v=ka;case be:var T=c&z;if(v||(v=Es),r.size!=s.size&&!T)return!1;var R=y.get(r);if(R)return R==s;c|=X,y.set(r,s);var S=gf(v(r),v(s),c,f,p,y);return y.delete(r),S;case gs:if(si)return si.call(r)==si.call(s)}return!1}function c0(r,s,u,c,f,p){var y=u&z,v=uu(r),T=v.length,R=uu(s),S=R.length;if(T!=S&&!y)return!1;for(var V=T;V--;){var b=v[V];if(!(y?b in s:ct.call(s,b)))return!1}var k=p.get(r),q=p.get(s);if(k&&q)return k==s&&q==r;var J=!0;p.set(r,s),p.set(s,r);for(var $=y;++V<T;){b=v[V];var tt=r[b],rt=s[b];if(c)var pe=y?c(rt,tt,b,s,r,p):c(tt,rt,b,r,s,p);if(!(pe===e?tt===rt||f(tt,rt,u,c,p):pe)){J=!1;break}$||($=b=="constructor")}if(J&&!$){var se=r.constructor,me=s.constructor;se!=me&&"constructor"in r&&"constructor"in s&&!(typeof se=="function"&&se instanceof se&&typeof me=="function"&&me instanceof me)&&(J=!1)}return p.delete(r),p.delete(s),J}function rn(r){return mu(Ef(r,e,Vf),r+"")}function uu(r){return Nh(r,Mt,fu)}function lu(r){return Nh(r,le,pf)}var cu=bs?function(r){return bs.get(r)}:Vu;function Hs(r){for(var s=r.name+"",u=dr[s],c=ct.call(dr,s)?u.length:0;c--;){var f=u[c],p=f.func;if(p==null||p==r)return f.name}return s}function _r(r){var s=ct.call(g,"placeholder")?g:r;return s.placeholder}function B(){var r=g.iteratee||Cu;return r=r===Cu?Lh:r,arguments.length?r(arguments[0],arguments[1]):r}function Ks(r,s){var u=r.__data__;return y0(s)?u[typeof s=="string"?"string":"hash"]:u.map}function hu(r){for(var s=Mt(r),u=s.length;u--;){var c=s[u],f=r[c];s[u]=[c,f,yf(f)]}return s}function qn(r,s){var u=Ty(r,s);return Mh(u)?u:e}function h0(r){var s=ct.call(r,Ln),u=r[Ln];try{r[Ln]=e;var c=!0}catch{}var f=As.call(r);return c&&(s?r[Ln]=u:delete r[Ln]),f}var fu=Ua?function(r){return r==null?[]:(r=ft(r),gn(Ua(r),function(s){return Eh.call(r,s)}))}:Du,pf=Ua?function(r){for(var s=[];r;)pn(s,fu(r)),r=Cs(r);return s}:Du,Yt=re;(Ba&&Yt(new Ba(new ArrayBuffer(1)))!=sr||ni&&Yt(new ni)!=xe||qa&&Yt(qa.resolve())!=Dc||fr&&Yt(new fr)!=be||ri&&Yt(new ri)!=Jr)&&(Yt=function(r){var s=re(r),u=s==Je?r.constructor:e,c=u?$n(u):"";if(c)switch(c){case Ky:return sr;case Qy:return xe;case jy:return Dc;case Yy:return be;case Xy:return Jr}return s});function f0(r,s,u){for(var c=-1,f=u.length;++c<f;){var p=u[c],y=p.size;switch(p.type){case"drop":r+=y;break;case"dropRight":s-=y;break;case"take":s=jt(s,r+y);break;case"takeRight":r=bt(r,s-y);break}}return{start:r,end:s}}function d0(r){var s=r.match(v_);return s?s[1].split(E_):[]}function mf(r,s,u){s=En(s,r);for(var c=-1,f=s.length,p=!1;++c<f;){var y=Ge(s[c]);if(!(p=r!=null&&u(r,y)))break;r=r[y]}return p||++c!=f?p:(f=r==null?0:r.length,!!f&&to(f)&&sn(y,f)&&(Q(r)||Wn(r)))}function g0(r){var s=r.length,u=new r.constructor(s);return s&&typeof r[0]=="string"&&ct.call(r,"index")&&(u.index=r.index,u.input=r.input),u}function _f(r){return typeof r.constructor=="function"&&!fi(r)?gr(Cs(r)):{}}function p0(r,s,u){var c=r.constructor;switch(s){case Zr:return su(r);case Kr:case Qr:return new c(+r);case sr:return Jv(r,u);case ha:case fa:case da:case ga:case pa:case ma:case _a:case ya:case va:return Jh(r,u);case xe:return new c;case jr:case Xr:return new c(r);case Yr:return Zv(r);case be:return new c;case gs:return t0(r)}}function m0(r,s){var u=s.length;if(!u)return r;var c=u-1;return s[c]=(u>1?"& ":"")+s[c],s=s.join(u>2?", ":" "),r.replace(y_,`{
/* [wrapped with `+s+`] */
`)}function _0(r){return Q(r)||Wn(r)||!!(Th&&r&&r[Th])}function sn(r,s){var u=typeof r;return s=s??dn,!!s&&(u=="number"||u!="symbol"&&V_.test(r))&&r>-1&&r%1==0&&r<s}function ie(r,s,u){if(!Tt(u))return!1;var c=typeof s;return(c=="number"?ue(u)&&sn(s,u.length):c=="string"&&s in u)?Me(u[s],r):!1}function du(r,s){if(Q(r))return!1;var u=typeof r;return u=="number"||u=="symbol"||u=="boolean"||r==null||ge(r)?!0:g_.test(r)||!d_.test(r)||s!=null&&r in ft(s)}function y0(r){var s=typeof r;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?r!=="__proto__":r===null}function gu(r){var s=Hs(r),u=g[s];if(typeof u!="function"||!(s in et.prototype))return!1;if(r===u)return!0;var c=cu(u);return!!c&&r===c[0]}function v0(r){return!!_h&&_h in r}var E0=ws?on:xu;function fi(r){var s=r&&r.constructor,u=typeof s=="function"&&s.prototype||hr;return r===u}function yf(r){return r===r&&!Tt(r)}function vf(r,s){return function(u){return u==null?!1:u[r]===s&&(s!==e||r in ft(u))}}function T0(r){var s=Js(r,function(c){return u.size===m&&u.clear(),c}),u=s.cache;return s}function w0(r,s){var u=r[1],c=s[1],f=u|c,p=f<(F|lt|Ee),y=c==Ee&&u==yt||c==Ee&&u==rr&&r[7].length<=s[8]||c==(Ee|rr)&&s[7].length<=s[8]&&u==yt;if(!(p||y))return r;c&F&&(r[2]=s[2],f|=u&F?0:Ot);var v=s[3];if(v){var T=r[3];r[3]=T?tf(T,v,s[4]):v,r[4]=T?mn(r[3],_):s[4]}return v=s[5],v&&(T=r[5],r[5]=T?ef(T,v,s[6]):v,r[6]=T?mn(r[5],_):s[6]),v=s[7],v&&(r[7]=v),c&Ee&&(r[8]=r[8]==null?s[8]:jt(r[8],s[8])),r[9]==null&&(r[9]=s[9]),r[0]=s[0],r[1]=f,r}function I0(r){var s=[];if(r!=null)for(var u in ft(r))s.push(u);return s}function A0(r){return As.call(r)}function Ef(r,s,u){return s=bt(s===e?r.length-1:s,0),function(){for(var c=arguments,f=-1,p=bt(c.length-s,0),y=I(p);++f<p;)y[f]=c[s+f];f=-1;for(var v=I(s+1);++f<s;)v[f]=c[f];return v[s]=u(y),he(r,this,v)}}function Tf(r,s){return s.length<2?r:Bn(r,Se(s,0,-1))}function R0(r,s){for(var u=r.length,c=jt(s.length,u),f=ae(r);c--;){var p=s[c];r[c]=sn(p,u)?f[p]:e}return r}function pu(r,s){if(!(s==="constructor"&&typeof r[s]=="function")&&s!="__proto__")return r[s]}var wf=Af(zh),di=By||function(r,s){return Bt.setTimeout(r,s)},mu=Af(Qv);function If(r,s,u){var c=s+"";return mu(r,m0(c,S0(d0(c),u)))}function Af(r){var s=0,u=0;return function(){var c=zy(),f=Km-(c-u);if(u=c,f>0){if(++s>=Hm)return arguments[0]}else s=0;return r.apply(e,arguments)}}function Qs(r,s){var u=-1,c=r.length,f=c-1;for(s=s===e?c:s;++u<s;){var p=Ja(u,f),y=r[p];r[p]=r[u],r[u]=y}return r.length=s,r}var Rf=T0(function(r){var s=[];return r.charCodeAt(0)===46&&s.push(""),r.replace(p_,function(u,c,f,p){s.push(f?p.replace(I_,"$1"):c||u)}),s});function Ge(r){if(typeof r=="string"||ge(r))return r;var s=r+"";return s=="0"&&1/r==-On?"-0":s}function $n(r){if(r!=null){try{return Is.call(r)}catch{}try{return r+""}catch{}}return""}function S0(r,s){return we(Zm,function(u){var c="_."+u[0];s&u[1]&&!ys(r,c)&&r.push(c)}),r.sort()}function Sf(r){if(r instanceof et)return r.clone();var s=new Ae(r.__wrapped__,r.__chain__);return s.__actions__=ae(r.__actions__),s.__index__=r.__index__,s.__values__=r.__values__,s}function C0(r,s,u){(u?ie(r,s,u):s===e)?s=1:s=bt(Y(s),0);var c=r==null?0:r.length;if(!c||s<1)return[];for(var f=0,p=0,y=I(Ds(c/s));f<c;)y[p++]=Se(r,f,f+=s);return y}function P0(r){for(var s=-1,u=r==null?0:r.length,c=0,f=[];++s<u;){var p=r[s];p&&(f[c++]=p)}return f}function V0(){var r=arguments.length;if(!r)return[];for(var s=I(r-1),u=arguments[0],c=r;c--;)s[c-1]=arguments[c];return pn(Q(u)?ae(u):[u],qt(s,1))}var D0=Z(function(r,s){return St(r)?ai(r,qt(s,1,St,!0)):[]}),x0=Z(function(r,s){var u=Ce(s);return St(u)&&(u=e),St(r)?ai(r,qt(s,1,St,!0),B(u,2)):[]}),b0=Z(function(r,s){var u=Ce(s);return St(u)&&(u=e),St(r)?ai(r,qt(s,1,St,!0),e,u):[]});function N0(r,s,u){var c=r==null?0:r.length;return c?(s=u||s===e?1:Y(s),Se(r,s<0?0:s,c)):[]}function O0(r,s,u){var c=r==null?0:r.length;return c?(s=u||s===e?1:Y(s),s=c-s,Se(r,0,s<0?0:s)):[]}function M0(r,s){return r&&r.length?Bs(r,B(s,3),!0,!0):[]}function L0(r,s){return r&&r.length?Bs(r,B(s,3),!0):[]}function k0(r,s,u,c){var f=r==null?0:r.length;return f?(u&&typeof u!="number"&&ie(r,s,u)&&(u=0,c=f),Vv(r,s,u,c)):[]}function Cf(r,s,u){var c=r==null?0:r.length;if(!c)return-1;var f=u==null?0:Y(u);return f<0&&(f=bt(c+f,0)),vs(r,B(s,3),f)}function Pf(r,s,u){var c=r==null?0:r.length;if(!c)return-1;var f=c-1;return u!==e&&(f=Y(u),f=u<0?bt(c+f,0):jt(f,c-1)),vs(r,B(s,3),f,!0)}function Vf(r){var s=r==null?0:r.length;return s?qt(r,1):[]}function F0(r){var s=r==null?0:r.length;return s?qt(r,On):[]}function U0(r,s){var u=r==null?0:r.length;return u?(s=s===e?1:Y(s),qt(r,s)):[]}function B0(r){for(var s=-1,u=r==null?0:r.length,c={};++s<u;){var f=r[s];c[f[0]]=f[1]}return c}function Df(r){return r&&r.length?r[0]:e}function q0(r,s,u){var c=r==null?0:r.length;if(!c)return-1;var f=u==null?0:Y(u);return f<0&&(f=bt(c+f,0)),ar(r,s,f)}function $0(r){var s=r==null?0:r.length;return s?Se(r,0,-1):[]}var W0=Z(function(r){var s=vt(r,ru);return s.length&&s[0]===r[0]?Ka(s):[]}),z0=Z(function(r){var s=Ce(r),u=vt(r,ru);return s===Ce(u)?s=e:u.pop(),u.length&&u[0]===r[0]?Ka(u,B(s,2)):[]}),G0=Z(function(r){var s=Ce(r),u=vt(r,ru);return s=typeof s=="function"?s:e,s&&u.pop(),u.length&&u[0]===r[0]?Ka(u,e,s):[]});function H0(r,s){return r==null?"":$y.call(r,s)}function Ce(r){var s=r==null?0:r.length;return s?r[s-1]:e}function K0(r,s,u){var c=r==null?0:r.length;if(!c)return-1;var f=c;return u!==e&&(f=Y(u),f=f<0?bt(c+f,0):jt(f,c-1)),s===s?Sy(r,s,f):vs(r,lh,f,!0)}function Q0(r,s){return r&&r.length?Bh(r,Y(s)):e}var j0=Z(xf);function xf(r,s){return r&&r.length&&s&&s.length?Xa(r,s):r}function Y0(r,s,u){return r&&r.length&&s&&s.length?Xa(r,s,B(u,2)):r}function X0(r,s,u){return r&&r.length&&s&&s.length?Xa(r,s,e,u):r}var J0=rn(function(r,s){var u=r==null?0:r.length,c=Wa(r,s);return Wh(r,vt(s,function(f){return sn(f,u)?+f:f}).sort(Zh)),c});function Z0(r,s){var u=[];if(!(r&&r.length))return u;var c=-1,f=[],p=r.length;for(s=B(s,3);++c<p;){var y=r[c];s(y,c,r)&&(u.push(y),f.push(c))}return Wh(r,f),u}function _u(r){return r==null?r:Hy.call(r)}function tE(r,s,u){var c=r==null?0:r.length;return c?(u&&typeof u!="number"&&ie(r,s,u)?(s=0,u=c):(s=s==null?0:Y(s),u=u===e?c:Y(u)),Se(r,s,u)):[]}function eE(r,s){return Us(r,s)}function nE(r,s,u){return tu(r,s,B(u,2))}function rE(r,s){var u=r==null?0:r.length;if(u){var c=Us(r,s);if(c<u&&Me(r[c],s))return c}return-1}function iE(r,s){return Us(r,s,!0)}function sE(r,s,u){return tu(r,s,B(u,2),!0)}function oE(r,s){var u=r==null?0:r.length;if(u){var c=Us(r,s,!0)-1;if(Me(r[c],s))return c}return-1}function aE(r){return r&&r.length?Gh(r):[]}function uE(r,s){return r&&r.length?Gh(r,B(s,2)):[]}function lE(r){var s=r==null?0:r.length;return s?Se(r,1,s):[]}function cE(r,s,u){return r&&r.length?(s=u||s===e?1:Y(s),Se(r,0,s<0?0:s)):[]}function hE(r,s,u){var c=r==null?0:r.length;return c?(s=u||s===e?1:Y(s),s=c-s,Se(r,s<0?0:s,c)):[]}function fE(r,s){return r&&r.length?Bs(r,B(s,3),!1,!0):[]}function dE(r,s){return r&&r.length?Bs(r,B(s,3)):[]}var gE=Z(function(r){return vn(qt(r,1,St,!0))}),pE=Z(function(r){var s=Ce(r);return St(s)&&(s=e),vn(qt(r,1,St,!0),B(s,2))}),mE=Z(function(r){var s=Ce(r);return s=typeof s=="function"?s:e,vn(qt(r,1,St,!0),e,s)});function _E(r){return r&&r.length?vn(r):[]}function yE(r,s){return r&&r.length?vn(r,B(s,2)):[]}function vE(r,s){return s=typeof s=="function"?s:e,r&&r.length?vn(r,e,s):[]}function yu(r){if(!(r&&r.length))return[];var s=0;return r=gn(r,function(u){if(St(u))return s=bt(u.length,s),!0}),Ma(s,function(u){return vt(r,ba(u))})}function bf(r,s){if(!(r&&r.length))return[];var u=yu(r);return s==null?u:vt(u,function(c){return he(s,e,c)})}var EE=Z(function(r,s){return St(r)?ai(r,s):[]}),TE=Z(function(r){return nu(gn(r,St))}),wE=Z(function(r){var s=Ce(r);return St(s)&&(s=e),nu(gn(r,St),B(s,2))}),IE=Z(function(r){var s=Ce(r);return s=typeof s=="function"?s:e,nu(gn(r,St),e,s)}),AE=Z(yu);function RE(r,s){return jh(r||[],s||[],oi)}function SE(r,s){return jh(r||[],s||[],ci)}var CE=Z(function(r){var s=r.length,u=s>1?r[s-1]:e;return u=typeof u=="function"?(r.pop(),u):e,bf(r,u)});function Nf(r){var s=g(r);return s.__chain__=!0,s}function PE(r,s){return s(r),r}function js(r,s){return s(r)}var VE=rn(function(r){var s=r.length,u=s?r[0]:0,c=this.__wrapped__,f=function(p){return Wa(p,r)};return s>1||this.__actions__.length||!(c instanceof et)||!sn(u)?this.thru(f):(c=c.slice(u,+u+(s?1:0)),c.__actions__.push({func:js,args:[f],thisArg:e}),new Ae(c,this.__chain__).thru(function(p){return s&&!p.length&&p.push(e),p}))});function DE(){return Nf(this)}function xE(){return new Ae(this.value(),this.__chain__)}function bE(){this.__values__===e&&(this.__values__=Kf(this.value()));var r=this.__index__>=this.__values__.length,s=r?e:this.__values__[this.__index__++];return{done:r,value:s}}function NE(){return this}function OE(r){for(var s,u=this;u instanceof Os;){var c=Sf(u);c.__index__=0,c.__values__=e,s?f.__wrapped__=c:s=c;var f=c;u=u.__wrapped__}return f.__wrapped__=r,s}function ME(){var r=this.__wrapped__;if(r instanceof et){var s=r;return this.__actions__.length&&(s=new et(this)),s=s.reverse(),s.__actions__.push({func:js,args:[_u],thisArg:e}),new Ae(s,this.__chain__)}return this.thru(_u)}function LE(){return Qh(this.__wrapped__,this.__actions__)}var kE=qs(function(r,s,u){ct.call(r,u)?++r[u]:en(r,u,1)});function FE(r,s,u){var c=Q(r)?ah:Pv;return u&&ie(r,s,u)&&(s=e),c(r,B(s,3))}function UE(r,s){var u=Q(r)?gn:xh;return u(r,B(s,3))}var BE=of(Cf),qE=of(Pf);function $E(r,s){return qt(Ys(r,s),1)}function WE(r,s){return qt(Ys(r,s),On)}function zE(r,s,u){return u=u===e?1:Y(u),qt(Ys(r,s),u)}function Of(r,s){var u=Q(r)?we:yn;return u(r,B(s,3))}function Mf(r,s){var u=Q(r)?ly:Dh;return u(r,B(s,3))}var GE=qs(function(r,s,u){ct.call(r,u)?r[u].push(s):en(r,u,[s])});function HE(r,s,u,c){r=ue(r)?r:vr(r),u=u&&!c?Y(u):0;var f=r.length;return u<0&&(u=bt(f+u,0)),eo(r)?u<=f&&r.indexOf(s,u)>-1:!!f&&ar(r,s,u)>-1}var KE=Z(function(r,s,u){var c=-1,f=typeof s=="function",p=ue(r)?I(r.length):[];return yn(r,function(y){p[++c]=f?he(s,y,u):ui(y,s,u)}),p}),QE=qs(function(r,s,u){en(r,u,s)});function Ys(r,s){var u=Q(r)?vt:kh;return u(r,B(s,3))}function jE(r,s,u,c){return r==null?[]:(Q(s)||(s=s==null?[]:[s]),u=c?e:u,Q(u)||(u=u==null?[]:[u]),qh(r,s,u))}var YE=qs(function(r,s,u){r[u?0:1].push(s)},function(){return[[],[]]});function XE(r,s,u){var c=Q(r)?Da:hh,f=arguments.length<3;return c(r,B(s,4),u,f,yn)}function JE(r,s,u){var c=Q(r)?cy:hh,f=arguments.length<3;return c(r,B(s,4),u,f,Dh)}function ZE(r,s){var u=Q(r)?gn:xh;return u(r,Zs(B(s,3)))}function tT(r){var s=Q(r)?Sh:Hv;return s(r)}function eT(r,s,u){(u?ie(r,s,u):s===e)?s=1:s=Y(s);var c=Q(r)?Iv:Kv;return c(r,s)}function nT(r){var s=Q(r)?Av:jv;return s(r)}function rT(r){if(r==null)return 0;if(ue(r))return eo(r)?lr(r):r.length;var s=Yt(r);return s==xe||s==be?r.size:ja(r).length}function iT(r,s,u){var c=Q(r)?xa:Yv;return u&&ie(r,s,u)&&(s=e),c(r,B(s,3))}var sT=Z(function(r,s){if(r==null)return[];var u=s.length;return u>1&&ie(r,s[0],s[1])?s=[]:u>2&&ie(s[0],s[1],s[2])&&(s=[s[0]]),qh(r,qt(s,1),[])}),Xs=Uy||function(){return Bt.Date.now()};function oT(r,s){if(typeof s!="function")throw new Ie(l);return r=Y(r),function(){if(--r<1)return s.apply(this,arguments)}}function Lf(r,s,u){return s=u?e:s,s=r&&s==null?r.length:s,nn(r,Ee,e,e,e,e,s)}function kf(r,s){var u;if(typeof s!="function")throw new Ie(l);return r=Y(r),function(){return--r>0&&(u=s.apply(this,arguments)),r<=1&&(s=e),u}}var vu=Z(function(r,s,u){var c=F;if(u.length){var f=mn(u,_r(vu));c|=Qt}return nn(r,c,s,u,f)}),Ff=Z(function(r,s,u){var c=F|lt;if(u.length){var f=mn(u,_r(Ff));c|=Qt}return nn(s,c,r,u,f)});function Uf(r,s,u){s=u?e:s;var c=nn(r,yt,e,e,e,e,e,s);return c.placeholder=Uf.placeholder,c}function Bf(r,s,u){s=u?e:s;var c=nn(r,Kt,e,e,e,e,e,s);return c.placeholder=Bf.placeholder,c}function qf(r,s,u){var c,f,p,y,v,T,R=0,S=!1,V=!1,b=!0;if(typeof r!="function")throw new Ie(l);s=Pe(s)||0,Tt(u)&&(S=!!u.leading,V="maxWait"in u,p=V?bt(Pe(u.maxWait)||0,s):p,b="trailing"in u?!!u.trailing:b);function k(Ct){var Le=c,un=f;return c=f=e,R=Ct,y=r.apply(un,Le),y}function q(Ct){return R=Ct,v=di(tt,s),S?k(Ct):y}function J(Ct){var Le=Ct-T,un=Ct-R,od=s-Le;return V?jt(od,p-un):od}function $(Ct){var Le=Ct-T,un=Ct-R;return T===e||Le>=s||Le<0||V&&un>=p}function tt(){var Ct=Xs();if($(Ct))return rt(Ct);v=di(tt,J(Ct))}function rt(Ct){return v=e,b&&c?k(Ct):(c=f=e,y)}function pe(){v!==e&&Yh(v),R=0,c=T=f=v=e}function se(){return v===e?y:rt(Xs())}function me(){var Ct=Xs(),Le=$(Ct);if(c=arguments,f=this,T=Ct,Le){if(v===e)return q(T);if(V)return Yh(v),v=di(tt,s),k(T)}return v===e&&(v=di(tt,s)),y}return me.cancel=pe,me.flush=se,me}var aT=Z(function(r,s){return Vh(r,1,s)}),uT=Z(function(r,s,u){return Vh(r,Pe(s)||0,u)});function lT(r){return nn(r,Hr)}function Js(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new Ie(l);var u=function(){var c=arguments,f=s?s.apply(this,c):c[0],p=u.cache;if(p.has(f))return p.get(f);var y=r.apply(this,c);return u.cache=p.set(f,y)||p,y};return u.cache=new(Js.Cache||tn),u}Js.Cache=tn;function Zs(r){if(typeof r!="function")throw new Ie(l);return function(){var s=arguments;switch(s.length){case 0:return!r.call(this);case 1:return!r.call(this,s[0]);case 2:return!r.call(this,s[0],s[1]);case 3:return!r.call(this,s[0],s[1],s[2])}return!r.apply(this,s)}}function cT(r){return kf(2,r)}var hT=Xv(function(r,s){s=s.length==1&&Q(s[0])?vt(s[0],fe(B())):vt(qt(s,1),fe(B()));var u=s.length;return Z(function(c){for(var f=-1,p=jt(c.length,u);++f<p;)c[f]=s[f].call(this,c[f]);return he(r,this,c)})}),Eu=Z(function(r,s){var u=mn(s,_r(Eu));return nn(r,Qt,e,s,u)}),$f=Z(function(r,s){var u=mn(s,_r($f));return nn(r,ve,e,s,u)}),fT=rn(function(r,s){return nn(r,rr,e,e,e,s)});function dT(r,s){if(typeof r!="function")throw new Ie(l);return s=s===e?s:Y(s),Z(r,s)}function gT(r,s){if(typeof r!="function")throw new Ie(l);return s=s==null?0:bt(Y(s),0),Z(function(u){var c=u[s],f=Tn(u,0,s);return c&&pn(f,c),he(r,this,f)})}function pT(r,s,u){var c=!0,f=!0;if(typeof r!="function")throw new Ie(l);return Tt(u)&&(c="leading"in u?!!u.leading:c,f="trailing"in u?!!u.trailing:f),qf(r,s,{leading:c,maxWait:s,trailing:f})}function mT(r){return Lf(r,1)}function _T(r,s){return Eu(iu(s),r)}function yT(){if(!arguments.length)return[];var r=arguments[0];return Q(r)?r:[r]}function vT(r){return Re(r,x)}function ET(r,s){return s=typeof s=="function"?s:e,Re(r,x,s)}function TT(r){return Re(r,w|x)}function wT(r,s){return s=typeof s=="function"?s:e,Re(r,w|x,s)}function IT(r,s){return s==null||Ph(r,s,Mt(s))}function Me(r,s){return r===s||r!==r&&s!==s}var AT=Gs(Ha),RT=Gs(function(r,s){return r>=s}),Wn=Oh(function(){return arguments}())?Oh:function(r){return At(r)&&ct.call(r,"callee")&&!Eh.call(r,"callee")},Q=I.isArray,ST=eh?fe(eh):Ov;function ue(r){return r!=null&&to(r.length)&&!on(r)}function St(r){return At(r)&&ue(r)}function CT(r){return r===!0||r===!1||At(r)&&re(r)==Kr}var wn=qy||xu,PT=nh?fe(nh):Mv;function VT(r){return At(r)&&r.nodeType===1&&!gi(r)}function DT(r){if(r==null)return!0;if(ue(r)&&(Q(r)||typeof r=="string"||typeof r.splice=="function"||wn(r)||yr(r)||Wn(r)))return!r.length;var s=Yt(r);if(s==xe||s==be)return!r.size;if(fi(r))return!ja(r).length;for(var u in r)if(ct.call(r,u))return!1;return!0}function xT(r,s){return li(r,s)}function bT(r,s,u){u=typeof u=="function"?u:e;var c=u?u(r,s):e;return c===e?li(r,s,e,u):!!c}function Tu(r){if(!At(r))return!1;var s=re(r);return s==fs||s==e_||typeof r.message=="string"&&typeof r.name=="string"&&!gi(r)}function NT(r){return typeof r=="number"&&wh(r)}function on(r){if(!Tt(r))return!1;var s=re(r);return s==ds||s==Vc||s==t_||s==r_}function Wf(r){return typeof r=="number"&&r==Y(r)}function to(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=dn}function Tt(r){var s=typeof r;return r!=null&&(s=="object"||s=="function")}function At(r){return r!=null&&typeof r=="object"}var zf=rh?fe(rh):kv;function OT(r,s){return r===s||Qa(r,s,hu(s))}function MT(r,s,u){return u=typeof u=="function"?u:e,Qa(r,s,hu(s),u)}function LT(r){return Gf(r)&&r!=+r}function kT(r){if(E0(r))throw new H(a);return Mh(r)}function FT(r){return r===null}function UT(r){return r==null}function Gf(r){return typeof r=="number"||At(r)&&re(r)==jr}function gi(r){if(!At(r)||re(r)!=Je)return!1;var s=Cs(r);if(s===null)return!0;var u=ct.call(s,"constructor")&&s.constructor;return typeof u=="function"&&u instanceof u&&Is.call(u)==My}var wu=ih?fe(ih):Fv;function BT(r){return Wf(r)&&r>=-dn&&r<=dn}var Hf=sh?fe(sh):Uv;function eo(r){return typeof r=="string"||!Q(r)&&At(r)&&re(r)==Xr}function ge(r){return typeof r=="symbol"||At(r)&&re(r)==gs}var yr=oh?fe(oh):Bv;function qT(r){return r===e}function $T(r){return At(r)&&Yt(r)==Jr}function WT(r){return At(r)&&re(r)==s_}var zT=Gs(Ya),GT=Gs(function(r,s){return r<=s});function Kf(r){if(!r)return[];if(ue(r))return eo(r)?Ne(r):ae(r);if(ei&&r[ei])return Iy(r[ei]());var s=Yt(r),u=s==xe?ka:s==be?Es:vr;return u(r)}function an(r){if(!r)return r===0?r:0;if(r=Pe(r),r===On||r===-On){var s=r<0?-1:1;return s*Ym}return r===r?r:0}function Y(r){var s=an(r),u=s%1;return s===s?u?s-u:s:0}function Qf(r){return r?Un(Y(r),0,$e):0}function Pe(r){if(typeof r=="number")return r;if(ge(r))return cs;if(Tt(r)){var s=typeof r.valueOf=="function"?r.valueOf():r;r=Tt(s)?s+"":s}if(typeof r!="string")return r===0?r:+r;r=fh(r);var u=S_.test(r);return u||P_.test(r)?oy(r.slice(2),u?2:8):R_.test(r)?cs:+r}function jf(r){return ze(r,le(r))}function HT(r){return r?Un(Y(r),-dn,dn):r===0?r:0}function ut(r){return r==null?"":de(r)}var KT=pr(function(r,s){if(fi(s)||ue(s)){ze(s,Mt(s),r);return}for(var u in s)ct.call(s,u)&&oi(r,u,s[u])}),Yf=pr(function(r,s){ze(s,le(s),r)}),no=pr(function(r,s,u,c){ze(s,le(s),r,c)}),QT=pr(function(r,s,u,c){ze(s,Mt(s),r,c)}),jT=rn(Wa);function YT(r,s){var u=gr(r);return s==null?u:Ch(u,s)}var XT=Z(function(r,s){r=ft(r);var u=-1,c=s.length,f=c>2?s[2]:e;for(f&&ie(s[0],s[1],f)&&(c=1);++u<c;)for(var p=s[u],y=le(p),v=-1,T=y.length;++v<T;){var R=y[v],S=r[R];(S===e||Me(S,hr[R])&&!ct.call(r,R))&&(r[R]=p[R])}return r}),JT=Z(function(r){return r.push(e,df),he(Xf,e,r)});function ZT(r,s){return uh(r,B(s,3),We)}function tw(r,s){return uh(r,B(s,3),Ga)}function ew(r,s){return r==null?r:za(r,B(s,3),le)}function nw(r,s){return r==null?r:bh(r,B(s,3),le)}function rw(r,s){return r&&We(r,B(s,3))}function iw(r,s){return r&&Ga(r,B(s,3))}function sw(r){return r==null?[]:ks(r,Mt(r))}function ow(r){return r==null?[]:ks(r,le(r))}function Iu(r,s,u){var c=r==null?e:Bn(r,s);return c===e?u:c}function aw(r,s){return r!=null&&mf(r,s,Dv)}function Au(r,s){return r!=null&&mf(r,s,xv)}var uw=uf(function(r,s,u){s!=null&&typeof s.toString!="function"&&(s=As.call(s)),r[s]=u},Su(ce)),lw=uf(function(r,s,u){s!=null&&typeof s.toString!="function"&&(s=As.call(s)),ct.call(r,s)?r[s].push(u):r[s]=[u]},B),cw=Z(ui);function Mt(r){return ue(r)?Rh(r):ja(r)}function le(r){return ue(r)?Rh(r,!0):qv(r)}function hw(r,s){var u={};return s=B(s,3),We(r,function(c,f,p){en(u,s(c,f,p),c)}),u}function fw(r,s){var u={};return s=B(s,3),We(r,function(c,f,p){en(u,f,s(c,f,p))}),u}var dw=pr(function(r,s,u){Fs(r,s,u)}),Xf=pr(function(r,s,u,c){Fs(r,s,u,c)}),gw=rn(function(r,s){var u={};if(r==null)return u;var c=!1;s=vt(s,function(p){return p=En(p,r),c||(c=p.length>1),p}),ze(r,lu(r),u),c&&(u=Re(u,w|P|x,u0));for(var f=s.length;f--;)eu(u,s[f]);return u});function pw(r,s){return Jf(r,Zs(B(s)))}var mw=rn(function(r,s){return r==null?{}:Wv(r,s)});function Jf(r,s){if(r==null)return{};var u=vt(lu(r),function(c){return[c]});return s=B(s),$h(r,u,function(c,f){return s(c,f[0])})}function _w(r,s,u){s=En(s,r);var c=-1,f=s.length;for(f||(f=1,r=e);++c<f;){var p=r==null?e:r[Ge(s[c])];p===e&&(c=f,p=u),r=on(p)?p.call(r):p}return r}function yw(r,s,u){return r==null?r:ci(r,s,u)}function vw(r,s,u,c){return c=typeof c=="function"?c:e,r==null?r:ci(r,s,u,c)}var Zf=hf(Mt),td=hf(le);function Ew(r,s,u){var c=Q(r),f=c||wn(r)||yr(r);if(s=B(s,4),u==null){var p=r&&r.constructor;f?u=c?new p:[]:Tt(r)?u=on(p)?gr(Cs(r)):{}:u={}}return(f?we:We)(r,function(y,v,T){return s(u,y,v,T)}),u}function Tw(r,s){return r==null?!0:eu(r,s)}function ww(r,s,u){return r==null?r:Kh(r,s,iu(u))}function Iw(r,s,u,c){return c=typeof c=="function"?c:e,r==null?r:Kh(r,s,iu(u),c)}function vr(r){return r==null?[]:La(r,Mt(r))}function Aw(r){return r==null?[]:La(r,le(r))}function Rw(r,s,u){return u===e&&(u=s,s=e),u!==e&&(u=Pe(u),u=u===u?u:0),s!==e&&(s=Pe(s),s=s===s?s:0),Un(Pe(r),s,u)}function Sw(r,s,u){return s=an(s),u===e?(u=s,s=0):u=an(u),r=Pe(r),bv(r,s,u)}function Cw(r,s,u){if(u&&typeof u!="boolean"&&ie(r,s,u)&&(s=u=e),u===e&&(typeof s=="boolean"?(u=s,s=e):typeof r=="boolean"&&(u=r,r=e)),r===e&&s===e?(r=0,s=1):(r=an(r),s===e?(s=r,r=0):s=an(s)),r>s){var c=r;r=s,s=c}if(u||r%1||s%1){var f=Ih();return jt(r+f*(s-r+sy("1e-"+((f+"").length-1))),s)}return Ja(r,s)}var Pw=mr(function(r,s,u){return s=s.toLowerCase(),r+(u?ed(s):s)});function ed(r){return Ru(ut(r).toLowerCase())}function nd(r){return r=ut(r),r&&r.replace(D_,yy).replace(j_,"")}function Vw(r,s,u){r=ut(r),s=de(s);var c=r.length;u=u===e?c:Un(Y(u),0,c);var f=u;return u-=s.length,u>=0&&r.slice(u,f)==s}function Dw(r){return r=ut(r),r&&c_.test(r)?r.replace(bc,vy):r}function xw(r){return r=ut(r),r&&m_.test(r)?r.replace(Ea,"\\$&"):r}var bw=mr(function(r,s,u){return r+(u?"-":"")+s.toLowerCase()}),Nw=mr(function(r,s,u){return r+(u?" ":"")+s.toLowerCase()}),Ow=sf("toLowerCase");function Mw(r,s,u){r=ut(r),s=Y(s);var c=s?lr(r):0;if(!s||c>=s)return r;var f=(s-c)/2;return zs(xs(f),u)+r+zs(Ds(f),u)}function Lw(r,s,u){r=ut(r),s=Y(s);var c=s?lr(r):0;return s&&c<s?r+zs(s-c,u):r}function kw(r,s,u){r=ut(r),s=Y(s);var c=s?lr(r):0;return s&&c<s?zs(s-c,u)+r:r}function Fw(r,s,u){return u||s==null?s=0:s&&(s=+s),Gy(ut(r).replace(Ta,""),s||0)}function Uw(r,s,u){return(u?ie(r,s,u):s===e)?s=1:s=Y(s),Za(ut(r),s)}function Bw(){var r=arguments,s=ut(r[0]);return r.length<3?s:s.replace(r[1],r[2])}var qw=mr(function(r,s,u){return r+(u?"_":"")+s.toLowerCase()});function $w(r,s,u){return u&&typeof u!="number"&&ie(r,s,u)&&(s=u=e),u=u===e?$e:u>>>0,u?(r=ut(r),r&&(typeof s=="string"||s!=null&&!wu(s))&&(s=de(s),!s&&ur(r))?Tn(Ne(r),0,u):r.split(s,u)):[]}var Ww=mr(function(r,s,u){return r+(u?" ":"")+Ru(s)});function zw(r,s,u){return r=ut(r),u=u==null?0:Un(Y(u),0,r.length),s=de(s),r.slice(u,u+s.length)==s}function Gw(r,s,u){var c=g.templateSettings;u&&ie(r,s,u)&&(s=e),r=ut(r),s=no({},s,c,ff);var f=no({},s.imports,c.imports,ff),p=Mt(f),y=La(f,p),v,T,R=0,S=s.interpolate||ps,V="__p += '",b=Fa((s.escape||ps).source+"|"+S.source+"|"+(S===Nc?A_:ps).source+"|"+(s.evaluate||ps).source+"|$","g"),k="//# sourceURL="+(ct.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ty+"]")+`
`;r.replace(b,function($,tt,rt,pe,se,me){return rt||(rt=pe),V+=r.slice(R,me).replace(x_,Ey),tt&&(v=!0,V+=`' +
__e(`+tt+`) +
'`),se&&(T=!0,V+=`';
`+se+`;
__p += '`),rt&&(V+=`' +
((__t = (`+rt+`)) == null ? '' : __t) +
'`),R=me+$.length,$}),V+=`';
`;var q=ct.call(s,"variable")&&s.variable;if(!q)V=`with (obj) {
`+V+`
}
`;else if(w_.test(q))throw new H(h);V=(T?V.replace(o_,""):V).replace(a_,"$1").replace(u_,"$1;"),V="function("+(q||"obj")+`) {
`+(q?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(v?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+V+`return __p
}`;var J=id(function(){return ot(p,k+"return "+V).apply(e,y)});if(J.source=V,Tu(J))throw J;return J}function Hw(r){return ut(r).toLowerCase()}function Kw(r){return ut(r).toUpperCase()}function Qw(r,s,u){if(r=ut(r),r&&(u||s===e))return fh(r);if(!r||!(s=de(s)))return r;var c=Ne(r),f=Ne(s),p=dh(c,f),y=gh(c,f)+1;return Tn(c,p,y).join("")}function jw(r,s,u){if(r=ut(r),r&&(u||s===e))return r.slice(0,mh(r)+1);if(!r||!(s=de(s)))return r;var c=Ne(r),f=gh(c,Ne(s))+1;return Tn(c,0,f).join("")}function Yw(r,s,u){if(r=ut(r),r&&(u||s===e))return r.replace(Ta,"");if(!r||!(s=de(s)))return r;var c=Ne(r),f=dh(c,Ne(s));return Tn(c,f).join("")}function Xw(r,s){var u=ls,c=Gm;if(Tt(s)){var f="separator"in s?s.separator:f;u="length"in s?Y(s.length):u,c="omission"in s?de(s.omission):c}r=ut(r);var p=r.length;if(ur(r)){var y=Ne(r);p=y.length}if(u>=p)return r;var v=u-lr(c);if(v<1)return c;var T=y?Tn(y,0,v).join(""):r.slice(0,v);if(f===e)return T+c;if(y&&(v+=T.length-v),wu(f)){if(r.slice(v).search(f)){var R,S=T;for(f.global||(f=Fa(f.source,ut(Oc.exec(f))+"g")),f.lastIndex=0;R=f.exec(S);)var V=R.index;T=T.slice(0,V===e?v:V)}}else if(r.indexOf(de(f),v)!=v){var b=T.lastIndexOf(f);b>-1&&(T=T.slice(0,b))}return T+c}function Jw(r){return r=ut(r),r&&l_.test(r)?r.replace(xc,Cy):r}var Zw=mr(function(r,s,u){return r+(u?" ":"")+s.toUpperCase()}),Ru=sf("toUpperCase");function rd(r,s,u){return r=ut(r),s=u?e:s,s===e?wy(r)?Dy(r):dy(r):r.match(s)||[]}var id=Z(function(r,s){try{return he(r,e,s)}catch(u){return Tu(u)?u:new H(u)}}),tI=rn(function(r,s){return we(s,function(u){u=Ge(u),en(r,u,vu(r[u],r))}),r});function eI(r){var s=r==null?0:r.length,u=B();return r=s?vt(r,function(c){if(typeof c[1]!="function")throw new Ie(l);return[u(c[0]),c[1]]}):[],Z(function(c){for(var f=-1;++f<s;){var p=r[f];if(he(p[0],this,c))return he(p[1],this,c)}})}function nI(r){return Cv(Re(r,w))}function Su(r){return function(){return r}}function rI(r,s){return r==null||r!==r?s:r}var iI=af(),sI=af(!0);function ce(r){return r}function Cu(r){return Lh(typeof r=="function"?r:Re(r,w))}function oI(r){return Fh(Re(r,w))}function aI(r,s){return Uh(r,Re(s,w))}var uI=Z(function(r,s){return function(u){return ui(u,r,s)}}),lI=Z(function(r,s){return function(u){return ui(r,u,s)}});function Pu(r,s,u){var c=Mt(s),f=ks(s,c);u==null&&!(Tt(s)&&(f.length||!c.length))&&(u=s,s=r,r=this,f=ks(s,Mt(s)));var p=!(Tt(u)&&"chain"in u)||!!u.chain,y=on(r);return we(f,function(v){var T=s[v];r[v]=T,y&&(r.prototype[v]=function(){var R=this.__chain__;if(p||R){var S=r(this.__wrapped__),V=S.__actions__=ae(this.__actions__);return V.push({func:T,args:arguments,thisArg:r}),S.__chain__=R,S}return T.apply(r,pn([this.value()],arguments))})}),r}function cI(){return Bt._===this&&(Bt._=Ly),this}function Vu(){}function hI(r){return r=Y(r),Z(function(s){return Bh(s,r)})}var fI=ou(vt),dI=ou(ah),gI=ou(xa);function sd(r){return du(r)?ba(Ge(r)):zv(r)}function pI(r){return function(s){return r==null?e:Bn(r,s)}}var mI=lf(),_I=lf(!0);function Du(){return[]}function xu(){return!1}function yI(){return{}}function vI(){return""}function EI(){return!0}function TI(r,s){if(r=Y(r),r<1||r>dn)return[];var u=$e,c=jt(r,$e);s=B(s),r-=$e;for(var f=Ma(c,s);++u<r;)s(u);return f}function wI(r){return Q(r)?vt(r,Ge):ge(r)?[r]:ae(Rf(ut(r)))}function II(r){var s=++Oy;return ut(r)+s}var AI=Ws(function(r,s){return r+s},0),RI=au("ceil"),SI=Ws(function(r,s){return r/s},1),CI=au("floor");function PI(r){return r&&r.length?Ls(r,ce,Ha):e}function VI(r,s){return r&&r.length?Ls(r,B(s,2),Ha):e}function DI(r){return ch(r,ce)}function xI(r,s){return ch(r,B(s,2))}function bI(r){return r&&r.length?Ls(r,ce,Ya):e}function NI(r,s){return r&&r.length?Ls(r,B(s,2),Ya):e}var OI=Ws(function(r,s){return r*s},1),MI=au("round"),LI=Ws(function(r,s){return r-s},0);function kI(r){return r&&r.length?Oa(r,ce):0}function FI(r,s){return r&&r.length?Oa(r,B(s,2)):0}return g.after=oT,g.ary=Lf,g.assign=KT,g.assignIn=Yf,g.assignInWith=no,g.assignWith=QT,g.at=jT,g.before=kf,g.bind=vu,g.bindAll=tI,g.bindKey=Ff,g.castArray=yT,g.chain=Nf,g.chunk=C0,g.compact=P0,g.concat=V0,g.cond=eI,g.conforms=nI,g.constant=Su,g.countBy=kE,g.create=YT,g.curry=Uf,g.curryRight=Bf,g.debounce=qf,g.defaults=XT,g.defaultsDeep=JT,g.defer=aT,g.delay=uT,g.difference=D0,g.differenceBy=x0,g.differenceWith=b0,g.drop=N0,g.dropRight=O0,g.dropRightWhile=M0,g.dropWhile=L0,g.fill=k0,g.filter=UE,g.flatMap=$E,g.flatMapDeep=WE,g.flatMapDepth=zE,g.flatten=Vf,g.flattenDeep=F0,g.flattenDepth=U0,g.flip=lT,g.flow=iI,g.flowRight=sI,g.fromPairs=B0,g.functions=sw,g.functionsIn=ow,g.groupBy=GE,g.initial=$0,g.intersection=W0,g.intersectionBy=z0,g.intersectionWith=G0,g.invert=uw,g.invertBy=lw,g.invokeMap=KE,g.iteratee=Cu,g.keyBy=QE,g.keys=Mt,g.keysIn=le,g.map=Ys,g.mapKeys=hw,g.mapValues=fw,g.matches=oI,g.matchesProperty=aI,g.memoize=Js,g.merge=dw,g.mergeWith=Xf,g.method=uI,g.methodOf=lI,g.mixin=Pu,g.negate=Zs,g.nthArg=hI,g.omit=gw,g.omitBy=pw,g.once=cT,g.orderBy=jE,g.over=fI,g.overArgs=hT,g.overEvery=dI,g.overSome=gI,g.partial=Eu,g.partialRight=$f,g.partition=YE,g.pick=mw,g.pickBy=Jf,g.property=sd,g.propertyOf=pI,g.pull=j0,g.pullAll=xf,g.pullAllBy=Y0,g.pullAllWith=X0,g.pullAt=J0,g.range=mI,g.rangeRight=_I,g.rearg=fT,g.reject=ZE,g.remove=Z0,g.rest=dT,g.reverse=_u,g.sampleSize=eT,g.set=yw,g.setWith=vw,g.shuffle=nT,g.slice=tE,g.sortBy=sT,g.sortedUniq=aE,g.sortedUniqBy=uE,g.split=$w,g.spread=gT,g.tail=lE,g.take=cE,g.takeRight=hE,g.takeRightWhile=fE,g.takeWhile=dE,g.tap=PE,g.throttle=pT,g.thru=js,g.toArray=Kf,g.toPairs=Zf,g.toPairsIn=td,g.toPath=wI,g.toPlainObject=jf,g.transform=Ew,g.unary=mT,g.union=gE,g.unionBy=pE,g.unionWith=mE,g.uniq=_E,g.uniqBy=yE,g.uniqWith=vE,g.unset=Tw,g.unzip=yu,g.unzipWith=bf,g.update=ww,g.updateWith=Iw,g.values=vr,g.valuesIn=Aw,g.without=EE,g.words=rd,g.wrap=_T,g.xor=TE,g.xorBy=wE,g.xorWith=IE,g.zip=AE,g.zipObject=RE,g.zipObjectDeep=SE,g.zipWith=CE,g.entries=Zf,g.entriesIn=td,g.extend=Yf,g.extendWith=no,Pu(g,g),g.add=AI,g.attempt=id,g.camelCase=Pw,g.capitalize=ed,g.ceil=RI,g.clamp=Rw,g.clone=vT,g.cloneDeep=TT,g.cloneDeepWith=wT,g.cloneWith=ET,g.conformsTo=IT,g.deburr=nd,g.defaultTo=rI,g.divide=SI,g.endsWith=Vw,g.eq=Me,g.escape=Dw,g.escapeRegExp=xw,g.every=FE,g.find=BE,g.findIndex=Cf,g.findKey=ZT,g.findLast=qE,g.findLastIndex=Pf,g.findLastKey=tw,g.floor=CI,g.forEach=Of,g.forEachRight=Mf,g.forIn=ew,g.forInRight=nw,g.forOwn=rw,g.forOwnRight=iw,g.get=Iu,g.gt=AT,g.gte=RT,g.has=aw,g.hasIn=Au,g.head=Df,g.identity=ce,g.includes=HE,g.indexOf=q0,g.inRange=Sw,g.invoke=cw,g.isArguments=Wn,g.isArray=Q,g.isArrayBuffer=ST,g.isArrayLike=ue,g.isArrayLikeObject=St,g.isBoolean=CT,g.isBuffer=wn,g.isDate=PT,g.isElement=VT,g.isEmpty=DT,g.isEqual=xT,g.isEqualWith=bT,g.isError=Tu,g.isFinite=NT,g.isFunction=on,g.isInteger=Wf,g.isLength=to,g.isMap=zf,g.isMatch=OT,g.isMatchWith=MT,g.isNaN=LT,g.isNative=kT,g.isNil=UT,g.isNull=FT,g.isNumber=Gf,g.isObject=Tt,g.isObjectLike=At,g.isPlainObject=gi,g.isRegExp=wu,g.isSafeInteger=BT,g.isSet=Hf,g.isString=eo,g.isSymbol=ge,g.isTypedArray=yr,g.isUndefined=qT,g.isWeakMap=$T,g.isWeakSet=WT,g.join=H0,g.kebabCase=bw,g.last=Ce,g.lastIndexOf=K0,g.lowerCase=Nw,g.lowerFirst=Ow,g.lt=zT,g.lte=GT,g.max=PI,g.maxBy=VI,g.mean=DI,g.meanBy=xI,g.min=bI,g.minBy=NI,g.stubArray=Du,g.stubFalse=xu,g.stubObject=yI,g.stubString=vI,g.stubTrue=EI,g.multiply=OI,g.nth=Q0,g.noConflict=cI,g.noop=Vu,g.now=Xs,g.pad=Mw,g.padEnd=Lw,g.padStart=kw,g.parseInt=Fw,g.random=Cw,g.reduce=XE,g.reduceRight=JE,g.repeat=Uw,g.replace=Bw,g.result=_w,g.round=MI,g.runInContext=E,g.sample=tT,g.size=rT,g.snakeCase=qw,g.some=iT,g.sortedIndex=eE,g.sortedIndexBy=nE,g.sortedIndexOf=rE,g.sortedLastIndex=iE,g.sortedLastIndexBy=sE,g.sortedLastIndexOf=oE,g.startCase=Ww,g.startsWith=zw,g.subtract=LI,g.sum=kI,g.sumBy=FI,g.template=Gw,g.times=TI,g.toFinite=an,g.toInteger=Y,g.toLength=Qf,g.toLower=Hw,g.toNumber=Pe,g.toSafeInteger=HT,g.toString=ut,g.toUpper=Kw,g.trim=Qw,g.trimEnd=jw,g.trimStart=Yw,g.truncate=Xw,g.unescape=Jw,g.uniqueId=II,g.upperCase=Zw,g.upperFirst=Ru,g.each=Of,g.eachRight=Mf,g.first=Df,Pu(g,function(){var r={};return We(g,function(s,u){ct.call(g.prototype,u)||(r[u]=s)}),r}(),{chain:!1}),g.VERSION=i,we(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){g[r].placeholder=g}),we(["drop","take"],function(r,s){et.prototype[r]=function(u){u=u===e?1:bt(Y(u),0);var c=this.__filtered__&&!s?new et(this):this.clone();return c.__filtered__?c.__takeCount__=jt(u,c.__takeCount__):c.__views__.push({size:jt(u,$e),type:r+(c.__dir__<0?"Right":"")}),c},et.prototype[r+"Right"]=function(u){return this.reverse()[r](u).reverse()}}),we(["filter","map","takeWhile"],function(r,s){var u=s+1,c=u==Pc||u==jm;et.prototype[r]=function(f){var p=this.clone();return p.__iteratees__.push({iteratee:B(f,3),type:u}),p.__filtered__=p.__filtered__||c,p}}),we(["head","last"],function(r,s){var u="take"+(s?"Right":"");et.prototype[r]=function(){return this[u](1).value()[0]}}),we(["initial","tail"],function(r,s){var u="drop"+(s?"":"Right");et.prototype[r]=function(){return this.__filtered__?new et(this):this[u](1)}}),et.prototype.compact=function(){return this.filter(ce)},et.prototype.find=function(r){return this.filter(r).head()},et.prototype.findLast=function(r){return this.reverse().find(r)},et.prototype.invokeMap=Z(function(r,s){return typeof r=="function"?new et(this):this.map(function(u){return ui(u,r,s)})}),et.prototype.reject=function(r){return this.filter(Zs(B(r)))},et.prototype.slice=function(r,s){r=Y(r);var u=this;return u.__filtered__&&(r>0||s<0)?new et(u):(r<0?u=u.takeRight(-r):r&&(u=u.drop(r)),s!==e&&(s=Y(s),u=s<0?u.dropRight(-s):u.take(s-r)),u)},et.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},et.prototype.toArray=function(){return this.take($e)},We(et.prototype,function(r,s){var u=/^(?:filter|find|map|reject)|While$/.test(s),c=/^(?:head|last)$/.test(s),f=g[c?"take"+(s=="last"?"Right":""):s],p=c||/^find/.test(s);f&&(g.prototype[s]=function(){var y=this.__wrapped__,v=c?[1]:arguments,T=y instanceof et,R=v[0],S=T||Q(y),V=function(tt){var rt=f.apply(g,pn([tt],v));return c&&b?rt[0]:rt};S&&u&&typeof R=="function"&&R.length!=1&&(T=S=!1);var b=this.__chain__,k=!!this.__actions__.length,q=p&&!b,J=T&&!k;if(!p&&S){y=J?y:new et(this);var $=r.apply(y,v);return $.__actions__.push({func:js,args:[V],thisArg:e}),new Ae($,b)}return q&&J?r.apply(this,v):($=this.thru(V),q?c?$.value()[0]:$.value():$)})}),we(["pop","push","shift","sort","splice","unshift"],function(r){var s=Ts[r],u=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",c=/^(?:pop|shift)$/.test(r);g.prototype[r]=function(){var f=arguments;if(c&&!this.__chain__){var p=this.value();return s.apply(Q(p)?p:[],f)}return this[u](function(y){return s.apply(Q(y)?y:[],f)})}}),We(et.prototype,function(r,s){var u=g[s];if(u){var c=u.name+"";ct.call(dr,c)||(dr[c]=[]),dr[c].push({name:s,func:u})}}),dr[$s(e,lt).name]=[{name:"wrapper",func:e}],et.prototype.clone=Jy,et.prototype.reverse=Zy,et.prototype.value=tv,g.prototype.at=VE,g.prototype.chain=DE,g.prototype.commit=xE,g.prototype.next=bE,g.prototype.plant=OE,g.prototype.reverse=ME,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=LE,g.prototype.first=g.prototype.head,ei&&(g.prototype[ei]=NE),g},cr=xy();Mn?((Mn.exports=cr)._=cr,Ca._=cr):Bt._=cr}).call(mi)})(Eo,Eo.exports);var rA=Eo.exports;const mg=nA(rA),ld=n=>mg.merge({collection:"",model:{id:!1,name:""},options:{singular:"",plural:"",datatable:{headers:[{title:"Title",key:"name"}]}}},n),iA={page:ld({collection:"page",model:{id:!1,name:"",slug:"",compoments:[]},options:{singular:"Page",plural:"Pages",datatable:{headers:[{title:"Title",key:"name"},{title:"Slug",key:"slug"}]}}}),test:ld({collection:"test",model:{id:!1,name:"",level:"user",permissions:[]},options:{singular:"Test",plural:"Tests",datatable:{headers:[{title:"Name",key:"name"},{title:"Level",key:"level"},{title:"Permissions",key:"permissions"}]},levels:[{value:"user",title:"User"},{value:"admin",title:"Admin"}],permissions:[{value:"posts:create",title:"Create Posts"},{value:"posts:update",title:"Update Posts"},{value:"posts:delete",title:"Delete Posts"}]}})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _g=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?t[e++]=o:o<2048?(t[e++]=o>>6|192,t[e++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=o>>18|240,t[e++]=o>>12&63|128,t[e++]=o>>6&63|128,t[e++]=o&63|128):(t[e++]=o>>12|224,t[e++]=o>>6&63|128,t[e++]=o&63|128)}return t},sA=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const o=n[e++];if(o<128)t[i++]=String.fromCharCode(o);else if(o>191&&o<224){const a=n[e++];t[i++]=String.fromCharCode((o&31)<<6|a&63)}else if(o>239&&o<365){const a=n[e++],l=n[e++],h=n[e++],d=((o&7)<<18|(a&63)<<12|(l&63)<<6|h&63)-65536;t[i++]=String.fromCharCode(55296+(d>>10)),t[i++]=String.fromCharCode(56320+(d&1023))}else{const a=n[e++],l=n[e++];t[i++]=String.fromCharCode((o&15)<<12|(a&63)<<6|l&63)}}return t.join("")},yg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const a=n[o],l=o+1<n.length,h=l?n[o+1]:0,d=o+2<n.length,m=d?n[o+2]:0,_=a>>2,w=(a&3)<<4|h>>4;let P=(h&15)<<2|m>>6,x=m&63;d||(x=64,l||(P=64)),i.push(e[_],e[w],e[P],e[x])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(_g(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):sA(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const a=e[n.charAt(o++)],h=o<n.length?e[n.charAt(o)]:0;++o;const m=o<n.length?e[n.charAt(o)]:64;++o;const w=o<n.length?e[n.charAt(o)]:64;if(++o,a==null||h==null||m==null||w==null)throw new oA;const P=a<<2|h>>4;if(i.push(P),m!==64){const x=h<<4&240|m>>2;if(i.push(x),w!==64){const z=m<<6&192|w;i.push(z)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class oA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aA=function(n){const t=_g(n);return yg.encodeByteArray(t,!0)},To=function(n){return aA(n).replace(/\./g,"")},uA=function(n){try{return yg.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA=()=>lA().__FIREBASE_DEFAULTS__,hA=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},fA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&uA(n[1]);return t&&JSON.parse(t)},vg=()=>{try{return cA()||hA()||fA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},dA=n=>{var t,e;return(e=(t=vg())===null||t===void 0?void 0:t.emulatorHosts)===null||e===void 0?void 0:e[n]},gA=n=>{const t=dA(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},Eg=()=>{var n;return(n=vg())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mA(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",o=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n),h="";return[To(JSON.stringify(e)),To(JSON.stringify(l)),h].join(".")}function _A(){try{return typeof indexedDB=="object"}catch{return!1}}function yA(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{e=!1},o.onerror=()=>{var a;t(((a=o.error)===null||a===void 0?void 0:a.message)||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA="FirebaseError";class Fr extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=vA,Object.setPrototypeOf(this,Fr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tg.prototype.create)}}class Tg{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},o=`${this.service}/${t}`,a=this.errors[t],l=a?EA(a,i):"Error",h=`${this.serviceName}: ${l} (${o}).`;return new Fr(o,h,i)}}function EA(n,t){return n.replace(TA,(e,i)=>{const o=t[i];return o!=null?String(o):`<${i}?>`})}const TA=/\{\$([^}]+)}/g;function Ju(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const o of e){if(!i.includes(o))return!1;const a=n[o],l=t[o];if(cd(a)&&cd(l)){if(!Ju(a,l))return!1}else if(a!==l)return!1}for(const o of i)if(!e.includes(o))return!1;return!0}function cd(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(n){return n&&n._delegate?n._delegate:n}class Di{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new pA;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:e});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),o=(e=t==null?void 0:t.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(a){if(o)return null;throw a}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(AA(t))try{this.getOrInitializeService({instanceIdentifier:zn})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(e);try{const a=this.getOrInitializeService({instanceIdentifier:o});i.resolve(a)}catch{}}}}clearInstance(t=zn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=zn){return this.instances.has(t)}getOptions(t=zn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[a,l]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(a);i===h&&l.resolve(o)}return o}onInit(t,e){var i;const o=this.normalizeInstanceIdentifier(e),a=(i=this.onInitCallbacks.get(o))!==null&&i!==void 0?i:new Set;a.add(t),this.onInitCallbacks.set(o,a);const l=this.instances.get(o);return l&&t(l,o),()=>{a.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const o of i)try{o(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:IA(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=zn){return this.component?this.component.multipleInstances?t:zn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function IA(n){return n===zn?void 0:n}function AA(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new wA(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(st||(st={}));const SA={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},CA=st.INFO,PA={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},VA=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),o=PA[t];if(o)console[o](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class wg{constructor(t){this.name=t,this._logLevel=CA,this._logHandler=VA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in st))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?SA[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...t),this._logHandler(this,st.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...t),this._logHandler(this,st.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,st.INFO,...t),this._logHandler(this,st.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,st.WARN,...t),this._logHandler(this,st.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...t),this._logHandler(this,st.ERROR,...t)}}const DA=(n,t)=>t.some(e=>n instanceof e);let hd,fd;function xA(){return hd||(hd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bA(){return fd||(fd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ig=new WeakMap,Zu=new WeakMap,Ag=new WeakMap,Mu=new WeakMap,Vl=new WeakMap;function NA(n){const t=new Promise((e,i)=>{const o=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{e(Rn(n.result)),o()},l=()=>{i(n.error),o()};n.addEventListener("success",a),n.addEventListener("error",l)});return t.then(e=>{e instanceof IDBCursor&&Ig.set(e,n)}).catch(()=>{}),Vl.set(t,n),t}function OA(n){if(Zu.has(n))return;const t=new Promise((e,i)=>{const o=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{e(),o()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});Zu.set(n,t)}let tl={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Zu.get(n);if(t==="objectStoreNames")return n.objectStoreNames||Ag.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Rn(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function MA(n){tl=n(tl)}function LA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(Lu(this),t,...e);return Ag.set(i,t.sort?t.sort():[t]),Rn(i)}:bA().includes(n)?function(...t){return n.apply(Lu(this),t),Rn(Ig.get(this))}:function(...t){return Rn(n.apply(Lu(this),t))}}function kA(n){return typeof n=="function"?LA(n):(n instanceof IDBTransaction&&OA(n),DA(n,xA())?new Proxy(n,tl):n)}function Rn(n){if(n instanceof IDBRequest)return NA(n);if(Mu.has(n))return Mu.get(n);const t=kA(n);return t!==n&&(Mu.set(n,t),Vl.set(t,n)),t}const Lu=n=>Vl.get(n);function FA(n,t,{blocked:e,upgrade:i,blocking:o,terminated:a}={}){const l=indexedDB.open(n,t),h=Rn(l);return i&&l.addEventListener("upgradeneeded",d=>{i(Rn(l.result),d.oldVersion,d.newVersion,Rn(l.transaction),d)}),e&&l.addEventListener("blocked",d=>e(d.oldVersion,d.newVersion,d)),h.then(d=>{a&&d.addEventListener("close",()=>a()),o&&d.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}const UA=["get","getKey","getAll","getAllKeys","count"],BA=["put","add","delete","clear"],ku=new Map;function dd(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(ku.get(t))return ku.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,o=BA.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(o||UA.includes(e)))return;const a=async function(l,...h){const d=this.transaction(l,o?"readwrite":"readonly");let m=d.store;return i&&(m=m.index(h.shift())),(await Promise.all([m[e](...h),o&&d.done]))[0]};return ku.set(t,a),a}MA(n=>({...n,get:(t,e,i)=>dd(t,e)||n.get(t,e,i),has:(t,e)=>!!dd(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if($A(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function $A(n){const t=n.getComponent();return(t==null?void 0:t.type)==="VERSION"}const el="@firebase/app",gd="0.9.23";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jn=new wg("@firebase/app"),WA="@firebase/app-compat",zA="@firebase/analytics-compat",GA="@firebase/analytics",HA="@firebase/app-check-compat",KA="@firebase/app-check",QA="@firebase/auth",jA="@firebase/auth-compat",YA="@firebase/database",XA="@firebase/database-compat",JA="@firebase/functions",ZA="@firebase/functions-compat",t1="@firebase/installations",e1="@firebase/installations-compat",n1="@firebase/messaging",r1="@firebase/messaging-compat",i1="@firebase/performance",s1="@firebase/performance-compat",o1="@firebase/remote-config",a1="@firebase/remote-config-compat",u1="@firebase/storage",l1="@firebase/storage-compat",c1="@firebase/firestore",h1="@firebase/firestore-compat",f1="firebase",d1="10.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl="[DEFAULT]",g1={[el]:"fire-core",[WA]:"fire-core-compat",[GA]:"fire-analytics",[zA]:"fire-analytics-compat",[KA]:"fire-app-check",[HA]:"fire-app-check-compat",[QA]:"fire-auth",[jA]:"fire-auth-compat",[YA]:"fire-rtdb",[XA]:"fire-rtdb-compat",[JA]:"fire-fn",[ZA]:"fire-fn-compat",[t1]:"fire-iid",[e1]:"fire-iid-compat",[n1]:"fire-fcm",[r1]:"fire-fcm-compat",[i1]:"fire-perf",[s1]:"fire-perf-compat",[o1]:"fire-rc",[a1]:"fire-rc-compat",[u1]:"fire-gcs",[l1]:"fire-gcs-compat",[c1]:"fire-fst",[h1]:"fire-fst-compat","fire-js":"fire-js",[f1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo=new Map,rl=new Map;function p1(n,t){try{n.container.addComponent(t)}catch(e){jn.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Io(n){const t=n.name;if(rl.has(t))return jn.debug(`There were multiple attempts to register component ${t}.`),!1;rl.set(t,n);for(const e of wo.values())p1(e,n);return!0}function m1(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Sn=new Tg("app","Firebase",_1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(t,e,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Di("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Sn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1=d1;function Rg(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i=Object.assign({name:nl,automaticDataCollectionEnabled:!1},t),o=i.name;if(typeof o!="string"||!o)throw Sn.create("bad-app-name",{appName:String(o)});if(e||(e=Eg()),!e)throw Sn.create("no-options");const a=wo.get(o);if(a){if(Ju(e,a.options)&&Ju(i,a.config))return a;throw Sn.create("duplicate-app",{appName:o})}const l=new RA(o);for(const d of rl.values())l.addComponent(d);const h=new y1(e,i,l);return wo.set(o,h),h}function E1(n=nl){const t=wo.get(n);if(!t&&n===nl&&Eg())return Rg();if(!t)throw Sn.create("no-app",{appName:n});return t}function Rr(n,t,e){var i;let o=(i=g1[n])!==null&&i!==void 0?i:n;e&&(o+=`-${e}`);const a=o.match(/\s|\//),l=t.match(/\s|\//);if(a||l){const h=[`Unable to register library "${o}" with version "${t}":`];a&&h.push(`library name "${o}" contains illegal characters (whitespace or "/")`),a&&l&&h.push("and"),l&&h.push(`version name "${t}" contains illegal characters (whitespace or "/")`),jn.warn(h.join(" "));return}Io(new Di(`${o}-version`,()=>({library:o,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1="firebase-heartbeat-database",w1=1,xi="firebase-heartbeat-store";let Fu=null;function Sg(){return Fu||(Fu=FA(T1,w1,{upgrade:(n,t)=>{switch(t){case 0:n.createObjectStore(xi)}}}).catch(n=>{throw Sn.create("idb-open",{originalErrorMessage:n.message})})),Fu}async function I1(n){try{return await(await Sg()).transaction(xi).objectStore(xi).get(Cg(n))}catch(t){if(t instanceof Fr)jn.warn(t.message);else{const e=Sn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});jn.warn(e.message)}}}async function pd(n,t){try{const i=(await Sg()).transaction(xi,"readwrite");await i.objectStore(xi).put(t,Cg(n)),await i.done}catch(e){if(e instanceof Fr)jn.warn(e.message);else{const i=Sn.create("idb-set",{originalErrorMessage:e==null?void 0:e.message});jn.warn(i.message)}}}function Cg(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A1=1024,R1=30*24*60*60*1e3;class S1{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new P1(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=md();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)))return this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=R1}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=md(),{heartbeatsToSend:i,unsentEntries:o}=C1(this._heartbeatsCache.heartbeats),a=To(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}}function md(){return new Date().toISOString().substring(0,10)}function C1(n,t=A1){const e=[];let i=n.slice();for(const o of n){const a=e.find(l=>l.agent===o.agent);if(a){if(a.dates.push(o.date),_d(e)>t){a.dates.pop();break}}else if(e.push({agent:o.agent,dates:[o.date]}),_d(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class P1{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _A()?yA().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await I1(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const o=await this.read();return pd(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:o.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){const o=await this.read();return pd(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...t.heartbeats]})}else return}}function _d(n){return To(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(n){Io(new Di("platform-logger",t=>new qA(t),"PRIVATE")),Io(new Di("heartbeat",t=>new S1(t),"PRIVATE")),Rr(el,gd,n),Rr(el,gd,"esm2017"),Rr("fire-js","")}V1("");var D1="firebase",x1="10.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rr(D1,x1,"app");var b1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},N,Dl=Dl||{},G=b1||self;function Uo(n){var t=typeof n;return t=t!="object"?t:n?Array.isArray(n)?"array":t:"null",t=="array"||t=="object"&&typeof n.length=="number"}function Hi(n){var t=typeof n;return t=="object"&&n!=null||t=="function"}function N1(n){return Object.prototype.hasOwnProperty.call(n,Uu)&&n[Uu]||(n[Uu]=++O1)}var Uu="closure_uid_"+(1e9*Math.random()>>>0),O1=0;function M1(n,t,e){return n.call.apply(n.bind,arguments)}function L1(n,t,e){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(o,i),n.apply(t,o)}}return function(){return n.apply(t,arguments)}}function te(n,t,e){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?te=M1:te=L1,te.apply(null,arguments)}function so(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var i=e.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function Ut(n,t){function e(){}e.prototype=t.prototype,n.$=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.ac=function(i,o,a){for(var l=Array(arguments.length-2),h=2;h<arguments.length;h++)l[h-2]=arguments[h];return t.prototype[o].apply(i,l)}}function bn(){this.s=this.s,this.o=this.o}var k1=0;bn.prototype.s=!1;bn.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),k1!=0)&&N1(this)};bn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Pg=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if(typeof n=="string")return typeof t!="string"||t.length!=1?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function xl(n){const t=n.length;if(0<t){const e=Array(t);for(let i=0;i<t;i++)e[i]=n[i];return e}return[]}function yd(n,t){for(let e=1;e<arguments.length;e++){const i=arguments[e];if(Uo(i)){const o=n.length||0,a=i.length||0;n.length=o+a;for(let l=0;l<a;l++)n[o+l]=i[l]}else n.push(i)}}function ee(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}ee.prototype.h=function(){this.defaultPrevented=!0};var F1=function(){if(!G.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{G.addEventListener("test",()=>{},t),G.removeEventListener("test",()=>{},t)}catch{}return n}();function bi(n){return/^[\s\xa0]*$/.test(n)}function Bo(){var n=G.navigator;return n&&(n=n.userAgent)?n:""}function He(n){return Bo().indexOf(n)!=-1}function bl(n){return bl[" "](n),n}bl[" "]=function(){};function U1(n,t){var e=xR;return Object.prototype.hasOwnProperty.call(e,n)?e[n]:e[n]=t(n)}var B1=He("Opera"),Dr=He("Trident")||He("MSIE"),Vg=He("Edge"),il=Vg||Dr,Dg=He("Gecko")&&!(Bo().toLowerCase().indexOf("webkit")!=-1&&!He("Edge"))&&!(He("Trident")||He("MSIE"))&&!He("Edge"),q1=Bo().toLowerCase().indexOf("webkit")!=-1&&!He("Edge");function xg(){var n=G.document;return n?n.documentMode:void 0}var sl;t:{var Bu="",qu=function(){var n=Bo();if(Dg)return/rv:([^\);]+)(\)|;)/.exec(n);if(Vg)return/Edge\/([\d\.]+)/.exec(n);if(Dr)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(q1)return/WebKit\/(\S+)/.exec(n);if(B1)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(qu&&(Bu=qu?qu[1]:""),Dr){var $u=xg();if($u!=null&&$u>parseFloat(Bu)){sl=String($u);break t}}sl=Bu}var ol;if(G.document&&Dr){var vd=xg();ol=vd||parseInt(sl,10)||void 0}else ol=void 0;var $1=ol;function Ni(n,t){if(ee.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(Dg){t:{try{bl(t.nodeName);var o=!0;break t}catch{}o=!1}o||(t=null)}}else e=="mouseover"?t=n.fromElement:e=="mouseout"&&(t=n.toElement);this.relatedTarget=t,i?(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:W1[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Ni.$.h.call(this)}}Ut(Ni,ee);var W1={2:"touch",3:"pen",4:"mouse"};Ni.prototype.h=function(){Ni.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Ki="closure_listenable_"+(1e6*Math.random()|0),z1=0;function G1(n,t,e,i,o){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!i,this.la=o,this.key=++z1,this.fa=this.ia=!1}function qo(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Nl(n,t,e){for(const i in n)t.call(e,n[i],i,n)}function H1(n,t){for(const e in n)t.call(void 0,n[e],e,n)}function bg(n){const t={};for(const e in n)t[e]=n[e];return t}const Ed="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ng(n,t){let e,i;for(let o=1;o<arguments.length;o++){i=arguments[o];for(e in i)n[e]=i[e];for(let a=0;a<Ed.length;a++)e=Ed[a],Object.prototype.hasOwnProperty.call(i,e)&&(n[e]=i[e])}}function $o(n){this.src=n,this.g={},this.h=0}$o.prototype.add=function(n,t,e,i,o){var a=n.toString();n=this.g[a],n||(n=this.g[a]=[],this.h++);var l=ul(n,t,i,o);return-1<l?(t=n[l],e||(t.ia=!1)):(t=new G1(t,this.src,a,!!i,o),t.ia=e,n.push(t)),t};function al(n,t){var e=t.type;if(e in n.g){var i=n.g[e],o=Pg(i,t),a;(a=0<=o)&&Array.prototype.splice.call(i,o,1),a&&(qo(t),n.g[e].length==0&&(delete n.g[e],n.h--))}}function ul(n,t,e,i){for(var o=0;o<n.length;++o){var a=n[o];if(!a.fa&&a.listener==t&&a.capture==!!e&&a.la==i)return o}return-1}var Ol="closure_lm_"+(1e6*Math.random()|0),Wu={};function Og(n,t,e,i,o){if(i&&i.once)return Lg(n,t,e,i,o);if(Array.isArray(t)){for(var a=0;a<t.length;a++)Og(n,t[a],e,i,o);return null}return e=kl(e),n&&n[Ki]?n.O(t,e,Hi(i)?!!i.capture:!!i,o):Mg(n,t,e,!1,i,o)}function Mg(n,t,e,i,o,a){if(!t)throw Error("Invalid event type");var l=Hi(o)?!!o.capture:!!o,h=Ll(n);if(h||(n[Ol]=h=new $o(n)),e=h.add(t,e,i,l,a),e.proxy)return e;if(i=K1(),e.proxy=i,i.src=n,i.listener=e,n.addEventListener)F1||(o=l),o===void 0&&(o=!1),n.addEventListener(t.toString(),i,o);else if(n.attachEvent)n.attachEvent(Fg(t.toString()),i);else if(n.addListener&&n.removeListener)n.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return e}function K1(){function n(e){return t.call(n.src,n.listener,e)}const t=Q1;return n}function Lg(n,t,e,i,o){if(Array.isArray(t)){for(var a=0;a<t.length;a++)Lg(n,t[a],e,i,o);return null}return e=kl(e),n&&n[Ki]?n.P(t,e,Hi(i)?!!i.capture:!!i,o):Mg(n,t,e,!0,i,o)}function kg(n,t,e,i,o){if(Array.isArray(t))for(var a=0;a<t.length;a++)kg(n,t[a],e,i,o);else i=Hi(i)?!!i.capture:!!i,e=kl(e),n&&n[Ki]?(n=n.i,t=String(t).toString(),t in n.g&&(a=n.g[t],e=ul(a,e,i,o),-1<e&&(qo(a[e]),Array.prototype.splice.call(a,e,1),a.length==0&&(delete n.g[t],n.h--)))):n&&(n=Ll(n))&&(t=n.g[t.toString()],n=-1,t&&(n=ul(t,e,i,o)),(e=-1<n?t[n]:null)&&Ml(e))}function Ml(n){if(typeof n!="number"&&n&&!n.fa){var t=n.src;if(t&&t[Ki])al(t.i,n);else{var e=n.type,i=n.proxy;t.removeEventListener?t.removeEventListener(e,i,n.capture):t.detachEvent?t.detachEvent(Fg(e),i):t.addListener&&t.removeListener&&t.removeListener(i),(e=Ll(t))?(al(e,n),e.h==0&&(e.src=null,t[Ol]=null)):qo(n)}}}function Fg(n){return n in Wu?Wu[n]:Wu[n]="on"+n}function Q1(n,t){if(n.fa)n=!0;else{t=new Ni(t,this);var e=n.listener,i=n.la||n.src;n.ia&&Ml(n),n=e.call(i,t)}return n}function Ll(n){return n=n[Ol],n instanceof $o?n:null}var zu="__closure_events_fn_"+(1e9*Math.random()>>>0);function kl(n){return typeof n=="function"?n:(n[zu]||(n[zu]=function(t){return n.handleEvent(t)}),n[zu])}function Ft(){bn.call(this),this.i=new $o(this),this.S=this,this.J=null}Ut(Ft,bn);Ft.prototype[Ki]=!0;Ft.prototype.removeEventListener=function(n,t,e,i){kg(this,n,t,e,i)};function Gt(n,t){var e,i=n.J;if(i)for(e=[];i;i=i.J)e.push(i);if(n=n.S,i=t.type||t,typeof t=="string")t=new ee(t,n);else if(t instanceof ee)t.target=t.target||n;else{var o=t;t=new ee(i,n),Ng(t,o)}if(o=!0,e)for(var a=e.length-1;0<=a;a--){var l=t.g=e[a];o=oo(l,i,!0,t)&&o}if(l=t.g=n,o=oo(l,i,!0,t)&&o,o=oo(l,i,!1,t)&&o,e)for(a=0;a<e.length;a++)l=t.g=e[a],o=oo(l,i,!1,t)&&o}Ft.prototype.N=function(){if(Ft.$.N.call(this),this.i){var n=this.i,t;for(t in n.g){for(var e=n.g[t],i=0;i<e.length;i++)qo(e[i]);delete n.g[t],n.h--}}this.J=null};Ft.prototype.O=function(n,t,e,i){return this.i.add(String(n),t,!1,e,i)};Ft.prototype.P=function(n,t,e,i){return this.i.add(String(n),t,!0,e,i)};function oo(n,t,e,i){if(t=n.i.g[String(t)],!t)return!0;t=t.concat();for(var o=!0,a=0;a<t.length;++a){var l=t[a];if(l&&!l.fa&&l.capture==e){var h=l.listener,d=l.la||l.src;l.ia&&al(n.i,l),o=h.call(d,i)!==!1&&o}}return o&&!i.defaultPrevented}var Fl=G.JSON.stringify;class j1{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}function Y1(){var n=Ul;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}class X1{constructor(){this.h=this.g=null}add(t,e){const i=Ug.get();i.set(t,e),this.h?this.h.next=i:this.g=i,this.h=i}}var Ug=new j1(()=>new J1,n=>n.reset());class J1{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Z1(n){var t=1;n=n.split(":");const e=[];for(;0<t&&n.length;)e.push(n.shift()),t--;return n.length&&e.push(n.join(":")),e}function tR(n){G.setTimeout(()=>{throw n},0)}let Oi,Mi=!1,Ul=new X1,Bg=()=>{const n=G.Promise.resolve(void 0);Oi=()=>{n.then(eR)}};var eR=()=>{for(var n;n=Y1();){try{n.h.call(n.g)}catch(e){tR(e)}var t=Ug;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}Mi=!1};function Wo(n,t){Ft.call(this),this.h=n||1,this.g=t||G,this.j=te(this.qb,this),this.l=Date.now()}Ut(Wo,Ft);N=Wo.prototype;N.ga=!1;N.T=null;N.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Gt(this,"tick"),this.ga&&(Bl(this),this.start()))}};N.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Bl(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}N.N=function(){Wo.$.N.call(this),Bl(this),delete this.g};function ql(n,t,e){if(typeof n=="function")e&&(n=te(n,e));else if(n&&typeof n.handleEvent=="function")n=te(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:G.setTimeout(n,t||0)}function qg(n){n.g=ql(()=>{n.g=null,n.i&&(n.i=!1,qg(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}class nR extends bn{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:qg(this)}N(){super.N(),this.g&&(G.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Li(n){bn.call(this),this.h=n,this.g={}}Ut(Li,bn);var Td=[];function $g(n,t,e,i){Array.isArray(e)||(e&&(Td[0]=e.toString()),e=Td);for(var o=0;o<e.length;o++){var a=Og(t,e[o],i||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function Wg(n){Nl(n.g,function(t,e){this.g.hasOwnProperty(e)&&Ml(t)},n),n.g={}}Li.prototype.N=function(){Li.$.N.call(this),Wg(this)};Li.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function zo(){this.g=!0}zo.prototype.Ea=function(){this.g=!1};function rR(n,t,e,i,o,a){n.info(function(){if(n.g)if(a)for(var l="",h=a.split("&"),d=0;d<h.length;d++){var m=h[d].split("=");if(1<m.length){var _=m[0];m=m[1];var w=_.split("_");l=2<=w.length&&w[1]=="type"?l+(_+"="+m+"&"):l+(_+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+i+") [attempt "+o+"]: "+t+`
`+e+`
`+l})}function iR(n,t,e,i,o,a,l){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+o+"]: "+t+`
`+e+`
`+a+" "+l})}function Ar(n,t,e,i){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+oR(n,e)+(i?" "+i:"")})}function sR(n,t){n.info(function(){return"TIMEOUT: "+t})}zo.prototype.info=function(){};function oR(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e){for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var i=e[n];if(!(2>i.length)){var o=i[1];if(Array.isArray(o)&&!(1>o.length)){var a=o[0];if(a!="noop"&&a!="stop"&&a!="close")for(var l=1;l<o.length;l++)o[l]=""}}}}return Fl(e)}catch{return t}}var tr={},wd=null;function Go(){return wd=wd||new Ft}tr.Ta="serverreachability";function zg(n){ee.call(this,tr.Ta,n)}Ut(zg,ee);function ki(n){const t=Go();Gt(t,new zg(t))}tr.STAT_EVENT="statevent";function Gg(n,t){ee.call(this,tr.STAT_EVENT,n),this.stat=t}Ut(Gg,ee);function oe(n){const t=Go();Gt(t,new Gg(t,n))}tr.Ua="timingevent";function Hg(n,t){ee.call(this,tr.Ua,n),this.size=t}Ut(Hg,ee);function Qi(n,t){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return G.setTimeout(function(){n()},t)}var Ho={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Kg={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function $l(){}$l.prototype.h=null;function Id(n){return n.h||(n.h=n.i())}function Qg(){}var ji={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Wl(){ee.call(this,"d")}Ut(Wl,ee);function zl(){ee.call(this,"c")}Ut(zl,ee);var ll;function Ko(){}Ut(Ko,$l);Ko.prototype.g=function(){return new XMLHttpRequest};Ko.prototype.i=function(){return{}};ll=new Ko;function Yi(n,t,e,i){this.l=n,this.j=t,this.m=e,this.W=i||1,this.U=new Li(this),this.P=aR,n=il?125:void 0,this.V=new Wo(n),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new jg}function jg(){this.i=null,this.g="",this.h=!1}var aR=45e3,cl={},Ao={};N=Yi.prototype;N.setTimeout=function(n){this.P=n};function hl(n,t,e){n.L=1,n.v=jo(cn(t)),n.s=e,n.S=!0,Yg(n,null)}function Yg(n,t){n.G=Date.now(),Xi(n),n.A=cn(n.v);var e=n.A,i=n.W;Array.isArray(i)||(i=[String(i)]),ip(e.i,"t",i),n.C=0,e=n.l.J,n.h=new jg,n.g=Rp(n.l,e?t:null,!n.s),0<n.O&&(n.M=new nR(te(n.Pa,n,n.g),n.O)),$g(n.U,n.g,"readystatechange",n.nb),t=n.I?bg(n.I):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,t)):(n.u="GET",n.g.ha(n.A,n.u,null,t)),ki(),rR(n.j,n.u,n.A,n.m,n.W,n.s)}N.nb=function(n){n=n.target;const t=this.M;t&&Ke(n)==3?t.l():this.Pa(n)};N.Pa=function(n){try{if(n==this.g)t:{const _=Ke(this.g);var t=this.g.Ia();const w=this.g.da();if(!(3>_)&&(_!=3||il||this.g&&(this.h.h||this.g.ja()||Cd(this.g)))){this.J||_!=4||t==7||(t==8||0>=w?ki(3):ki(2)),Qo(this);var e=this.g.da();this.ca=e;e:if(Xg(this)){var i=Cd(this.g);n="";var o=i.length,a=Ke(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gn(this),Ri(this);var l="";break e}this.h.i=new G.TextDecoder}for(t=0;t<o;t++)this.h.h=!0,n+=this.h.i.decode(i[t],{stream:a&&t==o-1});i.splice(0,o),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.ja();if(this.i=e==200,iR(this.j,this.u,this.A,this.m,this.W,_,e),this.i){if(this.aa&&!this.K){e:{if(this.g){var h,d=this.g;if((h=d.g?d.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!bi(h)){var m=h;break e}}m=null}if(e=m)Ar(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,fl(this,e);else{this.i=!1,this.o=3,oe(12),Gn(this),Ri(this);break t}}this.S?(Jg(this,_,l),il&&this.i&&_==3&&($g(this.U,this.V,"tick",this.mb),this.V.start())):(Ar(this.j,this.m,l,null),fl(this,l)),_==4&&Gn(this),this.i&&!this.J&&(_==4?Tp(this.l,this):(this.i=!1,Xi(this)))}else PR(this.g),e==400&&0<l.indexOf("Unknown SID")?(this.o=3,oe(12)):(this.o=0,oe(13)),Gn(this),Ri(this)}}}catch{}finally{}};function Xg(n){return n.g?n.u=="GET"&&n.L!=2&&n.l.Ha:!1}function Jg(n,t,e){let i=!0,o;for(;!n.J&&n.C<e.length;)if(o=uR(n,e),o==Ao){t==4&&(n.o=4,oe(14),i=!1),Ar(n.j,n.m,null,"[Incomplete Response]");break}else if(o==cl){n.o=4,oe(15),Ar(n.j,n.m,e,"[Invalid Chunk]"),i=!1;break}else Ar(n.j,n.m,o,null),fl(n,o);Xg(n)&&o!=Ao&&o!=cl&&(n.h.g="",n.C=0),t!=4||e.length!=0||n.h.h||(n.o=1,oe(16),i=!1),n.i=n.i&&i,i?0<e.length&&!n.ba&&(n.ba=!0,t=n.l,t.g==n&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+e.length),Yl(t),t.M=!0,oe(11))):(Ar(n.j,n.m,e,"[Invalid Chunked Response]"),Gn(n),Ri(n))}N.mb=function(){if(this.g){var n=Ke(this.g),t=this.g.ja();this.C<t.length&&(Qo(this),Jg(this,n,t),this.i&&n!=4&&Xi(this))}};function uR(n,t){var e=n.C,i=t.indexOf(`
`,e);return i==-1?Ao:(e=Number(t.substring(e,i)),isNaN(e)?cl:(i+=1,i+e>t.length?Ao:(t=t.slice(i,i+e),n.C=i+e,t)))}N.cancel=function(){this.J=!0,Gn(this)};function Xi(n){n.Y=Date.now()+n.P,Zg(n,n.P)}function Zg(n,t){if(n.B!=null)throw Error("WatchDog timer not null");n.B=Qi(te(n.lb,n),t)}function Qo(n){n.B&&(G.clearTimeout(n.B),n.B=null)}N.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(sR(this.j,this.A),this.L!=2&&(ki(),oe(17)),Gn(this),this.o=2,Ri(this)):Zg(this,this.Y-n)};function Ri(n){n.l.H==0||n.J||Tp(n.l,n)}function Gn(n){Qo(n);var t=n.M;t&&typeof t.sa=="function"&&t.sa(),n.M=null,Bl(n.V),Wg(n.U),n.g&&(t=n.g,n.g=null,t.abort(),t.sa())}function fl(n,t){try{var e=n.l;if(e.H!=0&&(e.g==n||dl(e.i,n))){if(!n.K&&dl(e.i,n)&&e.H==3){try{var i=e.Ja.g.parse(t)}catch{i=null}if(Array.isArray(i)&&i.length==3){var o=i;if(o[0]==0){t:if(!e.u){if(e.g)if(e.g.G+3e3<n.G)Co(e),Jo(e);else break t;jl(e),oe(18)}}else e.Fa=o[1],0<e.Fa-e.V&&37500>o[2]&&e.G&&e.A==0&&!e.v&&(e.v=Qi(te(e.ib,e),6e3));if(1>=ap(e.i)&&e.oa){try{e.oa()}catch{}e.oa=void 0}}else Hn(e,11)}else if((n.K||e.g==n)&&Co(e),!bi(t))for(o=e.Ja.g.parse(t),t=0;t<o.length;t++){let m=o[t];if(e.V=m[0],m=m[1],e.H==2)if(m[0]=="c"){e.K=m[1],e.pa=m[2];const _=m[3];_!=null&&(e.ra=_,e.l.info("VER="+e.ra));const w=m[4];w!=null&&(e.Ga=w,e.l.info("SVER="+e.Ga));const P=m[5];P!=null&&typeof P=="number"&&0<P&&(i=1.5*P,e.L=i,e.l.info("backChannelRequestTimeoutMs_="+i)),i=e;const x=n.g;if(x){const z=x.g?x.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(z){var a=i.i;a.g||z.indexOf("spdy")==-1&&z.indexOf("quic")==-1&&z.indexOf("h2")==-1||(a.j=a.l,a.g=new Set,a.h&&(Gl(a,a.h),a.h=null))}if(i.F){const X=x.g?x.g.getResponseHeader("X-HTTP-Session-Id"):null;X&&(i.Da=X,pt(i.I,i.F,X))}}e.H=3,e.h&&e.h.Ba(),e.ca&&(e.S=Date.now()-n.G,e.l.info("Handshake RTT: "+e.S+"ms")),i=e;var l=n;if(i.wa=Ap(i,i.J?i.pa:null,i.Y),l.K){up(i.i,l);var h=l,d=i.L;d&&h.setTimeout(d),h.B&&(Qo(h),Xi(h)),i.g=l}else vp(i);0<e.j.length&&Zo(e)}else m[0]!="stop"&&m[0]!="close"||Hn(e,7);else e.H==3&&(m[0]=="stop"||m[0]=="close"?m[0]=="stop"?Hn(e,7):Ql(e):m[0]!="noop"&&e.h&&e.h.Aa(m),e.A=0)}}ki(4)}catch{}}function lR(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(Uo(n)){for(var t=[],e=n.length,i=0;i<e;i++)t.push(n[i]);return t}t=[],e=0;for(i in n)t[e++]=n[i];return t}function cR(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Uo(n)||typeof n=="string"){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const i in n)t[e++]=i;return t}}}function tp(n,t){if(n.forEach&&typeof n.forEach=="function")n.forEach(t,void 0);else if(Uo(n)||typeof n=="string")Array.prototype.forEach.call(n,t,void 0);else for(var e=cR(n),i=lR(n),o=i.length,a=0;a<o;a++)t.call(void 0,i[a],e&&e[a],n)}var ep=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hR(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var i=n[e].indexOf("="),o=null;if(0<=i){var a=n[e].substring(0,i);o=n[e].substring(i+1)}else a=n[e];t(a,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}function Qn(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Qn){this.h=n.h,Ro(this,n.j),this.s=n.s,this.g=n.g,So(this,n.m),this.l=n.l;var t=n.i,e=new Fi;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),Ad(this,e),this.o=n.o}else n&&(t=String(n).match(ep))?(this.h=!1,Ro(this,t[1]||"",!0),this.s=Ti(t[2]||""),this.g=Ti(t[3]||"",!0),So(this,t[4]),this.l=Ti(t[5]||"",!0),Ad(this,t[6]||"",!0),this.o=Ti(t[7]||"")):(this.h=!1,this.i=new Fi(null,this.h))}Qn.prototype.toString=function(){var n=[],t=this.j;t&&n.push(wi(t,Rd,!0),":");var e=this.g;return(e||t=="file")&&(n.push("//"),(t=this.s)&&n.push(wi(t,Rd,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e=this.m,e!=null&&n.push(":",String(e))),(e=this.l)&&(this.g&&e.charAt(0)!="/"&&n.push("/"),n.push(wi(e,e.charAt(0)=="/"?gR:dR,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",wi(e,mR)),n.join("")};function cn(n){return new Qn(n)}function Ro(n,t,e){n.j=e?Ti(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function So(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function Ad(n,t,e){t instanceof Fi?(n.i=t,_R(n.i,n.h)):(e||(t=wi(t,pR)),n.i=new Fi(t,n.h))}function pt(n,t,e){n.i.set(t,e)}function jo(n){return pt(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Ti(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function wi(n,t,e){return typeof n=="string"?(n=encodeURI(n).replace(t,fR),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function fR(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var Rd=/[#\/\?@]/g,dR=/[#\?:]/g,gR=/[#\?]/g,pR=/[#\?@]/g,mR=/#/g;function Fi(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function Nn(n){n.g||(n.g=new Map,n.h=0,n.i&&hR(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}N=Fi.prototype;N.add=function(n,t){Nn(this),this.i=null,n=Ur(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this};function np(n,t){Nn(n),t=Ur(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function rp(n,t){return Nn(n),t=Ur(n,t),n.g.has(t)}N.forEach=function(n,t){Nn(this),this.g.forEach(function(e,i){e.forEach(function(o){n.call(t,o,i,this)},this)},this)};N.ta=function(){Nn(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let i=0;i<t.length;i++){const o=n[i];for(let a=0;a<o.length;a++)e.push(t[i])}return e};N.Z=function(n){Nn(this);let t=[];if(typeof n=="string")rp(this,n)&&(t=t.concat(this.g.get(Ur(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t};N.set=function(n,t){return Nn(this),this.i=null,n=Ur(this,n),rp(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this};N.get=function(n,t){return n?(n=this.Z(n),0<n.length?String(n[0]):t):t};function ip(n,t,e){np(n,t),0<e.length&&(n.i=null,n.g.set(Ur(n,t),xl(e)),n.h+=e.length)}N.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var i=t[e];const a=encodeURIComponent(String(i)),l=this.Z(i);for(i=0;i<l.length;i++){var o=a;l[i]!==""&&(o+="="+encodeURIComponent(String(l[i]))),n.push(o)}}return this.i=n.join("&")};function Ur(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function _R(n,t){t&&!n.j&&(Nn(n),n.i=null,n.g.forEach(function(e,i){var o=i.toLowerCase();i!=o&&(np(this,i),ip(this,o,e))},n)),n.j=t}var yR=class{constructor(n,t){this.g=n,this.map=t}};function sp(n){this.l=n||vR,G.PerformanceNavigationTiming?(n=G.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(G.g&&G.g.Ka&&G.g.Ka()&&G.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var vR=10;function op(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function ap(n){return n.h?1:n.g?n.g.size:0}function dl(n,t){return n.h?n.h==t:n.g?n.g.has(t):!1}function Gl(n,t){n.g?n.g.add(t):n.h=t}function up(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}sp.prototype.cancel=function(){if(this.i=lp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function lp(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let t=n.i;for(const e of n.g.values())t=t.concat(e.F);return t}return xl(n.i)}var ER=class{stringify(n){return G.JSON.stringify(n,void 0)}parse(n){return G.JSON.parse(n,void 0)}};function TR(){this.g=new ER}function wR(n,t,e){const i=e||"";try{tp(n,function(o,a){let l=o;Hi(o)&&(l=Fl(o)),t.push(i+a+"="+encodeURIComponent(l))})}catch(o){throw t.push(i+"type="+encodeURIComponent("_badmap")),o}}function IR(n,t){const e=new zo;if(G.Image){const i=new Image;i.onload=so(ao,e,i,"TestLoadImage: loaded",!0,t),i.onerror=so(ao,e,i,"TestLoadImage: error",!1,t),i.onabort=so(ao,e,i,"TestLoadImage: abort",!1,t),i.ontimeout=so(ao,e,i,"TestLoadImage: timeout",!1,t),G.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else t(!1)}function ao(n,t,e,i,o){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,o(i)}catch{}}function Ji(n){this.l=n.ec||null,this.j=n.ob||!1}Ut(Ji,$l);Ji.prototype.g=function(){return new Yo(this.l,this.j)};Ji.prototype.i=function(n){return function(){return n}}({});function Yo(n,t){Ft.call(this),this.F=n,this.u=t,this.m=void 0,this.readyState=Hl,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ut(Yo,Ft);var Hl=0;N=Yo.prototype;N.open=function(n,t){if(this.readyState!=Hl)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,Ui(this)};N.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.F||G).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))};N.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zi(this)),this.readyState=Hl};N.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Ui(this)),this.g&&(this.readyState=3,Ui(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof G.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;cp(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function cp(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}N.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?Zi(this):Ui(this),this.readyState==3&&cp(this)}};N.Za=function(n){this.g&&(this.response=this.responseText=n,Zi(this))};N.Ya=function(n){this.g&&(this.response=n,Zi(this))};N.ka=function(){this.g&&Zi(this)};function Zi(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Ui(n)}N.setRequestHeader=function(n,t){this.v.append(n,t)};N.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};N.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)e=e.value,n.push(e[0]+": "+e[1]),e=t.next();return n.join(`\r
`)};function Ui(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(Yo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var AR=G.JSON.parse;function Rt(n){Ft.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=hp,this.L=this.M=!1}Ut(Rt,Ft);var hp="",RR=/^https?$/i,SR=["POST","PUT"];N=Rt.prototype;N.Oa=function(n){this.M=n};N.ha=function(n,t,e,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);t=t?t.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ll.g(),this.C=this.u?Id(this.u):Id(ll),this.g.onreadystatechange=te(this.La,this);try{this.G=!0,this.g.open(t,String(n),!0),this.G=!1}catch(a){Sd(this,a);return}if(n=e||"",e=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var o in i)e.set(o,i[o]);else if(typeof i.keys=="function"&&typeof i.get=="function")for(const a of i.keys())e.set(a,i.get(a));else throw Error("Unknown input type for opt_headers: "+String(i));i=Array.from(e.keys()).find(a=>a.toLowerCase()=="content-type"),o=G.FormData&&n instanceof G.FormData,!(0<=Pg(SR,t))||i||o||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,l]of e)this.g.setRequestHeader(a,l);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{gp(this),0<this.B&&((this.L=CR(this.g))?(this.g.timeout=this.B,this.g.ontimeout=te(this.ua,this)):this.A=ql(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){Sd(this,a)}};function CR(n){return Dr&&typeof n.timeout=="number"&&n.ontimeout!==void 0}N.ua=function(){typeof Dl<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Gt(this,"timeout"),this.abort(8))};function Sd(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,fp(n),Xo(n)}function fp(n){n.F||(n.F=!0,Gt(n,"complete"),Gt(n,"error"))}N.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Gt(this,"complete"),Gt(this,"abort"),Xo(this))};N.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Xo(this,!0)),Rt.$.N.call(this)};N.La=function(){this.s||(this.G||this.v||this.l?dp(this):this.kb())};N.kb=function(){dp(this)};function dp(n){if(n.h&&typeof Dl<"u"&&(!n.C[1]||Ke(n)!=4||n.da()!=2)){if(n.v&&Ke(n)==4)ql(n.La,0,n);else if(Gt(n,"readystatechange"),Ke(n)==4){n.h=!1;try{const l=n.da();t:switch(l){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break t;default:t=!1}var e;if(!(e=t)){var i;if(i=l===0){var o=String(n.I).match(ep)[1]||null;!o&&G.self&&G.self.location&&(o=G.self.location.protocol.slice(0,-1)),i=!RR.test(o?o.toLowerCase():"")}e=i}if(e)Gt(n,"complete"),Gt(n,"success");else{n.m=6;try{var a=2<Ke(n)?n.g.statusText:""}catch{a=""}n.j=a+" ["+n.da()+"]",fp(n)}}finally{Xo(n)}}}}function Xo(n,t){if(n.g){gp(n);const e=n.g,i=n.C[0]?()=>{}:null;n.g=null,n.C=null,t||Gt(n,"ready");try{e.onreadystatechange=i}catch{}}}function gp(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(G.clearTimeout(n.A),n.A=null)}N.isActive=function(){return!!this.g};function Ke(n){return n.g?n.g.readyState:0}N.da=function(){try{return 2<Ke(this)?this.g.status:-1}catch{return-1}};N.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};N.Wa=function(n){if(this.g){var t=this.g.responseText;return n&&t.indexOf(n)==0&&(t=t.substring(n.length)),AR(t)}};function Cd(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case hp:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function PR(n){const t={};n=(n.g&&2<=Ke(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let i=0;i<n.length;i++){if(bi(n[i]))continue;var e=Z1(n[i]);const o=e[0];if(e=e[1],typeof e!="string")continue;e=e.trim();const a=t[o]||[];t[o]=a,a.push(e)}H1(t,function(i){return i.join(", ")})}N.Ia=function(){return this.m};N.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function pp(n){let t="";return Nl(n,function(e,i){t+=i,t+=":",t+=e,t+=`\r
`}),t}function Kl(n,t,e){t:{for(i in e){var i=!1;break t}i=!0}i||(e=pp(e),typeof n=="string"?e!=null&&encodeURIComponent(String(e)):pt(n,t,e))}function _i(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function mp(n){this.Ga=0,this.j=[],this.l=new zo,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=_i("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=_i("baseRetryDelayMs",5e3,n),this.hb=_i("retryDelaySeedMs",1e4,n),this.eb=_i("forwardChannelMaxRetries",2,n),this.xa=_i("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new sp(n&&n.concurrentRequestLimit),this.Ja=new TR,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}N=mp.prototype;N.ra=8;N.H=1;function Ql(n){if(_p(n),n.H==3){var t=n.W++,e=cn(n.I);if(pt(e,"SID",n.K),pt(e,"RID",t),pt(e,"TYPE","terminate"),ts(n,e),t=new Yi(n,n.l,t),t.L=2,t.v=jo(cn(e)),e=!1,G.navigator&&G.navigator.sendBeacon)try{e=G.navigator.sendBeacon(t.v.toString(),"")}catch{}!e&&G.Image&&(new Image().src=t.v,e=!0),e||(t.g=Rp(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Xi(t)}Ip(n)}function Jo(n){n.g&&(Yl(n),n.g.cancel(),n.g=null)}function _p(n){Jo(n),n.u&&(G.clearTimeout(n.u),n.u=null),Co(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&G.clearTimeout(n.m),n.m=null)}function Zo(n){if(!op(n.i)&&!n.m){n.m=!0;var t=n.Na;Oi||Bg(),Mi||(Oi(),Mi=!0),Ul.add(t,n),n.C=0}}function VR(n,t){return ap(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=t.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=Qi(te(n.Na,n,t),wp(n,n.C)),n.C++,!0)}N.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const o=new Yi(this,this.l,n);let a=this.s;if(this.U&&(a?(a=bg(a),Ng(a,this.U)):a=this.U),this.o!==null||this.O||(o.I=a,a=null),this.P)t:{for(var t=0,e=0;e<this.j.length;e++){e:{var i=this.j[e];if("__data__"in i.map&&(i=i.map.__data__,typeof i=="string")){i=i.length;break e}i=void 0}if(i===void 0)break;if(t+=i,4096<t){t=e;break t}if(t===4096||e===this.j.length-1){t=e+1;break t}}t=1e3}else t=1e3;t=yp(this,o,t),e=cn(this.I),pt(e,"RID",n),pt(e,"CVER",22),this.F&&pt(e,"X-HTTP-Session-Id",this.F),ts(this,e),a&&(this.O?t="headers="+encodeURIComponent(String(pp(a)))+"&"+t:this.o&&Kl(e,this.o,a)),Gl(this.i,o),this.bb&&pt(e,"TYPE","init"),this.P?(pt(e,"$req",t),pt(e,"SID","null"),o.aa=!0,hl(o,e,null)):hl(o,e,t),this.H=2}}else this.H==3&&(n?Pd(this,n):this.j.length==0||op(this.i)||Pd(this))};function Pd(n,t){var e;t?e=t.m:e=n.W++;const i=cn(n.I);pt(i,"SID",n.K),pt(i,"RID",e),pt(i,"AID",n.V),ts(n,i),n.o&&n.s&&Kl(i,n.o,n.s),e=new Yi(n,n.l,e,n.C+1),n.o===null&&(e.I=n.s),t&&(n.j=t.F.concat(n.j)),t=yp(n,e,1e3),e.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),Gl(n.i,e),hl(e,i,t)}function ts(n,t){n.na&&Nl(n.na,function(e,i){pt(t,i,e)}),n.h&&tp({},function(e,i){pt(t,i,e)})}function yp(n,t,e){e=Math.min(n.j.length,e);var i=n.h?te(n.h.Va,n.h,n):null;t:{var o=n.j;let a=-1;for(;;){const l=["count="+e];a==-1?0<e?(a=o[0].g,l.push("ofs="+a)):a=0:l.push("ofs="+a);let h=!0;for(let d=0;d<e;d++){let m=o[d].g;const _=o[d].map;if(m-=a,0>m)a=Math.max(0,o[d].g-100),h=!1;else try{wR(_,l,"req"+m+"_")}catch{i&&i(_)}}if(h){i=l.join("&");break t}}}return n=n.j.splice(0,e),t.F=n,i}function vp(n){if(!n.g&&!n.u){n.ba=1;var t=n.Ma;Oi||Bg(),Mi||(Oi(),Mi=!0),Ul.add(t,n),n.A=0}}function jl(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=Qi(te(n.Ma,n),wp(n,n.A)),n.A++,!0)}N.Ma=function(){if(this.u=null,Ep(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=Qi(te(this.jb,this),n)}};N.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,oe(10),Jo(this),Ep(this))};function Yl(n){n.B!=null&&(G.clearTimeout(n.B),n.B=null)}function Ep(n){n.g=new Yi(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var t=cn(n.wa);pt(t,"RID","rpc"),pt(t,"SID",n.K),pt(t,"AID",n.V),pt(t,"CI",n.G?"0":"1"),!n.G&&n.qa&&pt(t,"TO",n.qa),pt(t,"TYPE","xmlhttp"),ts(n,t),n.o&&n.s&&Kl(t,n.o,n.s),n.L&&n.g.setTimeout(n.L);var e=n.g;n=n.pa,e.L=1,e.v=jo(cn(t)),e.s=null,e.S=!0,Yg(e,n)}N.ib=function(){this.v!=null&&(this.v=null,Jo(this),jl(this),oe(19))};function Co(n){n.v!=null&&(G.clearTimeout(n.v),n.v=null)}function Tp(n,t){var e=null;if(n.g==t){Co(n),Yl(n),n.g=null;var i=2}else if(dl(n.i,t))e=t.F,up(n.i,t),i=1;else return;if(n.H!=0){if(t.i)if(i==1){e=t.s?t.s.length:0,t=Date.now()-t.G;var o=n.C;i=Go(),Gt(i,new Hg(i,e)),Zo(n)}else vp(n);else if(o=t.o,o==3||o==0&&0<t.ca||!(i==1&&VR(n,t)||i==2&&jl(n)))switch(e&&0<e.length&&(t=n.i,t.i=t.i.concat(e)),o){case 1:Hn(n,5);break;case 4:Hn(n,10);break;case 3:Hn(n,6);break;default:Hn(n,2)}}}function wp(n,t){let e=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(e*=2),e*t}function Hn(n,t){if(n.l.info("Error code "+t),t==2){var e=null;n.h&&(e=null);var i=te(n.pb,n);e||(e=new Qn("//www.google.com/images/cleardot.gif"),G.location&&G.location.protocol=="http"||Ro(e,"https"),jo(e)),IR(e.toString(),i)}else oe(2);n.H=0,n.h&&n.h.za(t),Ip(n),_p(n)}N.pb=function(n){n?(this.l.info("Successfully pinged google.com"),oe(2)):(this.l.info("Failed to ping google.com"),oe(1))};function Ip(n){if(n.H=0,n.ma=[],n.h){const t=lp(n.i);(t.length!=0||n.j.length!=0)&&(yd(n.ma,t),yd(n.ma,n.j),n.i.i.length=0,xl(n.j),n.j.length=0),n.h.ya()}}function Ap(n,t,e){var i=e instanceof Qn?cn(e):new Qn(e);if(i.g!="")t&&(i.g=t+"."+i.g),So(i,i.m);else{var o=G.location;i=o.protocol,t=t?t+"."+o.hostname:o.hostname,o=+o.port;var a=new Qn(null);i&&Ro(a,i),t&&(a.g=t),o&&So(a,o),e&&(a.l=e),i=a}return e=n.F,t=n.Da,e&&t&&pt(i,e,t),pt(i,"VER",n.ra),ts(n,i),i}function Rp(n,t,e){if(t&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return t=e&&n.Ha&&!n.va?new Rt(new Ji({ob:!0})):new Rt(n.va),t.Oa(n.J),t}N.isActive=function(){return!!this.h&&this.h.isActive(this)};function Sp(){}N=Sp.prototype;N.Ba=function(){};N.Aa=function(){};N.za=function(){};N.ya=function(){};N.isActive=function(){return!0};N.Va=function(){};function Po(){if(Dr&&!(10<=Number($1)))throw Error("Environmental error: no available transport.")}Po.prototype.g=function(n,t){return new ye(n,t)};function ye(n,t){Ft.call(this),this.g=new mp(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(n?n["X-WebChannel-Client-Profile"]=t.Ca:n={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=n,(n=t&&t.cc)&&!bi(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!bi(t)&&(this.g.F=t,n=this.h,n!==null&&t in n&&(n=this.h,t in n&&delete n[t])),this.j=new Br(this)}Ut(ye,Ft);ye.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,t=this.l,e=this.h||void 0;oe(0),n.Y=t,n.na=e||{},n.G=n.aa,n.I=Ap(n,null,n.Y),Zo(n)};ye.prototype.close=function(){Ql(this.g)};ye.prototype.u=function(n){var t=this.g;if(typeof n=="string"){var e={};e.__data__=n,n=e}else this.v&&(e={},e.__data__=Fl(n),n=e);t.j.push(new yR(t.fb++,n)),t.H==3&&Zo(t)};ye.prototype.N=function(){this.g.h=null,delete this.j,Ql(this.g),delete this.g,ye.$.N.call(this)};function Cp(n){Wl.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var t=n.__sm__;if(t){t:{for(const e in t){n=e;break t}n=void 0}(this.i=n)&&(n=this.i,t=t!==null&&n in t?t[n]:void 0),this.data=t}else this.data=n}Ut(Cp,Wl);function Pp(){zl.call(this),this.status=1}Ut(Pp,zl);function Br(n){this.g=n}Ut(Br,Sp);Br.prototype.Ba=function(){Gt(this.g,"a")};Br.prototype.Aa=function(n){Gt(this.g,new Cp(n))};Br.prototype.za=function(n){Gt(this.g,new Pp)};Br.prototype.ya=function(){Gt(this.g,"b")};function DR(){this.blockSize=-1}function Be(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Ut(Be,DR);Be.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Gu(n,t,e){e||(e=0);var i=Array(16);if(typeof t=="string")for(var o=0;16>o;++o)i[o]=t.charCodeAt(e++)|t.charCodeAt(e++)<<8|t.charCodeAt(e++)<<16|t.charCodeAt(e++)<<24;else for(o=0;16>o;++o)i[o]=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;t=n.g[0],e=n.g[1],o=n.g[2];var a=n.g[3],l=t+(a^e&(o^a))+i[0]+3614090360&4294967295;t=e+(l<<7&4294967295|l>>>25),l=a+(o^t&(e^o))+i[1]+3905402710&4294967295,a=t+(l<<12&4294967295|l>>>20),l=o+(e^a&(t^e))+i[2]+606105819&4294967295,o=a+(l<<17&4294967295|l>>>15),l=e+(t^o&(a^t))+i[3]+3250441966&4294967295,e=o+(l<<22&4294967295|l>>>10),l=t+(a^e&(o^a))+i[4]+4118548399&4294967295,t=e+(l<<7&4294967295|l>>>25),l=a+(o^t&(e^o))+i[5]+1200080426&4294967295,a=t+(l<<12&4294967295|l>>>20),l=o+(e^a&(t^e))+i[6]+2821735955&4294967295,o=a+(l<<17&4294967295|l>>>15),l=e+(t^o&(a^t))+i[7]+4249261313&4294967295,e=o+(l<<22&4294967295|l>>>10),l=t+(a^e&(o^a))+i[8]+1770035416&4294967295,t=e+(l<<7&4294967295|l>>>25),l=a+(o^t&(e^o))+i[9]+2336552879&4294967295,a=t+(l<<12&4294967295|l>>>20),l=o+(e^a&(t^e))+i[10]+4294925233&4294967295,o=a+(l<<17&4294967295|l>>>15),l=e+(t^o&(a^t))+i[11]+2304563134&4294967295,e=o+(l<<22&4294967295|l>>>10),l=t+(a^e&(o^a))+i[12]+1804603682&4294967295,t=e+(l<<7&4294967295|l>>>25),l=a+(o^t&(e^o))+i[13]+4254626195&4294967295,a=t+(l<<12&4294967295|l>>>20),l=o+(e^a&(t^e))+i[14]+2792965006&4294967295,o=a+(l<<17&4294967295|l>>>15),l=e+(t^o&(a^t))+i[15]+1236535329&4294967295,e=o+(l<<22&4294967295|l>>>10),l=t+(o^a&(e^o))+i[1]+4129170786&4294967295,t=e+(l<<5&4294967295|l>>>27),l=a+(e^o&(t^e))+i[6]+3225465664&4294967295,a=t+(l<<9&4294967295|l>>>23),l=o+(t^e&(a^t))+i[11]+643717713&4294967295,o=a+(l<<14&4294967295|l>>>18),l=e+(a^t&(o^a))+i[0]+3921069994&4294967295,e=o+(l<<20&4294967295|l>>>12),l=t+(o^a&(e^o))+i[5]+3593408605&4294967295,t=e+(l<<5&4294967295|l>>>27),l=a+(e^o&(t^e))+i[10]+38016083&4294967295,a=t+(l<<9&4294967295|l>>>23),l=o+(t^e&(a^t))+i[15]+3634488961&4294967295,o=a+(l<<14&4294967295|l>>>18),l=e+(a^t&(o^a))+i[4]+3889429448&4294967295,e=o+(l<<20&4294967295|l>>>12),l=t+(o^a&(e^o))+i[9]+568446438&4294967295,t=e+(l<<5&4294967295|l>>>27),l=a+(e^o&(t^e))+i[14]+3275163606&4294967295,a=t+(l<<9&4294967295|l>>>23),l=o+(t^e&(a^t))+i[3]+4107603335&4294967295,o=a+(l<<14&4294967295|l>>>18),l=e+(a^t&(o^a))+i[8]+1163531501&4294967295,e=o+(l<<20&4294967295|l>>>12),l=t+(o^a&(e^o))+i[13]+2850285829&4294967295,t=e+(l<<5&4294967295|l>>>27),l=a+(e^o&(t^e))+i[2]+4243563512&4294967295,a=t+(l<<9&4294967295|l>>>23),l=o+(t^e&(a^t))+i[7]+1735328473&4294967295,o=a+(l<<14&4294967295|l>>>18),l=e+(a^t&(o^a))+i[12]+2368359562&4294967295,e=o+(l<<20&4294967295|l>>>12),l=t+(e^o^a)+i[5]+4294588738&4294967295,t=e+(l<<4&4294967295|l>>>28),l=a+(t^e^o)+i[8]+2272392833&4294967295,a=t+(l<<11&4294967295|l>>>21),l=o+(a^t^e)+i[11]+1839030562&4294967295,o=a+(l<<16&4294967295|l>>>16),l=e+(o^a^t)+i[14]+4259657740&4294967295,e=o+(l<<23&4294967295|l>>>9),l=t+(e^o^a)+i[1]+2763975236&4294967295,t=e+(l<<4&4294967295|l>>>28),l=a+(t^e^o)+i[4]+1272893353&4294967295,a=t+(l<<11&4294967295|l>>>21),l=o+(a^t^e)+i[7]+4139469664&4294967295,o=a+(l<<16&4294967295|l>>>16),l=e+(o^a^t)+i[10]+3200236656&4294967295,e=o+(l<<23&4294967295|l>>>9),l=t+(e^o^a)+i[13]+681279174&4294967295,t=e+(l<<4&4294967295|l>>>28),l=a+(t^e^o)+i[0]+3936430074&4294967295,a=t+(l<<11&4294967295|l>>>21),l=o+(a^t^e)+i[3]+3572445317&4294967295,o=a+(l<<16&4294967295|l>>>16),l=e+(o^a^t)+i[6]+76029189&4294967295,e=o+(l<<23&4294967295|l>>>9),l=t+(e^o^a)+i[9]+3654602809&4294967295,t=e+(l<<4&4294967295|l>>>28),l=a+(t^e^o)+i[12]+3873151461&4294967295,a=t+(l<<11&4294967295|l>>>21),l=o+(a^t^e)+i[15]+530742520&4294967295,o=a+(l<<16&4294967295|l>>>16),l=e+(o^a^t)+i[2]+3299628645&4294967295,e=o+(l<<23&4294967295|l>>>9),l=t+(o^(e|~a))+i[0]+4096336452&4294967295,t=e+(l<<6&4294967295|l>>>26),l=a+(e^(t|~o))+i[7]+1126891415&4294967295,a=t+(l<<10&4294967295|l>>>22),l=o+(t^(a|~e))+i[14]+2878612391&4294967295,o=a+(l<<15&4294967295|l>>>17),l=e+(a^(o|~t))+i[5]+4237533241&4294967295,e=o+(l<<21&4294967295|l>>>11),l=t+(o^(e|~a))+i[12]+1700485571&4294967295,t=e+(l<<6&4294967295|l>>>26),l=a+(e^(t|~o))+i[3]+2399980690&4294967295,a=t+(l<<10&4294967295|l>>>22),l=o+(t^(a|~e))+i[10]+4293915773&4294967295,o=a+(l<<15&4294967295|l>>>17),l=e+(a^(o|~t))+i[1]+2240044497&4294967295,e=o+(l<<21&4294967295|l>>>11),l=t+(o^(e|~a))+i[8]+1873313359&4294967295,t=e+(l<<6&4294967295|l>>>26),l=a+(e^(t|~o))+i[15]+4264355552&4294967295,a=t+(l<<10&4294967295|l>>>22),l=o+(t^(a|~e))+i[6]+2734768916&4294967295,o=a+(l<<15&4294967295|l>>>17),l=e+(a^(o|~t))+i[13]+1309151649&4294967295,e=o+(l<<21&4294967295|l>>>11),l=t+(o^(e|~a))+i[4]+4149444226&4294967295,t=e+(l<<6&4294967295|l>>>26),l=a+(e^(t|~o))+i[11]+3174756917&4294967295,a=t+(l<<10&4294967295|l>>>22),l=o+(t^(a|~e))+i[2]+718787259&4294967295,o=a+(l<<15&4294967295|l>>>17),l=e+(a^(o|~t))+i[9]+3951481745&4294967295,n.g[0]=n.g[0]+t&4294967295,n.g[1]=n.g[1]+(o+(l<<21&4294967295|l>>>11))&4294967295,n.g[2]=n.g[2]+o&4294967295,n.g[3]=n.g[3]+a&4294967295}Be.prototype.j=function(n,t){t===void 0&&(t=n.length);for(var e=t-this.blockSize,i=this.m,o=this.h,a=0;a<t;){if(o==0)for(;a<=e;)Gu(this,n,a),a+=this.blockSize;if(typeof n=="string"){for(;a<t;)if(i[o++]=n.charCodeAt(a++),o==this.blockSize){Gu(this,i),o=0;break}}else for(;a<t;)if(i[o++]=n[a++],o==this.blockSize){Gu(this,i),o=0;break}}this.h=o,this.i+=t};Be.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var t=1;t<n.length-8;++t)n[t]=0;var e=8*this.i;for(t=n.length-8;t<n.length;++t)n[t]=e&255,e/=256;for(this.j(n),n=Array(16),t=e=0;4>t;++t)for(var i=0;32>i;i+=8)n[e++]=this.g[t]>>>i&255;return n};function ht(n,t){this.h=t;for(var e=[],i=!0,o=n.length-1;0<=o;o--){var a=n[o]|0;i&&a==t||(e[o]=a,i=!1)}this.g=e}var xR={};function Xl(n){return-128<=n&&128>n?U1(n,function(t){return new ht([t|0],0>t?-1:0)}):new ht([n|0],0>n?-1:0)}function Qe(n){if(isNaN(n)||!isFinite(n))return Sr;if(0>n)return Wt(Qe(-n));for(var t=[],e=1,i=0;n>=e;i++)t[i]=n/e|0,e*=gl;return new ht(t,0)}function Vp(n,t){if(n.length==0)throw Error("number format error: empty string");if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(n.charAt(0)=="-")return Wt(Vp(n.substring(1),t));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var e=Qe(Math.pow(t,8)),i=Sr,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),l=parseInt(n.substring(o,o+a),t);8>a?(a=Qe(Math.pow(t,a)),i=i.R(a).add(Qe(l))):(i=i.R(e),i=i.add(Qe(l)))}return i}var gl=4294967296,Sr=Xl(0),pl=Xl(1),Vd=Xl(16777216);N=ht.prototype;N.ea=function(){if(Ve(this))return-Wt(this).ea();for(var n=0,t=1,e=0;e<this.g.length;e++){var i=this.D(e);n+=(0<=i?i:gl+i)*t,t*=gl}return n};N.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(ln(this))return"0";if(Ve(this))return"-"+Wt(this).toString(n);for(var t=Qe(Math.pow(n,6)),e=this,i="";;){var o=Do(e,t).g;e=Vo(e,o.R(t));var a=((0<e.g.length?e.g[0]:e.h)>>>0).toString(n);if(e=o,ln(e))return a+i;for(;6>a.length;)a="0"+a;i=a+i}};N.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function ln(n){if(n.h!=0)return!1;for(var t=0;t<n.g.length;t++)if(n.g[t]!=0)return!1;return!0}function Ve(n){return n.h==-1}N.X=function(n){return n=Vo(this,n),Ve(n)?-1:ln(n)?0:1};function Wt(n){for(var t=n.g.length,e=[],i=0;i<t;i++)e[i]=~n.g[i];return new ht(e,~n.h).add(pl)}N.abs=function(){return Ve(this)?Wt(this):this};N.add=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0,o=0;o<=t;o++){var a=i+(this.D(o)&65535)+(n.D(o)&65535),l=(a>>>16)+(this.D(o)>>>16)+(n.D(o)>>>16);i=l>>>16,a&=65535,l&=65535,e[o]=l<<16|a}return new ht(e,e[e.length-1]&-2147483648?-1:0)};function Vo(n,t){return n.add(Wt(t))}N.R=function(n){if(ln(this)||ln(n))return Sr;if(Ve(this))return Ve(n)?Wt(this).R(Wt(n)):Wt(Wt(this).R(n));if(Ve(n))return Wt(this.R(Wt(n)));if(0>this.X(Vd)&&0>n.X(Vd))return Qe(this.ea()*n.ea());for(var t=this.g.length+n.g.length,e=[],i=0;i<2*t;i++)e[i]=0;for(i=0;i<this.g.length;i++)for(var o=0;o<n.g.length;o++){var a=this.D(i)>>>16,l=this.D(i)&65535,h=n.D(o)>>>16,d=n.D(o)&65535;e[2*i+2*o]+=l*d,uo(e,2*i+2*o),e[2*i+2*o+1]+=a*d,uo(e,2*i+2*o+1),e[2*i+2*o+1]+=l*h,uo(e,2*i+2*o+1),e[2*i+2*o+2]+=a*h,uo(e,2*i+2*o+2)}for(i=0;i<t;i++)e[i]=e[2*i+1]<<16|e[2*i];for(i=t;i<2*t;i++)e[i]=0;return new ht(e,0)};function uo(n,t){for(;(n[t]&65535)!=n[t];)n[t+1]+=n[t]>>>16,n[t]&=65535,t++}function yi(n,t){this.g=n,this.h=t}function Do(n,t){if(ln(t))throw Error("division by zero");if(ln(n))return new yi(Sr,Sr);if(Ve(n))return t=Do(Wt(n),t),new yi(Wt(t.g),Wt(t.h));if(Ve(t))return t=Do(n,Wt(t)),new yi(Wt(t.g),t.h);if(30<n.g.length){if(Ve(n)||Ve(t))throw Error("slowDivide_ only works with positive integers.");for(var e=pl,i=t;0>=i.X(n);)e=Dd(e),i=Dd(i);var o=Er(e,1),a=Er(i,1);for(i=Er(i,2),e=Er(e,2);!ln(i);){var l=a.add(i);0>=l.X(n)&&(o=o.add(e),a=l),i=Er(i,1),e=Er(e,1)}return t=Vo(n,o.R(t)),new yi(o,t)}for(o=Sr;0<=n.X(t);){for(e=Math.max(1,Math.floor(n.ea()/t.ea())),i=Math.ceil(Math.log(e)/Math.LN2),i=48>=i?1:Math.pow(2,i-48),a=Qe(e),l=a.R(t);Ve(l)||0<l.X(n);)e-=i,a=Qe(e),l=a.R(t);ln(a)&&(a=pl),o=o.add(a),n=Vo(n,l)}return new yi(o,n)}N.gb=function(n){return Do(this,n).h};N.and=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0;i<t;i++)e[i]=this.D(i)&n.D(i);return new ht(e,this.h&n.h)};N.or=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0;i<t;i++)e[i]=this.D(i)|n.D(i);return new ht(e,this.h|n.h)};N.xor=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0;i<t;i++)e[i]=this.D(i)^n.D(i);return new ht(e,this.h^n.h)};function Dd(n){for(var t=n.g.length+1,e=[],i=0;i<t;i++)e[i]=n.D(i)<<1|n.D(i-1)>>>31;return new ht(e,n.h)}function Er(n,t){var e=t>>5;t%=32;for(var i=n.g.length-e,o=[],a=0;a<i;a++)o[a]=0<t?n.D(a+e)>>>t|n.D(a+e+1)<<32-t:n.D(a+e);return new ht(o,n.h)}Po.prototype.createWebChannel=Po.prototype.g;ye.prototype.send=ye.prototype.u;ye.prototype.open=ye.prototype.m;ye.prototype.close=ye.prototype.close;Ho.NO_ERROR=0;Ho.TIMEOUT=8;Ho.HTTP_ERROR=6;Kg.COMPLETE="complete";Qg.EventType=ji;ji.OPEN="a";ji.CLOSE="b";ji.ERROR="c";ji.MESSAGE="d";Ft.prototype.listen=Ft.prototype.O;Rt.prototype.listenOnce=Rt.prototype.P;Rt.prototype.getLastError=Rt.prototype.Sa;Rt.prototype.getLastErrorCode=Rt.prototype.Ia;Rt.prototype.getStatus=Rt.prototype.da;Rt.prototype.getResponseJson=Rt.prototype.Wa;Rt.prototype.getResponseText=Rt.prototype.ja;Rt.prototype.send=Rt.prototype.ha;Rt.prototype.setWithCredentials=Rt.prototype.Oa;Be.prototype.digest=Be.prototype.l;Be.prototype.reset=Be.prototype.reset;Be.prototype.update=Be.prototype.j;ht.prototype.add=ht.prototype.add;ht.prototype.multiply=ht.prototype.R;ht.prototype.modulo=ht.prototype.gb;ht.prototype.compare=ht.prototype.X;ht.prototype.toNumber=ht.prototype.ea;ht.prototype.toString=ht.prototype.toString;ht.prototype.getBits=ht.prototype.D;ht.fromNumber=Qe;ht.fromString=Vp;var bR=function(){return new Po},NR=function(){return Go()},Hu=Ho,OR=Kg,MR=tr,xd={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},LR=Ji,lo=Qg,kR=Rt,FR=Be,Cr=ht;const bd="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Jt.UNAUTHENTICATED=new Jt(null),Jt.GOOGLE_CREDENTIALS=new Jt("google-credentials-uid"),Jt.FIRST_PARTY=new Jt("first-party-uid"),Jt.MOCK_USER=new Jt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qr="10.5.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn=new wg("@firebase/firestore");function vi(){return Yn.logLevel}function M(n,...t){if(Yn.logLevel<=st.DEBUG){const e=t.map(Jl);Yn.debug(`Firestore (${qr}): ${n}`,...e)}}function hn(n,...t){if(Yn.logLevel<=st.ERROR){const e=t.map(Jl);Yn.error(`Firestore (${qr}): ${n}`,...e)}}function xr(n,...t){if(Yn.logLevel<=st.WARN){const e=t.map(Jl);Yn.warn(`Firestore (${qr}): ${n}`,...e)}}function Jl(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(n="Unexpected state"){const t=`FIRESTORE (${qr}) INTERNAL ASSERTION FAILED: `+n;throw hn(t),new Error(t)}function _t(n,t){n||W()}function j(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends Fr{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class UR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Jt.UNAUTHENTICATED))}shutdown(){}}class BR{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class qR{constructor(t){this.t=t,this.currentUser=Jt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let i=this.i;const o=d=>this.i!==i?(i=this.i,e(d)):Promise.resolve();let a=new Cn;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Cn,t.enqueueRetryable(()=>o(this.currentUser))};const l=()=>{const d=a;t.enqueueRetryable(async()=>{await d.promise,await o(this.currentUser)})},h=d=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.auth.addAuthTokenListener(this.o),l()};this.t.onInit(d=>h(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?h(d):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Cn)}},0),l()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(i=>this.i!==t?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(_t(typeof i.accessToken=="string"),new Dp(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return _t(t===null||typeof t=="string"),new Jt(t)}}class $R{constructor(t,e,i){this.l=t,this.h=e,this.P=i,this.type="FirstParty",this.user=Jt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class WR{constructor(t,e,i){this.l=t,this.h=e,this.P=i}getToken(){return Promise.resolve(new $R(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable(()=>e(Jt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class zR{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class GR{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const i=a=>{a.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.R;return this.R=a.token,M("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?e(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable(()=>i(a))};const o=a=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>o(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?o(a):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(_t(typeof e.token=="string"),this.R=e.token,new zR(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let i="";for(;i.length<20;){const o=HR(40);for(let a=0;a<o.length;++a)i.length<20&&o[a]<e&&(i+=t.charAt(o[a]%t.length))}return i}}function at(n,t){return n<t?-1:n>t?1:0}function br(n,t,e){return n.length===t.length&&n.every((i,o)=>e(i,t[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new L(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new L(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new L(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new L(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Nt.fromMillis(Date.now())}static fromDate(t){return Nt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*e));return new Nt(e,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?at(this.nanoseconds,t.nanoseconds):at(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(t){this.timestamp=t}static fromTimestamp(t){return new K(t)}static min(){return new K(new Nt(0,0))}static max(){return new K(new Nt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(t,e,i){e===void 0?e=0:e>t.length&&W(),i===void 0?i=t.length-e:i>t.length-e&&W(),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return Bi.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Bi?t.forEach(i=>{e.push(i)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let o=0;o<i;o++){const a=t.get(o),l=e.get(o);if(a<l)return-1;if(a>l)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class mt extends Bi{construct(t,e,i){return new mt(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new L(C.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(o=>o.length>0))}return new mt(e)}static emptyPath(){return new mt([])}}const KR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends Bi{construct(t,e,i){return new zt(t,e,i)}static isValidIdentifier(t){return KR.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new zt(["__name__"])}static fromServerFormat(t){const e=[];let i="",o=0;const a=()=>{if(i.length===0)throw new L(C.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let l=!1;for(;o<t.length;){const h=t[o];if(h==="\\"){if(o+1===t.length)throw new L(C.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const d=t[o+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new L(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=d,o+=2}else h==="`"?(l=!l,o++):h!=="."||l?(i+=h,o++):(a(),o++)}if(a(),l)throw new L(C.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zt(e)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(t){this.path=t}static fromPath(t){return new U(mt.fromString(t))}static fromName(t){return new U(mt.fromString(t).popFirst(5))}static empty(){return new U(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&mt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return mt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new U(new mt(t.slice()))}}function QR(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=K.fromTimestamp(i===1e9?new Nt(e+1,0):new Nt(e,i));return new Vn(o,U.empty(),t)}function jR(n){return new Vn(n.readTime,n.key,-1)}class Vn{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new Vn(K.min(),U.empty(),-1)}static max(){return new Vn(K.max(),U.empty(),-1)}}function YR(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=U.comparator(n.documentKey,t.documentKey),e!==0?e:at(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class JR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function es(n){if(n.code!==C.FAILED_PRECONDITION||n.message!==XR)throw n;M("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new D((i,o)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(i,o)},this.catchCallback=a=>{this.wrapFailure(e,a).next(i,o)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof D?e:D.resolve(e)}catch(e){return D.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):D.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):D.reject(e)}static resolve(t){return new D((e,i)=>{e(t)})}static reject(t){return new D((e,i)=>{i(t)})}static waitFor(t){return new D((e,i)=>{let o=0,a=0,l=!1;t.forEach(h=>{++o,h.next(()=>{++a,l&&a===o&&e()},d=>i(d))}),l=!0,a===o&&e()})}static or(t){let e=D.resolve(!1);for(const i of t)e=e.next(o=>o?D.resolve(o):i());return e}static forEach(t,e){const i=[];return t.forEach((o,a)=>{i.push(e.call(this,o,a))}),this.waitFor(i)}static mapArray(t,e){return new D((i,o)=>{const a=t.length,l=new Array(a);let h=0;for(let d=0;d<a;d++){const m=d;e(t[m]).next(_=>{l[m]=_,++h,h===a&&i(l)},_=>o(_))}})}static doWhile(t,e){return new D((i,o)=>{const a=()=>{t()===!0?e().next(()=>{a()},o):i()};a()})}}function ns(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=i=>this.se(i),this.oe=i=>e.writeSequenceNumber(i))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}Zl._e=-1;function ta(n){return n==null}function xo(n){return n===0&&1/n==-1/0}function ZR(n){return typeof n=="number"&&Number.isInteger(n)&&!xo(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function $r(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function bp(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(t,e){this.comparator=t,this.root=e||$t.EMPTY}insert(t,e){return new It(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,$t.BLACK,null,null))}remove(t){return new It(this.comparator,this.root.remove(t,this.comparator).copy(null,null,$t.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(t,i.key);if(o===0)return e+i.left.size;o<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,i)=>(t(e,i),!1))}toString(){const t=[];return this.inorderTraversal((e,i)=>(t.push(`${e}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new co(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new co(this.root,t,this.comparator,!1)}getReverseIterator(){return new co(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new co(this.root,t,this.comparator,!0)}}class co{constructor(t,e,i,o){this.isReverse=o,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=e?i(t.key,e):1,e&&o&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class $t{constructor(t,e,i,o,a){this.key=t,this.value=e,this.color=i??$t.RED,this.left=o??$t.EMPTY,this.right=a??$t.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,o,a){return new $t(t??this.key,e??this.value,i??this.color,o??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let o=this;const a=i(t,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(t,e,i),null):a===0?o.copy(null,e,null,null,null):o.copy(null,null,null,null,o.right.insert(t,e,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return $t.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,o=this;if(e(t,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(t,e),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),e(t,o.key)===0){if(o.right.isEmpty())return $t.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(t,e))}return o.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,$t.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,$t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();const t=this.left.check();if(t!==this.right.check())throw W();return t+(this.isRed()?0:1)}}$t.EMPTY=null,$t.RED=!0,$t.BLACK=!1;$t.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(t,e,i,o,a){return this}insert(t,e,i){return new $t(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(t){this.comparator=t,this.data=new It(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,i)=>(t(e),!1))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,t[1])>=0)return;e(o.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Od(this.data.getIterator())}getIteratorFrom(t){return new Od(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(i=>{e=e.add(i)}),e}isEqual(t){if(!(t instanceof Ht)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const o=e.getNext().key,a=i.getNext().key;if(this.comparator(o,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Ht(this.comparator);return e.data=t,e}}class Od{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(t){this.fields=t,t.sort(zt.comparator)}static empty(){return new Fe([])}unionWith(t){let e=new Ht(zt.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new Fe(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return br(this.fields,t.fields,(e,i)=>e.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(o){try{return atob(o)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Np("Invalid base64 string: "+a):a}}(t);return new ne(e)}static fromUint8Array(t){const e=function(o){let a="";for(let l=0;l<o.length;++l)a+=String.fromCharCode(o[l]);return a}(t);return new ne(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const i=new Uint8Array(e.length);for(let o=0;o<e.length;o++)i[o]=e.charCodeAt(o);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return at(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ne.EMPTY_BYTE_STRING=new ne("");const tS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Dn(n){if(_t(!!n),typeof n=="string"){let t=0;const e=tS.exec(n);if(_t(!!e),e[1]){let o=e[1];o=(o+"000000000").substr(0,9),t=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Vt(n.seconds),nanos:Vt(n.nanos)}}function Vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Xn(n){return typeof n=="string"?ne.fromBase64String(n):ne.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tc(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="server_timestamp"}function ec(n){const t=n.mapValue.fields.__previous_value__;return tc(t)?ec(t):t}function qi(n){const t=Dn(n.mapValue.fields.__local_write_time__.timestampValue);return new Nt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(t,e,i,o,a,l,h,d,m){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=o,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=m}}class $i{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new $i("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof $i&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Jn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?tc(n)?4:nS(n)?9007199254740991:10:W()}function Xe(n,t){if(n===t)return!0;const e=Jn(n);if(e!==Jn(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return qi(n).isEqual(qi(t));case 3:return function(o,a){if(typeof o.timestampValue=="string"&&typeof a.timestampValue=="string"&&o.timestampValue.length===a.timestampValue.length)return o.timestampValue===a.timestampValue;const l=Dn(o.timestampValue),h=Dn(a.timestampValue);return l.seconds===h.seconds&&l.nanos===h.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(o,a){return Xn(o.bytesValue).isEqual(Xn(a.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(o,a){return Vt(o.geoPointValue.latitude)===Vt(a.geoPointValue.latitude)&&Vt(o.geoPointValue.longitude)===Vt(a.geoPointValue.longitude)}(n,t);case 2:return function(o,a){if("integerValue"in o&&"integerValue"in a)return Vt(o.integerValue)===Vt(a.integerValue);if("doubleValue"in o&&"doubleValue"in a){const l=Vt(o.doubleValue),h=Vt(a.doubleValue);return l===h?xo(l)===xo(h):isNaN(l)&&isNaN(h)}return!1}(n,t);case 9:return br(n.arrayValue.values||[],t.arrayValue.values||[],Xe);case 10:return function(o,a){const l=o.mapValue.fields||{},h=a.mapValue.fields||{};if(Nd(l)!==Nd(h))return!1;for(const d in l)if(l.hasOwnProperty(d)&&(h[d]===void 0||!Xe(l[d],h[d])))return!1;return!0}(n,t);default:return W()}}function Wi(n,t){return(n.values||[]).find(e=>Xe(e,t))!==void 0}function Nr(n,t){if(n===t)return 0;const e=Jn(n),i=Jn(t);if(e!==i)return at(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return at(n.booleanValue,t.booleanValue);case 2:return function(a,l){const h=Vt(a.integerValue||a.doubleValue),d=Vt(l.integerValue||l.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1}(n,t);case 3:return Md(n.timestampValue,t.timestampValue);case 4:return Md(qi(n),qi(t));case 5:return at(n.stringValue,t.stringValue);case 6:return function(a,l){const h=Xn(a),d=Xn(l);return h.compareTo(d)}(n.bytesValue,t.bytesValue);case 7:return function(a,l){const h=a.split("/"),d=l.split("/");for(let m=0;m<h.length&&m<d.length;m++){const _=at(h[m],d[m]);if(_!==0)return _}return at(h.length,d.length)}(n.referenceValue,t.referenceValue);case 8:return function(a,l){const h=at(Vt(a.latitude),Vt(l.latitude));return h!==0?h:at(Vt(a.longitude),Vt(l.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(a,l){const h=a.values||[],d=l.values||[];for(let m=0;m<h.length&&m<d.length;++m){const _=Nr(h[m],d[m]);if(_)return _}return at(h.length,d.length)}(n.arrayValue,t.arrayValue);case 10:return function(a,l){if(a===ho.mapValue&&l===ho.mapValue)return 0;if(a===ho.mapValue)return 1;if(l===ho.mapValue)return-1;const h=a.fields||{},d=Object.keys(h),m=l.fields||{},_=Object.keys(m);d.sort(),_.sort();for(let w=0;w<d.length&&w<_.length;++w){const P=at(d[w],_[w]);if(P!==0)return P;const x=Nr(h[d[w]],m[_[w]]);if(x!==0)return x}return at(d.length,_.length)}(n.mapValue,t.mapValue);default:throw W()}}function Md(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return at(n,t);const e=Dn(n),i=Dn(t),o=at(e.seconds,i.seconds);return o!==0?o:at(e.nanos,i.nanos)}function Or(n){return ml(n)}function ml(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){const i=Dn(e);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(e){return Xn(e).toBase64()}(n.bytesValue):"referenceValue"in n?function(e){return U.fromName(e).toString()}(n.referenceValue):"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let i="[",o=!0;for(const a of e.values||[])o?o=!1:i+=",",i+=ml(a);return i+"]"}(n.arrayValue):"mapValue"in n?function(e){const i=Object.keys(e.fields||{}).sort();let o="{",a=!0;for(const l of i)a?a=!1:o+=",",o+=`${l}:${ml(e.fields[l])}`;return o+"}"}(n.mapValue):W()}function Ld(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function _l(n){return!!n&&"integerValue"in n}function nc(n){return!!n&&"arrayValue"in n}function kd(n){return!!n&&"nullValue"in n}function Fd(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function mo(n){return!!n&&"mapValue"in n}function Si(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return $r(n.mapValue.fields,(e,i)=>t.mapValue.fields[e]=Si(i)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Si(n.arrayValue.values[e]);return t}return Object.assign({},n)}function nS(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(t){this.value=t}static empty(){return new De({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!mo(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Si(e)}setAll(t){let e=zt.emptyPath(),i={},o=[];t.forEach((l,h)=>{if(!e.isImmediateParentOf(h)){const d=this.getFieldsMap(e);this.applyChanges(d,i,o),i={},o=[],e=h.popLast()}l?i[h.lastSegment()]=Si(l):o.push(h.lastSegment())});const a=this.getFieldsMap(e);this.applyChanges(a,i,o)}delete(t){const e=this.field(t.popLast());mo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Xe(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let o=e.mapValue.fields[t.get(i)];mo(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=o),e=o}return e.mapValue.fields}applyChanges(t,e,i){$r(e,(o,a)=>t[o]=a);for(const o of i)delete t[o]}clone(){return new De(Si(this.value))}}function Op(n){const t=[];return $r(n.fields,(e,i)=>{const o=new zt([e]);if(mo(i)){const a=Op(i.mapValue).fields;if(a.length===0)t.push(o);else for(const l of a)t.push(o.child(l))}else t.push(o)}),new Fe(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(t,e,i,o,a,l,h){this.key=t,this.documentType=e,this.version=i,this.readTime=o,this.createTime=a,this.data=l,this.documentState=h}static newInvalidDocument(t){return new Zt(t,0,K.min(),K.min(),K.min(),De.empty(),0)}static newFoundDocument(t,e,i,o){return new Zt(t,1,e,K.min(),i,o,0)}static newNoDocument(t,e){return new Zt(t,2,e,K.min(),K.min(),De.empty(),0)}static newUnknownDocument(t,e){return new Zt(t,3,e,K.min(),K.min(),De.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=De.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=De.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Zt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Zt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(t,e){this.position=t,this.inclusive=e}}function Ud(n,t,e){let i=0;for(let o=0;o<n.position.length;o++){const a=t[o],l=n.position[o];if(a.field.isKeyField()?i=U.comparator(U.fromName(l.referenceValue),e.key):i=Nr(l,e.data.field(a.field)),a.dir==="desc"&&(i*=-1),i!==0)break}return i}function Bd(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Xe(n.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(t,e="asc"){this.field=t,this.dir=e}}function rS(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{}class Dt extends Mp{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new sS(t,e,i):e==="array-contains"?new uS(t,i):e==="in"?new lS(t,i):e==="not-in"?new cS(t,i):e==="array-contains-any"?new hS(t,i):new Dt(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new oS(t,i):new aS(t,i)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&this.matchesComparison(Nr(e,this.value)):e!==null&&Jn(this.value)===Jn(e)&&this.matchesComparison(Nr(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return W()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qe extends Mp{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new qe(t,e)}matches(t){return Lp(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Lp(n){return n.op==="and"}function kp(n){return iS(n)&&Lp(n)}function iS(n){for(const t of n.filters)if(t instanceof qe)return!1;return!0}function yl(n){if(n instanceof Dt)return n.field.canonicalString()+n.op.toString()+Or(n.value);if(kp(n))return n.filters.map(t=>yl(t)).join(",");{const t=n.filters.map(e=>yl(e)).join(",");return`${n.op}(${t})`}}function Fp(n,t){return n instanceof Dt?function(i,o){return o instanceof Dt&&i.op===o.op&&i.field.isEqual(o.field)&&Xe(i.value,o.value)}(n,t):n instanceof qe?function(i,o){return o instanceof qe&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce((a,l,h)=>a&&Fp(l,o.filters[h]),!0):!1}(n,t):void W()}function Up(n){return n instanceof Dt?function(e){return`${e.field.canonicalString()} ${e.op} ${Or(e.value)}`}(n):n instanceof qe?function(e){return e.op.toString()+" {"+e.getFilters().map(Up).join(" ,")+"}"}(n):"Filter"}class sS extends Dt{constructor(t,e,i){super(t,e,i),this.key=U.fromName(i.referenceValue)}matches(t){const e=U.comparator(t.key,this.key);return this.matchesComparison(e)}}class oS extends Dt{constructor(t,e){super(t,"in",e),this.keys=Bp("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class aS extends Dt{constructor(t,e){super(t,"not-in",e),this.keys=Bp("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Bp(n,t){var e;return(((e=t.arrayValue)===null||e===void 0?void 0:e.values)||[]).map(i=>U.fromName(i.referenceValue))}class uS extends Dt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return nc(e)&&Wi(e.arrayValue,this.value)}}class lS extends Dt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Wi(this.value.arrayValue,e)}}class cS extends Dt{constructor(t,e){super(t,"not-in",e)}matches(t){if(Wi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&!Wi(this.value.arrayValue,e)}}class hS extends Dt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!nc(e)||!e.arrayValue.values)&&e.arrayValue.values.some(i=>Wi(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(t,e=null,i=[],o=[],a=null,l=null,h=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=o,this.limit=a,this.startAt=l,this.endAt=h,this.ce=null}}function qd(n,t=null,e=[],i=[],o=null,a=null,l=null){return new fS(n,t,e,i,o,a,l)}function rc(n){const t=j(n);if(t.ce===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(i=>yl(i)).join(","),e+="|ob:",e+=t.orderBy.map(i=>function(a){return a.field.canonicalString()+a.dir}(i)).join(","),ta(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(i=>Or(i)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(i=>Or(i)).join(",")),t.ce=e}return t.ce}function ic(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!rS(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!Fp(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!Bd(n.startAt,t.startAt)&&Bd(n.endAt,t.endAt)}function vl(n){return U.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(t,e=null,i=[],o=[],a=null,l="F",h=null,d=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=o,this.limit=a,this.limitType=l,this.startAt=h,this.endAt=d,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function dS(n,t,e,i,o,a,l,h){return new rs(n,t,e,i,o,a,l,h)}function qp(n){return new rs(n)}function $d(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function $p(n){return n.collectionGroup!==null}function Ci(n){const t=j(n);if(t.le===null){t.le=[];const e=new Set;for(const a of t.explicitOrderBy)t.le.push(a),e.add(a.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let h=new Ht(zt.comparator);return l.filters.forEach(d=>{d.getFlattenedFilters().forEach(m=>{m.isInequality()&&(h=h.add(m.field))})}),h})(t).forEach(a=>{e.has(a.canonicalString())||a.isKeyField()||t.le.push(new No(a,i))}),e.has(zt.keyField().canonicalString())||t.le.push(new No(zt.keyField(),i))}return t.le}function je(n){const t=j(n);return t.he||(t.he=gS(t,Ci(n))),t.he}function gS(n,t){if(n.limitType==="F")return qd(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(o=>{const a=o.dir==="desc"?"asc":"desc";return new No(o.field,a)});const e=n.endAt?new bo(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new bo(n.startAt.position,n.startAt.inclusive):null;return qd(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function El(n,t){const e=n.filters.concat([t]);return new rs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function Tl(n,t,e){return new rs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function ea(n,t){return ic(je(n),je(t))&&n.limitType===t.limitType}function Wp(n){return`${rc(je(n))}|lt:${n.limitType}`}function Tr(n){return`Query(target=${function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map(o=>Up(o)).join(", ")}]`),ta(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map(o=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(o)).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(o=>Or(o)).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(o=>Or(o)).join(",")),`Target(${i})`}(je(n))}; limitType=${n.limitType})`}function na(n,t){return t.isFoundDocument()&&function(i,o){const a=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(a):U.isDocumentKey(i.path)?i.path.isEqual(a):i.path.isImmediateParentOf(a)}(n,t)&&function(i,o){for(const a of Ci(i))if(!a.field.isKeyField()&&o.data.field(a.field)===null)return!1;return!0}(n,t)&&function(i,o){for(const a of i.filters)if(!a.matches(o))return!1;return!0}(n,t)&&function(i,o){return!(i.startAt&&!function(l,h,d){const m=Ud(l,h,d);return l.inclusive?m<=0:m<0}(i.startAt,Ci(i),o)||i.endAt&&!function(l,h,d){const m=Ud(l,h,d);return l.inclusive?m>=0:m>0}(i.endAt,Ci(i),o))}(n,t)}function pS(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function zp(n){return(t,e)=>{let i=!1;for(const o of Ci(n)){const a=mS(o,t,e);if(a!==0)return a;i=i||o.field.isKeyField()}return 0}}function mS(n,t,e){const i=n.field.isKeyField()?U.comparator(t.key,e.key):function(a,l,h){const d=l.data.field(a),m=h.data.field(a);return d!==null&&m!==null?Nr(d,m):W()}(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return W()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i!==void 0){for(const[o,a]of i)if(this.equalsFn(o,t))return a}}has(t){return this.get(t)!==void 0}set(t,e){const i=this.mapKeyFn(t),o=this.inner[i];if(o===void 0)return this.inner[i]=[[t,e]],void this.innerSize++;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],t))return void(o[a]=[t,e]);o.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],t))return i.length===1?delete this.inner[e]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(t){$r(this.inner,(e,i)=>{for(const[o,a]of i)t(o,a)})}isEmpty(){return bp(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S=new It(U.comparator);function fn(){return _S}const Gp=new It(U.comparator);function Ii(...n){let t=Gp;for(const e of n)t=t.insert(e.key,e);return t}function Hp(n){let t=Gp;return n.forEach((e,i)=>t=t.insert(e,i.overlayedDocument)),t}function Kn(){return Pi()}function Kp(){return Pi()}function Pi(){return new Wr(n=>n.toString(),(n,t)=>n.isEqual(t))}const yS=new It(U.comparator),vS=new Ht(U.comparator);function nt(...n){let t=vS;for(const e of n)t=t.add(e);return t}const ES=new Ht(at);function TS(){return ES}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qp(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xo(t)?"-0":t}}function jp(n){return{integerValue:""+n}}function wS(n,t){return ZR(t)?jp(t):Qp(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(){this._=void 0}}function IS(n,t,e){return n instanceof Oo?function(o,a){const l={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return a&&tc(a)&&(a=ec(a)),a&&(l.fields.__previous_value__=a),{mapValue:l}}(e,t):n instanceof zi?Xp(n,t):n instanceof Gi?Jp(n,t):function(o,a){const l=Yp(o,a),h=Wd(l)+Wd(o.Ie);return _l(l)&&_l(o.Ie)?jp(h):Qp(o.serializer,h)}(n,t)}function AS(n,t,e){return n instanceof zi?Xp(n,t):n instanceof Gi?Jp(n,t):e}function Yp(n,t){return n instanceof Mo?function(i){return _l(i)||function(a){return!!a&&"doubleValue"in a}(i)}(t)?t:{integerValue:0}:null}class Oo extends ra{}class zi extends ra{constructor(t){super(),this.elements=t}}function Xp(n,t){const e=Zp(t);for(const i of n.elements)e.some(o=>Xe(o,i))||e.push(i);return{arrayValue:{values:e}}}class Gi extends ra{constructor(t){super(),this.elements=t}}function Jp(n,t){let e=Zp(t);for(const i of n.elements)e=e.filter(o=>!Xe(o,i));return{arrayValue:{values:e}}}class Mo extends ra{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Wd(n){return Vt(n.integerValue||n.doubleValue)}function Zp(n){return nc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function RS(n,t){return n.field.isEqual(t.field)&&function(i,o){return i instanceof zi&&o instanceof zi||i instanceof Gi&&o instanceof Gi?br(i.elements,o.elements,Xe):i instanceof Mo&&o instanceof Mo?Xe(i.Ie,o.Ie):i instanceof Oo&&o instanceof Oo}(n.transform,t.transform)}class SS{constructor(t,e){this.version=t,this.transformResults=e}}class Ue{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ue}static exists(t){return new Ue(void 0,t)}static updateTime(t){return new Ue(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function _o(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class ia{}function tm(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new sc(n.key,Ue.none()):new is(n.key,n.data,Ue.none());{const e=n.data,i=De.empty();let o=new Ht(zt.comparator);for(let a of t.fields)if(!o.has(a)){let l=e.field(a);l===null&&a.length>1&&(a=a.popLast(),l=e.field(a)),l===null?i.delete(a):i.set(a,l),o=o.add(a)}return new er(n.key,i,new Fe(o.toArray()),Ue.none())}}function CS(n,t,e){n instanceof is?function(o,a,l){const h=o.value.clone(),d=Gd(o.fieldTransforms,a,l.transformResults);h.setAll(d),a.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(n,t,e):n instanceof er?function(o,a,l){if(!_o(o.precondition,a))return void a.convertToUnknownDocument(l.version);const h=Gd(o.fieldTransforms,a,l.transformResults),d=a.data;d.setAll(em(o)),d.setAll(h),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()}(n,t,e):function(o,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()}(0,t,e)}function Vi(n,t,e,i){return n instanceof is?function(a,l,h,d){if(!_o(a.precondition,l))return h;const m=a.value.clone(),_=Hd(a.fieldTransforms,d,l);return m.setAll(_),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null}(n,t,e,i):n instanceof er?function(a,l,h,d){if(!_o(a.precondition,l))return h;const m=Hd(a.fieldTransforms,d,l),_=l.data;return _.setAll(em(a)),_.setAll(m),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),h===null?null:h.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(w=>w.field))}(n,t,e,i):function(a,l,h){return _o(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):h}(n,t,e)}function PS(n,t){let e=null;for(const i of n.fieldTransforms){const o=t.data.field(i.field),a=Yp(i.transform,o||null);a!=null&&(e===null&&(e=De.empty()),e.set(i.field,a))}return e||null}function zd(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&br(i,o,(a,l)=>RS(a,l))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class is extends ia{constructor(t,e,i,o=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class er extends ia{constructor(t,e,i,o,a=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=o,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function em(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}}),t}function Gd(n,t,e){const i=new Map;_t(n.length===e.length);for(let o=0;o<e.length;o++){const a=n[o],l=a.transform,h=t.data.field(a.field);i.set(a.field,AS(l,h,e[o]))}return i}function Hd(n,t,e){const i=new Map;for(const o of n){const a=o.transform,l=e.data.field(o.field);i.set(o.field,IS(a,l,t))}return i}class sc extends ia{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class VS extends ia{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(t,e,i,o){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let o=0;o<this.mutations.length;o++){const a=this.mutations[o];a.key.isEqual(t.key)&&CS(a,t,i[o])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=Vi(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=Vi(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=Kp();return this.mutations.forEach(o=>{const a=t.get(o.key),l=a.overlayedDocument;let h=this.applyToLocalView(l,a.mutatedFields);h=e.has(o.key)?null:h;const d=tm(l,h);d!==null&&i.set(o.key,d),l.isValidDocument()||l.convertToNoDocument(K.min())}),i}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),nt())}isEqual(t){return this.batchId===t.batchId&&br(this.mutations,t.mutations,(e,i)=>zd(e,i))&&br(this.baseMutations,t.baseMutations,(e,i)=>zd(e,i))}}class oc{constructor(t,e,i,o){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=o}static from(t,e,i){_t(t.mutations.length===i.length);let o=function(){return yS}();const a=t.mutations;for(let l=0;l<a.length;l++)o=o.insert(a[l].key,i[l].version);return new oc(t,e,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pt,it;function NS(n){switch(n){default:return W();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function nm(n){if(n===void 0)return hn("GRPC error has no .code"),C.UNKNOWN;switch(n){case Pt.OK:return C.OK;case Pt.CANCELLED:return C.CANCELLED;case Pt.UNKNOWN:return C.UNKNOWN;case Pt.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case Pt.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case Pt.INTERNAL:return C.INTERNAL;case Pt.UNAVAILABLE:return C.UNAVAILABLE;case Pt.UNAUTHENTICATED:return C.UNAUTHENTICATED;case Pt.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case Pt.NOT_FOUND:return C.NOT_FOUND;case Pt.ALREADY_EXISTS:return C.ALREADY_EXISTS;case Pt.PERMISSION_DENIED:return C.PERMISSION_DENIED;case Pt.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case Pt.ABORTED:return C.ABORTED;case Pt.OUT_OF_RANGE:return C.OUT_OF_RANGE;case Pt.UNIMPLEMENTED:return C.UNIMPLEMENTED;case Pt.DATA_LOSS:return C.DATA_LOSS;default:return W()}}(it=Pt||(Pt={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS=new Cr([4294967295,4294967295],0);function Kd(n){const t=OS().encode(n),e=new FR;return e.update(t),new Uint8Array(e.digest())}function Qd(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),i=t.getUint32(4,!0),o=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Cr([e,i],0),new Cr([o,a],0)]}class ac{constructor(t,e,i){if(this.bitmap=t,this.padding=e,this.hashCount=i,e<0||e>=8)throw new Ai(`Invalid padding: ${e}`);if(i<0)throw new Ai(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new Ai(`Invalid hash count: ${i}`);if(t.length===0&&e!==0)throw new Ai(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=Cr.fromNumber(this.Te)}de(t,e,i){let o=t.add(e.multiply(Cr.fromNumber(i)));return o.compare(MS)===1&&(o=new Cr([o.getBits(0),o.getBits(1)],0)),o.modulo(this.Ee).toNumber()}Ae(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Te===0)return!1;const e=Kd(t),[i,o]=Qd(e);for(let a=0;a<this.hashCount;a++){const l=this.de(i,o,a);if(!this.Ae(l))return!1}return!0}static create(t,e,i){const o=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),l=new ac(a,o,e);return i.forEach(h=>l.insert(h)),l}insert(t){if(this.Te===0)return;const e=Kd(t),[i,o]=Qd(e);for(let a=0;a<this.hashCount;a++){const l=this.de(i,o,a);this.Re(l)}}Re(t){const e=Math.floor(t/8),i=t%8;this.bitmap[e]|=1<<i}}class Ai extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(t,e,i,o,a){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,e,i){const o=new Map;return o.set(t,ss.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new sa(K.min(),o,new It(at),fn(),nt())}}class ss{constructor(t,e,i,o,a){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new ss(i,e,nt(),nt(),nt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(t,e,i,o){this.Ve=t,this.removedTargetIds=e,this.key=i,this.me=o}}class rm{constructor(t,e){this.targetId=t,this.fe=e}}class im{constructor(t,e,i=ne.EMPTY_BYTE_STRING,o=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=o}}class jd{constructor(){this.ge=0,this.pe=Xd(),this.ye=ne.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=nt(),e=nt(),i=nt();return this.pe.forEach((o,a)=>{switch(a){case 0:t=t.add(o);break;case 2:e=e.add(o);break;case 1:i=i.add(o);break;default:W()}}),new ss(this.ye,this.we,t,e,i)}Fe(){this.Se=!1,this.pe=Xd()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}}class LS{constructor(t){this.Le=t,this.ke=new Map,this.qe=fn(),this.Qe=Yd(),this.Ke=new It(at)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,e=>{const i=this.ze(e);switch(t.state){case 0:this.je(e)&&i.Ce(t.resumeToken);break;case 1:i.Ne(),i.be||i.Fe(),i.Ce(t.resumeToken);break;case 2:i.Ne(),i.be||this.removeTarget(e);break;case 3:this.je(e)&&(i.Be(),i.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),i.Ce(t.resumeToken));break;default:W()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach((i,o)=>{this.je(o)&&e(o)})}Je(t){const e=t.targetId,i=t.fe.count,o=this.Ye(e);if(o){const a=o.target;if(vl(a))if(i===0){const l=new U(a.path);this.We(e,l,Zt.newNoDocument(l,K.min()))}else _t(i===1);else{const l=this.Ze(e);if(l!==i){const h=this.Xe(t),d=h?this.et(h,t,l):1;if(d!==0){this.He(e);const m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,m)}}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:a=0}=e;let l,h;try{l=Xn(i).toUint8Array()}catch(d){if(d instanceof Np)return xr("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{h=new ac(l,o,a)}catch(d){return xr(d instanceof Ai?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return h.Te===0?null:h}et(t,e,i){return e.fe.count===i-this.rt(t,e.targetId)?0:2}rt(t,e){const i=this.Le.getRemoteKeysForTarget(e);let o=0;return i.forEach(a=>{const l=this.Le.nt(),h=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;t.mightContain(h)||(this.We(e,a,null),o++)}),o}it(t){const e=new Map;this.ke.forEach((a,l)=>{const h=this.Ye(l);if(h){if(a.current&&vl(h.target)){const d=new U(h.target.path);this.qe.get(d)!==null||this.st(l,d)||this.We(l,d,Zt.newNoDocument(d,t))}a.De&&(e.set(l,a.ve()),a.Fe())}});let i=nt();this.Qe.forEach((a,l)=>{let h=!0;l.forEachWhile(d=>{const m=this.Ye(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(i=i.add(a))}),this.qe.forEach((a,l)=>l.setReadTime(t));const o=new sa(t,e,this.Ke,this.qe,i);return this.qe=fn(),this.Qe=Yd(),this.Ke=new It(at),o}Ue(t,e){if(!this.je(t))return;const i=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,i),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,i){if(!this.je(t))return;const o=this.ze(t);this.st(t,e)?o.Me(e,1):o.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),i&&(this.qe=this.qe.insert(e,i))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new jd,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new Ht(at),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=this.Ye(t)!==null;return e||M("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}He(t){this.ke.set(t,new jd),this.Le.getRemoteKeysForTarget(t).forEach(e=>{this.We(t,e,null)})}st(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function Yd(){return new It(U.comparator)}function Xd(){return new It(U.comparator)}const kS=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),FS=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),US=(()=>({and:"AND",or:"OR"}))();class BS{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function wl(n,t){return n.useProto3Json||ta(t)?t:{value:t}}function Lo(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function sm(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function qS(n,t){return Lo(n,t.toTimestamp())}function Ye(n){return _t(!!n),K.fromTimestamp(function(e){const i=Dn(e);return new Nt(i.seconds,i.nanos)}(n))}function uc(n,t){return function(i){return new mt(["projects",i.projectId,"databases",i.database])}(n).child("documents").child(t).canonicalString()}function om(n){const t=mt.fromString(n);return _t(cm(t)),t}function Il(n,t){return uc(n.databaseId,t.path)}function Ku(n,t){const e=om(t);if(e.get(1)!==n.databaseId.projectId)throw new L(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new L(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new U(am(e))}function Al(n,t){return uc(n.databaseId,t)}function $S(n){const t=om(n);return t.length===4?mt.emptyPath():am(t)}function Rl(n){return new mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function am(n){return _t(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Jd(n,t,e){return{name:Il(n,t),fields:e.value.mapValue.fields}}function WS(n,t){let e;if("targetChange"in t){t.targetChange;const i=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:W()}(t.targetChange.targetChangeType||"NO_CHANGE"),o=t.targetChange.targetIds||[],a=function(m,_){return m.useProto3Json?(_t(_===void 0||typeof _=="string"),ne.fromBase64String(_||"")):(_t(_===void 0||_ instanceof Uint8Array),ne.fromUint8Array(_||new Uint8Array))}(n,t.targetChange.resumeToken),l=t.targetChange.cause,h=l&&function(m){const _=m.code===void 0?C.UNKNOWN:nm(m.code);return new L(_,m.message||"")}(l);e=new im(i,o,a,h||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const o=Ku(n,i.document.name),a=Ye(i.document.updateTime),l=i.document.createTime?Ye(i.document.createTime):K.min(),h=new De({mapValue:{fields:i.document.fields}}),d=Zt.newFoundDocument(o,a,l,h),m=i.targetIds||[],_=i.removedTargetIds||[];e=new yo(m,_,d.key,d)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const o=Ku(n,i.document),a=i.readTime?Ye(i.readTime):K.min(),l=Zt.newNoDocument(o,a),h=i.removedTargetIds||[];e=new yo([],h,l.key,l)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const o=Ku(n,i.document),a=i.removedTargetIds||[];e=new yo([],a,o,null)}else{if(!("filter"in t))return W();{t.filter;const i=t.filter;i.targetId;const{count:o=0,unchangedNames:a}=i,l=new bS(o,a),h=i.targetId;e=new rm(h,l)}}return e}function zS(n,t){let e;if(t instanceof is)e={update:Jd(n,t.key,t.value)};else if(t instanceof sc)e={delete:Il(n,t.key)};else if(t instanceof er)e={update:Jd(n,t.key,t.data),updateMask:ZS(t.fieldMask)};else{if(!(t instanceof VS))return W();e={verify:Il(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(i=>function(a,l){const h=l.transform;if(h instanceof Oo)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof zi)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Gi)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Mo)return{fieldPath:l.field.canonicalString(),increment:h.Ie};throw W()}(0,i))),t.precondition.isNone||(e.currentDocument=function(o,a){return a.updateTime!==void 0?{updateTime:qS(o,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:W()}(n,t.precondition)),e}function GS(n,t){return n&&n.length>0?(_t(t!==void 0),n.map(e=>function(o,a){let l=o.updateTime?Ye(o.updateTime):Ye(a);return l.isEqual(K.min())&&(l=Ye(a)),new SS(l,o.transformResults||[])}(e,t))):[]}function HS(n,t){return{documents:[Al(n,t.path)]}}function KS(n,t){const e={structuredQuery:{}},i=t.path;t.collectionGroup!==null?(e.parent=Al(n,i),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=Al(n,i.popLast()),e.structuredQuery.from=[{collectionId:i.lastSegment()}]);const o=function(d){if(d.length!==0)return lm(qe.create(d,"and"))}(t.filters);o&&(e.structuredQuery.where=o);const a=function(d){if(d.length!==0)return d.map(m=>function(w){return{field:wr(w.field),direction:YS(w.dir)}}(m))}(t.orderBy);a&&(e.structuredQuery.orderBy=a);const l=wl(n,t.limit);return l!==null&&(e.structuredQuery.limit=l),t.startAt&&(e.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(t.startAt)),t.endAt&&(e.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(t.endAt)),e}function QS(n){let t=$S(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let o=null;if(i>0){_t(i===1);const _=e.from[0];_.allDescendants?o=_.collectionId:t=t.child(_.collectionId)}let a=[];e.where&&(a=function(w){const P=um(w);return P instanceof qe&&kp(P)?P.getFilters():[P]}(e.where));let l=[];e.orderBy&&(l=function(w){return w.map(P=>function(z){return new No(Ir(z.field),function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(z.direction))}(P))}(e.orderBy));let h=null;e.limit&&(h=function(w){let P;return P=typeof w=="object"?w.value:w,ta(P)?null:P}(e.limit));let d=null;e.startAt&&(d=function(w){const P=!!w.before,x=w.values||[];return new bo(x,P)}(e.startAt));let m=null;return e.endAt&&(m=function(w){const P=!w.before,x=w.values||[];return new bo(x,P)}(e.endAt)),dS(t,o,l,a,h,"F",d,m)}function jS(n,t){const e=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W()}}(t.purpose);return e==null?null:{"goog-listen-tags":e}}function um(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=Ir(e.unaryFilter.field);return Dt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=Ir(e.unaryFilter.field);return Dt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Ir(e.unaryFilter.field);return Dt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Ir(e.unaryFilter.field);return Dt.create(l,"!=",{nullValue:"NULL_VALUE"});default:return W()}}(n):n.fieldFilter!==void 0?function(e){return Dt.create(Ir(e.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return qe.create(e.compositeFilter.filters.map(i=>um(i)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return W()}}(e.compositeFilter.op))}(n):W()}function YS(n){return kS[n]}function XS(n){return FS[n]}function JS(n){return US[n]}function wr(n){return{fieldPath:n.canonicalString()}}function Ir(n){return zt.fromServerFormat(n.fieldPath)}function lm(n){return n instanceof Dt?function(e){if(e.op==="=="){if(Fd(e.value))return{unaryFilter:{field:wr(e.field),op:"IS_NAN"}};if(kd(e.value))return{unaryFilter:{field:wr(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Fd(e.value))return{unaryFilter:{field:wr(e.field),op:"IS_NOT_NAN"}};if(kd(e.value))return{unaryFilter:{field:wr(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wr(e.field),op:XS(e.op),value:e.value}}}(n):n instanceof qe?function(e){const i=e.getFilters().map(o=>lm(o));return i.length===1?i[0]:{compositeFilter:{op:JS(e.op),filters:i}}}(n):W()}function ZS(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function cm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(t,e,i,o,a=K.min(),l=K.min(),h=ne.EMPTY_BYTE_STRING,d=null){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(t){return new An(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new An(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new An(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new An(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(t){this.ut=t}}function eC(n){const t=QS({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Tl(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(){this.on=new rC}addToCollectionParentIndex(t,e){return this.on.add(e),D.resolve()}getCollectionParents(t,e){return D.resolve(this.on.getEntries(e))}addFieldIndex(t,e){return D.resolve()}deleteFieldIndex(t,e){return D.resolve()}deleteAllFieldIndexes(t){return D.resolve()}createTargetIndexes(t,e){return D.resolve()}getDocumentsMatchingTarget(t,e){return D.resolve(null)}getIndexType(t,e){return D.resolve(0)}getFieldIndexes(t,e){return D.resolve([])}getNextCollectionGroupToUpdate(t){return D.resolve(null)}getMinOffset(t,e){return D.resolve(Vn.min())}getMinOffsetFromCollectionGroup(t,e){return D.resolve(Vn.min())}updateCollectionGroup(t,e,i){return D.resolve()}updateIndexEntries(t,e){return D.resolve()}}class rC{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),o=this.index[e]||new Ht(mt.comparator),a=!o.has(i);return this.index[e]=o.add(i),a}has(t){const e=t.lastSegment(),i=t.popLast(),o=this.index[e];return o&&o.has(i)}getEntries(t){return(this.index[t]||new Ht(mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(t){this.xn=t}next(){return this.xn+=2,this.xn}static On(){return new Mr(0)}static Nn(){return new Mr(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(){this.changes=new Wr(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Zt.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return i!==void 0?D.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(t,e,i,o){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=o}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next(o=>(i=o,this.remoteDocumentCache.getEntry(t,e))).next(o=>(i!==null&&Vi(i.mutation,o,Fe.empty(),Nt.now()),o))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.getLocalViewOfDocuments(t,i,nt()).next(()=>i))}getLocalViewOfDocuments(t,e,i=nt()){const o=Kn();return this.populateOverlays(t,o,e).next(()=>this.computeViews(t,e,o,i).next(a=>{let l=Ii();return a.forEach((h,d)=>{l=l.insert(h,d.overlayedDocument)}),l}))}getOverlayedDocuments(t,e){const i=Kn();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,nt()))}populateOverlays(t,e,i){const o=[];return i.forEach(a=>{e.has(a)||o.push(a)}),this.documentOverlayCache.getOverlays(t,o).next(a=>{a.forEach((l,h)=>{e.set(l,h)})})}computeViews(t,e,i,o){let a=fn();const l=Pi(),h=function(){return Pi()}();return e.forEach((d,m)=>{const _=i.get(m.key);o.has(m.key)&&(_===void 0||_.mutation instanceof er)?a=a.insert(m.key,m):_!==void 0?(l.set(m.key,_.mutation.getFieldMask()),Vi(_.mutation,m,_.mutation.getFieldMask(),Nt.now())):l.set(m.key,Fe.empty())}),this.recalculateAndSaveOverlays(t,a).next(d=>(d.forEach((m,_)=>l.set(m,_)),e.forEach((m,_)=>{var w;return h.set(m,new sC(_,(w=l.get(m))!==null&&w!==void 0?w:null))}),h))}recalculateAndSaveOverlays(t,e){const i=Pi();let o=new It((l,h)=>l-h),a=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(l=>{for(const h of l)h.keys().forEach(d=>{const m=e.get(d);if(m===null)return;let _=i.get(d)||Fe.empty();_=h.applyToLocalView(m,_),i.set(d,_);const w=(o.get(h.batchId)||nt()).add(d);o=o.insert(h.batchId,w)})}).next(()=>{const l=[],h=o.getReverseIterator();for(;h.hasNext();){const d=h.getNext(),m=d.key,_=d.value,w=Kp();_.forEach(P=>{if(!a.has(P)){const x=tm(e.get(P),i.get(P));x!==null&&w.set(P,x),a=a.add(P)}}),l.push(this.documentOverlayCache.saveOverlays(t,m,w))}return D.waitFor(l)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,e,i,o){return function(l){return U.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):$p(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,o):this.getDocumentsMatchingCollectionQuery(t,e,i,o)}getNextDocuments(t,e,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,o).next(a=>{const l=o-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,o-a.size):D.resolve(Kn());let h=-1,d=a;return l.next(m=>D.forEach(m,(_,w)=>(h<w.largestBatchId&&(h=w.largestBatchId),a.get(_)?D.resolve():this.remoteDocumentCache.getEntry(t,_).next(P=>{d=d.insert(_,P)}))).next(()=>this.populateOverlays(t,m,a)).next(()=>this.computeViews(t,d,m,nt())).next(_=>({batchId:h,changes:Hp(_)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new U(e)).next(i=>{let o=Ii();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o})}getDocumentsMatchingCollectionGroupQuery(t,e,i,o){const a=e.collectionGroup;let l=Ii();return this.indexManager.getCollectionParents(t,a).next(h=>D.forEach(h,d=>{const m=function(w,P){return new rs(P,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)}(e,d.child(a));return this.getDocumentsMatchingCollectionQuery(t,m,i,o).next(_=>{_.forEach((w,P)=>{l=l.insert(w,P)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(t,e,i,o){let a;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next(l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,a,o))).next(l=>{a.forEach((d,m)=>{const _=m.getKey();l.get(_)===null&&(l=l.insert(_,Zt.newInvalidDocument(_)))});let h=Ii();return l.forEach((d,m)=>{const _=a.get(d);_!==void 0&&Vi(_.mutation,m,Fe.empty(),Nt.now()),na(e,m)&&(h=h.insert(d,m))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(t){this.serializer=t,this.ur=new Map,this.cr=new Map}getBundleMetadata(t,e){return D.resolve(this.ur.get(e))}saveBundleMetadata(t,e){return this.ur.set(e.id,function(o){return{id:o.id,version:o.version,createTime:Ye(o.createTime)}}(e)),D.resolve()}getNamedQuery(t,e){return D.resolve(this.cr.get(e))}saveNamedQuery(t,e){return this.cr.set(e.name,function(o){return{name:o.name,query:eC(o.bundledQuery),readTime:Ye(o.readTime)}}(e)),D.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(){this.overlays=new It(U.comparator),this.lr=new Map}getOverlay(t,e){return D.resolve(this.overlays.get(e))}getOverlays(t,e){const i=Kn();return D.forEach(e,o=>this.getOverlay(t,o).next(a=>{a!==null&&i.set(o,a)})).next(()=>i)}saveOverlays(t,e,i){return i.forEach((o,a)=>{this.lt(t,e,a)}),D.resolve()}removeOverlaysForBatchId(t,e,i){const o=this.lr.get(i);return o!==void 0&&(o.forEach(a=>this.overlays=this.overlays.remove(a)),this.lr.delete(i)),D.resolve()}getOverlaysForCollection(t,e,i){const o=Kn(),a=e.length+1,l=new U(e.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const d=h.getNext().value,m=d.getKey();if(!e.isPrefixOf(m.path))break;m.path.length===a&&d.largestBatchId>i&&o.set(d.getKey(),d)}return D.resolve(o)}getOverlaysForCollectionGroup(t,e,i,o){let a=new It((m,_)=>m-_);const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===e&&m.largestBatchId>i){let _=a.get(m.largestBatchId);_===null&&(_=Kn(),a=a.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const h=Kn(),d=a.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((m,_)=>h.set(m,_)),!(h.size()>=o)););return D.resolve(h)}lt(t,e,i){const o=this.overlays.get(i.key);if(o!==null){const l=this.lr.get(o.largestBatchId).delete(i.key);this.lr.set(o.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new xS(e,i));let a=this.lr.get(e);a===void 0&&(a=nt(),this.lr.set(e,a)),this.lr.set(e,a.add(i.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(){this.hr=new Ht(Lt.Pr),this.Ir=new Ht(Lt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(t,e){const i=new Lt(t,e);this.hr=this.hr.add(i),this.Ir=this.Ir.add(i)}Er(t,e){t.forEach(i=>this.addReference(i,e))}removeReference(t,e){this.dr(new Lt(t,e))}Ar(t,e){t.forEach(i=>this.removeReference(i,e))}Rr(t){const e=new U(new mt([])),i=new Lt(e,t),o=new Lt(e,t+1),a=[];return this.Ir.forEachInRange([i,o],l=>{this.dr(l),a.push(l.key)}),a}Vr(){this.hr.forEach(t=>this.dr(t))}dr(t){this.hr=this.hr.delete(t),this.Ir=this.Ir.delete(t)}mr(t){const e=new U(new mt([])),i=new Lt(e,t),o=new Lt(e,t+1);let a=nt();return this.Ir.forEachInRange([i,o],l=>{a=a.add(l.key)}),a}containsKey(t){const e=new Lt(t,0),i=this.hr.firstAfterOrEqual(e);return i!==null&&t.isEqual(i.key)}}class Lt{constructor(t,e){this.key=t,this.gr=e}static Pr(t,e){return U.comparator(t.key,e.key)||at(t.gr,e.gr)}static Tr(t,e){return at(t.gr,e.gr)||U.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.pr=1,this.yr=new Ht(Lt.Pr)}checkEmpty(t){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,i,o){const a=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new DS(a,e,i,o);this.mutationQueue.push(l);for(const h of o)this.yr=this.yr.add(new Lt(h.key,a)),this.indexManager.addToCollectionParentIndex(t,h.key.path.popLast());return D.resolve(l)}lookupMutationBatch(t,e){return D.resolve(this.wr(e))}getNextMutationBatchAfterBatchId(t,e){const i=e+1,o=this.Sr(i),a=o<0?0:o;return D.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(t){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new Lt(e,0),o=new Lt(e,Number.POSITIVE_INFINITY),a=[];return this.yr.forEachInRange([i,o],l=>{const h=this.wr(l.gr);a.push(h)}),D.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Ht(at);return e.forEach(o=>{const a=new Lt(o,0),l=new Lt(o,Number.POSITIVE_INFINITY);this.yr.forEachInRange([a,l],h=>{i=i.add(h.gr)})}),D.resolve(this.br(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,o=i.length+1;let a=i;U.isDocumentKey(a)||(a=a.child(""));const l=new Lt(new U(a),0);let h=new Ht(at);return this.yr.forEachWhile(d=>{const m=d.key.path;return!!i.isPrefixOf(m)&&(m.length===o&&(h=h.add(d.gr)),!0)},l),D.resolve(this.br(h))}br(t){const e=[];return t.forEach(i=>{const o=this.wr(i);o!==null&&e.push(o)}),e}removeMutationBatch(t,e){_t(this.Dr(e.batchId,"removed")===0),this.mutationQueue.shift();let i=this.yr;return D.forEach(e.mutations,o=>{const a=new Lt(o.key,e.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,o.key)}).next(()=>{this.yr=i})}Fn(t){}containsKey(t,e){const i=new Lt(e,0),o=this.yr.firstAfterOrEqual(i);return D.resolve(e.isEqual(o&&o.key))}performConsistencyCheck(t){return this.mutationQueue.length,D.resolve()}Dr(t,e){return this.Sr(t)}Sr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}wr(t){const e=this.Sr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(t){this.Cr=t,this.docs=function(){return new It(U.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,o=this.docs.get(i),a=o?o.size:0,l=this.Cr(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return D.resolve(i?i.document.mutableCopy():Zt.newInvalidDocument(e))}getEntries(t,e){let i=fn();return e.forEach(o=>{const a=this.docs.get(o);i=i.insert(o,a?a.document.mutableCopy():Zt.newInvalidDocument(o))}),D.resolve(i)}getDocumentsMatchingQuery(t,e,i,o){let a=fn();const l=e.path,h=new U(l.child("")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){const{key:m,value:{document:_}}=d.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||YR(jR(_),i)<=0||(o.has(_.key)||na(e,_))&&(a=a.insert(_.key,_.mutableCopy()))}return D.resolve(a)}getAllFromCollectionGroup(t,e,i,o){W()}vr(t,e){return D.forEach(this.docs,i=>e(i))}newChangeBuffer(t){return new hC(this)}getSize(t){return D.resolve(this.size)}}class hC extends iC{constructor(t){super(),this._r=t}applyChanges(t){const e=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?e.push(this._r.addEntry(t,o)):this._r.removeEntry(i)}),D.waitFor(e)}getFromCache(t,e){return this._r.getEntry(t,e)}getAllFromCache(t,e){return this._r.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(t){this.persistence=t,this.Fr=new Wr(e=>rc(e),ic),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Mr=0,this.Or=new lc,this.targetCount=0,this.Nr=Mr.On()}forEachTarget(t,e){return this.Fr.forEach((i,o)=>e(o)),D.resolve()}getLastRemoteSnapshotVersion(t){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return D.resolve(this.Mr)}allocateTargetId(t){return this.highestTargetId=this.Nr.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.Mr&&(this.Mr=e),D.resolve()}kn(t){this.Fr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Nr=new Mr(e),this.highestTargetId=e),t.sequenceNumber>this.Mr&&(this.Mr=t.sequenceNumber)}addTargetData(t,e){return this.kn(e),this.targetCount+=1,D.resolve()}updateTargetData(t,e){return this.kn(e),D.resolve()}removeTargetData(t,e){return this.Fr.delete(e.target),this.Or.Rr(e.targetId),this.targetCount-=1,D.resolve()}removeTargets(t,e,i){let o=0;const a=[];return this.Fr.forEach((l,h)=>{h.sequenceNumber<=e&&i.get(h.targetId)===null&&(this.Fr.delete(l),a.push(this.removeMatchingKeysForTargetId(t,h.targetId)),o++)}),D.waitFor(a).next(()=>o)}getTargetCount(t){return D.resolve(this.targetCount)}getTargetData(t,e){const i=this.Fr.get(e)||null;return D.resolve(i)}addMatchingKeys(t,e,i){return this.Or.Er(e,i),D.resolve()}removeMatchingKeys(t,e,i){this.Or.Ar(e,i);const o=this.persistence.referenceDelegate,a=[];return o&&e.forEach(l=>{a.push(o.markPotentiallyOrphaned(t,l))}),D.waitFor(a)}removeMatchingKeysForTargetId(t,e){return this.Or.Rr(e),D.resolve()}getMatchingKeysForTargetId(t,e){const i=this.Or.mr(e);return D.resolve(i)}containsKey(t,e){return D.resolve(this.Or.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(t,e){this.Br={},this.overlays={},this.Lr=new Zl(0),this.kr=!1,this.kr=!0,this.referenceDelegate=t(this),this.qr=new fC(this),this.indexManager=new nC,this.remoteDocumentCache=function(o){return new cC(o)}(i=>this.referenceDelegate.Qr(i)),this.serializer=new tC(e),this.Kr=new aC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new uC,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.Br[t.toKey()];return i||(i=new lC(e,this.referenceDelegate),this.Br[t.toKey()]=i),i}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(t,e,i){M("MemoryPersistence","Starting transaction:",t);const o=new gC(this.Lr.next());return this.referenceDelegate.$r(),i(o).next(a=>this.referenceDelegate.Ur(o).next(()=>a)).toPromise().then(a=>(o.raiseOnCommittedEvent(),a))}Wr(t,e){return D.or(Object.values(this.Br).map(i=>()=>i.containsKey(t,e)))}}class gC extends JR{constructor(t){super(),this.currentSequenceNumber=t}}class cc{constructor(t){this.persistence=t,this.Gr=new lc,this.zr=null}static jr(t){return new cc(t)}get Hr(){if(this.zr)return this.zr;throw W()}addReference(t,e,i){return this.Gr.addReference(i,e),this.Hr.delete(i.toString()),D.resolve()}removeReference(t,e,i){return this.Gr.removeReference(i,e),this.Hr.add(i.toString()),D.resolve()}markPotentiallyOrphaned(t,e){return this.Hr.add(e.toString()),D.resolve()}removeTarget(t,e){this.Gr.Rr(e.targetId).forEach(o=>this.Hr.add(o.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next(o=>{o.forEach(a=>this.Hr.add(a.toString()))}).next(()=>i.removeTargetData(t,e))}$r(){this.zr=new Set}Ur(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.Hr,i=>{const o=U.fromPath(i);return this.Jr(t,o).next(a=>{a||e.removeEntry(o,K.min())})}).next(()=>(this.zr=null,e.apply(t)))}updateLimboDocument(t,e){return this.Jr(t,e).next(i=>{i?this.Hr.delete(e.toString()):this.Hr.add(e.toString())})}Qr(t){return 0}Jr(t,e){return D.or([()=>D.resolve(this.Gr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Wr(t,e)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(t,e,i,o){this.targetId=t,this.fromCache=e,this.ki=i,this.qi=o}static Qi(t,e){let i=nt(),o=nt();for(const a of e.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:o=o.add(a.doc.key)}return new hc(t,e.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(t,e){this.Gi=t,this.indexManager=e,this.Ki=!0}getDocumentsMatchingQuery(t,e,i,o){const a={result:null};return this.zi(t,e).next(l=>{a.result=l}).next(()=>{if(!a.result)return this.ji(t,e,o,i).next(l=>{a.result=l})}).next(()=>{if(a.result)return;const l=new pC;return this.Hi(t,e,l).next(h=>{if(a.result=h,this.$i)return this.Ji(t,e,l,h.size)})}).next(()=>a.result)}Ji(t,e,i,o){return i.documentReadCount<this.Ui?(vi()<=st.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",Tr(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),D.resolve()):(vi()<=st.DEBUG&&M("QueryEngine","Query:",Tr(e),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.Wi*o?(vi()<=st.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",Tr(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,je(e))):D.resolve())}zi(t,e){if($d(e))return D.resolve(null);let i=je(e);return this.indexManager.getIndexType(t,i).next(o=>o===0?null:(e.limit!==null&&o===1&&(e=Tl(e,null,"F"),i=je(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next(a=>{const l=nt(...a);return this.Gi.getDocuments(t,l).next(h=>this.indexManager.getMinOffset(t,i).next(d=>{const m=this.Yi(e,h);return this.Zi(e,m,l,d.readTime)?this.zi(t,Tl(e,null,"F")):this.Xi(t,m,e,d)}))})))}ji(t,e,i,o){return $d(e)||o.isEqual(K.min())?D.resolve(null):this.Gi.getDocuments(t,i).next(a=>{const l=this.Yi(e,a);return this.Zi(e,l,i,o)?D.resolve(null):(vi()<=st.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Tr(e)),this.Xi(t,l,e,QR(o,-1)).next(h=>h))})}Yi(t,e){let i=new Ht(zp(t));return e.forEach((o,a)=>{na(t,a)&&(i=i.add(a))}),i}Zi(t,e,i,o){if(t.limit===null)return!1;if(i.size!==e.size)return!0;const a=t.limitType==="F"?e.last():e.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(o)>0)}Hi(t,e,i){return vi()<=st.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",Tr(e)),this.Gi.getDocumentsMatchingQuery(t,e,Vn.min(),i)}Xi(t,e,i,o){return this.Gi.getDocumentsMatchingQuery(t,i,o).next(a=>(e.forEach(l=>{a=a.insert(l.key,l)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(t,e,i,o){this.persistence=t,this.es=e,this.serializer=o,this.ts=new It(at),this.ns=new Wr(a=>rc(a),ic),this.rs=new Map,this.ss=t.getRemoteDocumentCache(),this.qr=t.getTargetCache(),this.Kr=t.getBundleCache(),this.os(i)}os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new oC(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.ts))}}function yC(n,t,e,i){return new _C(n,t,e,i)}async function hm(n,t){const e=j(n);return await e.persistence.runTransaction("Handle user change","readonly",i=>{let o;return e.mutationQueue.getAllMutationBatches(i).next(a=>(o=a,e.os(t),e.mutationQueue.getAllMutationBatches(i))).next(a=>{const l=[],h=[];let d=nt();for(const m of o){l.push(m.batchId);for(const _ of m.mutations)d=d.add(_.key)}for(const m of a){h.push(m.batchId);for(const _ of m.mutations)d=d.add(_.key)}return e.localDocuments.getDocuments(i,d).next(m=>({_s:m,removedBatchIds:l,addedBatchIds:h}))})})}function vC(n,t){const e=j(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const o=t.batch.keys(),a=e.ss.newChangeBuffer({trackRemovals:!0});return function(h,d,m,_){const w=m.batch,P=w.keys();let x=D.resolve();return P.forEach(z=>{x=x.next(()=>_.getEntry(d,z)).next(X=>{const F=m.docVersions.get(z);_t(F!==null),X.version.compareTo(F)<0&&(w.applyToRemoteDocument(X,m),X.isValidDocument()&&(X.setReadTime(m.commitVersion),_.addEntry(X)))})}),x.next(()=>h.mutationQueue.removeMutationBatch(d,w))}(e,i,t,a).next(()=>a.apply(i)).next(()=>e.mutationQueue.performConsistencyCheck(i)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(i,o,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(h){let d=nt();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(d=d.add(h.batch.mutations[m].key));return d}(t))).next(()=>e.localDocuments.getDocuments(i,o))})}function fm(n){const t=j(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.qr.getLastRemoteSnapshotVersion(e))}function EC(n,t){const e=j(n),i=t.snapshotVersion;let o=e.ts;return e.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=e.ss.newChangeBuffer({trackRemovals:!0});o=e.ts;const h=[];t.targetChanges.forEach((_,w)=>{const P=o.get(w);if(!P)return;h.push(e.qr.removeMatchingKeys(a,_.removedDocuments,w).next(()=>e.qr.addMatchingKeys(a,_.addedDocuments,w)));let x=P.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(w)!==null?x=x.withResumeToken(ne.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):_.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(_.resumeToken,i)),o=o.insert(w,x),function(X,F,lt){return X.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-X.snapshotVersion.toMicroseconds()>=3e8?!0:lt.addedDocuments.size+lt.modifiedDocuments.size+lt.removedDocuments.size>0}(P,x,_)&&h.push(e.qr.updateTargetData(a,x))});let d=fn(),m=nt();if(t.documentUpdates.forEach(_=>{t.resolvedLimboDocuments.has(_)&&h.push(e.persistence.referenceDelegate.updateLimboDocument(a,_))}),h.push(TC(a,l,t.documentUpdates).next(_=>{d=_.us,m=_.cs})),!i.isEqual(K.min())){const _=e.qr.getLastRemoteSnapshotVersion(a).next(w=>e.qr.setTargetsMetadata(a,a.currentSequenceNumber,i));h.push(_)}return D.waitFor(h).next(()=>l.apply(a)).next(()=>e.localDocuments.getLocalViewOfDocuments(a,d,m)).next(()=>d)}).then(a=>(e.ts=o,a))}function TC(n,t,e){let i=nt(),o=nt();return e.forEach(a=>i=i.add(a)),t.getEntries(n,i).next(a=>{let l=fn();return e.forEach((h,d)=>{const m=a.get(h);d.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(h)),d.isNoDocument()&&d.version.isEqual(K.min())?(t.removeEntry(h,d.readTime),l=l.insert(h,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(t.addEntry(d),l=l.insert(h,d)):M("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",d.version)}),{us:l,cs:o}})}function wC(n,t){const e=j(n);return e.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function IC(n,t){const e=j(n);return e.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return e.qr.getTargetData(i,t).next(a=>a?(o=a,D.resolve(o)):e.qr.allocateTargetId(i).next(l=>(o=new An(t,l,"TargetPurposeListen",i.currentSequenceNumber),e.qr.addTargetData(i,o).next(()=>o))))}).then(i=>{const o=e.ts.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(e.ts=e.ts.insert(i.targetId,i),e.ns.set(t,i.targetId)),i})}async function Sl(n,t,e){const i=j(n),o=i.ts.get(t),a=e?"readwrite":"readwrite-primary";try{e||await i.persistence.runTransaction("Release target",a,l=>i.persistence.referenceDelegate.removeTarget(l,o))}catch(l){if(!ns(l))throw l;M("LocalStore",`Failed to update sequence numbers for target ${t}: ${l}`)}i.ts=i.ts.remove(t),i.ns.delete(o.target)}function Zd(n,t,e){const i=j(n);let o=K.min(),a=nt();return i.persistence.runTransaction("Execute query","readwrite",l=>function(d,m,_){const w=j(d),P=w.ns.get(_);return P!==void 0?D.resolve(w.ts.get(P)):w.qr.getTargetData(m,_)}(i,l,je(t)).next(h=>{if(h)return o=h.lastLimboFreeSnapshotVersion,i.qr.getMatchingKeysForTargetId(l,h.targetId).next(d=>{a=d})}).next(()=>i.es.getDocumentsMatchingQuery(l,t,e?o:K.min(),e?a:nt())).next(h=>(AC(i,pS(t),h),{documents:h,ls:a})))}function AC(n,t,e){let i=n.rs.get(t)||K.min();e.forEach((o,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)}),n.rs.set(t,i)}class tg{constructor(){this.activeTargetIds=TS()}ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}As(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Es(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class RC{constructor(){this.eo=new tg,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t){return this.eo.ds(t),this.no[t]||"not-current"}updateQueryState(t,e,i){this.no[t]=e}removeLocalQueryTarget(t){this.eo.As(t)}isLocalQueryTarget(t){return this.eo.activeTargetIds.has(t)}clearQueryState(t){delete this.no[t]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(t){return this.eo.activeTargetIds.has(t)}start(){return this.eo=new tg,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{ro(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(t){this.ao.push(t)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ao)t(0)}_o(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ao)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fo=null;function Qu(){return fo===null?fo=function(){return 268435456+Math.round(2147483648*Math.random())}():fo++,"0x"+fo.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(t){this.co=t.co,this.lo=t.lo}ho(t){this.Po=t}Io(t){this.To=t}onMessage(t){this.Eo=t}close(){this.lo()}send(t){this.co(t)}Ao(){this.Po()}Ro(t){this.To(t)}Vo(t){this.Eo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt="WebChannelConnection";class VC extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const i=e.ssl?"https":"http",o=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.mo=i+"://"+e.host,this.fo=`projects/${o}/databases/${a}`,this.po=this.databaseId.database==="(default)"?`project_id=${o}`:`project_id=${o}&database_id=${a}`}get yo(){return!1}wo(e,i,o,a,l){const h=Qu(),d=this.So(e,i);M("RestConnection",`Sending RPC '${e}' ${h}:`,d,o);const m={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(m,a,l),this.Do(e,d,m,o).then(_=>(M("RestConnection",`Received RPC '${e}' ${h}: `,_),_),_=>{throw xr("RestConnection",`RPC '${e}' ${h} failed with error: `,_,"url: ",d,"request:",o),_})}Co(e,i,o,a,l,h){return this.wo(e,i,o,a,l)}bo(e,i,o){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+qr}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((a,l)=>e[l]=a),o&&o.headers.forEach((a,l)=>e[l]=a)}So(e,i){const o=CC[e];return`${this.mo}/v1/${i}:${o}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Do(t,e,i,o){const a=Qu();return new Promise((l,h)=>{const d=new kR;d.setWithCredentials(!0),d.listenOnce(OR.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Hu.NO_ERROR:const _=d.getResponseJson();M(Xt,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(_)),l(_);break;case Hu.TIMEOUT:M(Xt,`RPC '${t}' ${a} timed out`),h(new L(C.DEADLINE_EXCEEDED,"Request time out"));break;case Hu.HTTP_ERROR:const w=d.getStatus();if(M(Xt,`RPC '${t}' ${a} failed with status:`,w,"response text:",d.getResponseText()),w>0){let P=d.getResponseJson();Array.isArray(P)&&(P=P[0]);const x=P==null?void 0:P.error;if(x&&x.status&&x.message){const z=function(F){const lt=F.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(lt)>=0?lt:C.UNKNOWN}(x.status);h(new L(z,x.message))}else h(new L(C.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new L(C.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{M(Xt,`RPC '${t}' ${a} completed.`)}});const m=JSON.stringify(o);M(Xt,`RPC '${t}' ${a} sending request:`,o),d.send(e,"POST",m,i,15)})}vo(t,e,i){const o=Qu(),a=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=bR(),h=NR(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.xmlHttpFactory=new LR({})),this.bo(d.initMessageHeaders,e,i),d.encodeInitMessageHeaders=!0;const _=a.join("");M(Xt,`Creating RPC '${t}' stream ${o}: ${_}`,d);const w=l.createWebChannel(_,d);let P=!1,x=!1;const z=new PC({co:F=>{x?M(Xt,`Not sending because RPC '${t}' stream ${o} is closed:`,F):(P||(M(Xt,`Opening RPC '${t}' stream ${o} transport.`),w.open(),P=!0),M(Xt,`RPC '${t}' stream ${o} sending:`,F),w.send(F))},lo:()=>w.close()}),X=(F,lt,Ot)=>{F.listen(lt,yt=>{try{Ot(yt)}catch(Kt){setTimeout(()=>{throw Kt},0)}})};return X(w,lo.EventType.OPEN,()=>{x||M(Xt,`RPC '${t}' stream ${o} transport opened.`)}),X(w,lo.EventType.CLOSE,()=>{x||(x=!0,M(Xt,`RPC '${t}' stream ${o} transport closed`),z.Ro())}),X(w,lo.EventType.ERROR,F=>{x||(x=!0,xr(Xt,`RPC '${t}' stream ${o} transport errored:`,F),z.Ro(new L(C.UNAVAILABLE,"The operation could not be completed")))}),X(w,lo.EventType.MESSAGE,F=>{var lt;if(!x){const Ot=F.data[0];_t(!!Ot);const yt=Ot,Kt=yt.error||((lt=yt[0])===null||lt===void 0?void 0:lt.error);if(Kt){M(Xt,`RPC '${t}' stream ${o} received error:`,Kt);const Qt=Kt.status;let ve=function(Hr){const ls=Pt[Hr];if(ls!==void 0)return nm(ls)}(Qt),Ee=Kt.message;ve===void 0&&(ve=C.INTERNAL,Ee="Unknown error status: "+Qt+" with message "+Kt.message),x=!0,z.Ro(new L(ve,Ee)),w.close()}else M(Xt,`RPC '${t}' stream ${o} received:`,Ot),z.Vo(Ot)}}),X(h,MR.STAT_EVENT,F=>{F.stat===xd.PROXY?M(Xt,`RPC '${t}' stream ${o} detected buffering proxy`):F.stat===xd.NOPROXY&&M(Xt,`RPC '${t}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{z.Ao()},0),z}}function ju(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oa(n){return new BS(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(t,e,i=1e3,o=1.5,a=6e4){this.si=t,this.timerId=e,this.Fo=i,this.Mo=o,this.xo=a,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(t){this.cancel();const e=Math.floor(this.Oo+this.qo()),i=Math.max(0,Date.now()-this.Bo),o=Math.max(0,e-i);o>0&&M("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.Oo} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,o,()=>(this.Bo=Date.now(),t())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(t,e,i,o,a,l,h,d){this.si=t,this.Ko=i,this.$o=o,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new dm(t,e)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(t){this.t_(),this.stream.send(t)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(t,e){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,t!==4?this.zo.reset():e&&e.code===C.RESOURCE_EXHAUSTED?(hn(e.toString()),hn("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):e&&e.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Io(e)}r_(){}auth(){this.state=1;const t=this.i_(this.Uo),e=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,o])=>{this.Uo===e&&this.s_(i,o)},i=>{t(()=>{const o=new L(C.UNKNOWN,"Fetching auth token failed: "+i.message);return this.o_(o)})})}s_(t,e){const i=this.i_(this.Uo);this.stream=this.__(t,e),this.stream.ho(()=>{i(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(o=>{i(()=>this.o_(o))}),this.stream.onMessage(o=>{i(()=>this.onMessage(o))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(t){return M("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}i_(t){return e=>{this.si.enqueueAndForget(()=>this.Uo===t?e():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class DC extends gm{constructor(t,e,i,o,a,l){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,o,l),this.serializer=a}__(t,e){return this.connection.vo("Listen",t,e)}onMessage(t){this.zo.reset();const e=WS(this.serializer,t),i=function(a){if(!("targetChange"in a))return K.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?K.min():l.readTime?Ye(l.readTime):K.min()}(t);return this.listener.a_(e,i)}u_(t){const e={};e.database=Rl(this.serializer),e.addTarget=function(a,l){let h;const d=l.target;if(h=vl(d)?{documents:HS(a,d)}:{query:KS(a,d)},h.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){h.resumeToken=sm(a,l.resumeToken);const m=wl(a,l.expectedCount);m!==null&&(h.expectedCount=m)}else if(l.snapshotVersion.compareTo(K.min())>0){h.readTime=Lo(a,l.snapshotVersion.toTimestamp());const m=wl(a,l.expectedCount);m!==null&&(h.expectedCount=m)}return h}(this.serializer,t);const i=jS(this.serializer,t);i&&(e.labels=i),this.e_(e)}c_(t){const e={};e.database=Rl(this.serializer),e.removeTarget=t,this.e_(e)}}class xC extends gm{constructor(t,e,i,o,a,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,o,l),this.serializer=a,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(t,e){return this.connection.vo("Write",t,e)}onMessage(t){if(_t(!!t.streamToken),this.lastStreamToken=t.streamToken,this.l_){this.zo.reset();const e=GS(t.writeResults,t.commitTime),i=Ye(t.commitTime);return this.listener.I_(i,e)}return _t(!t.writeResults||t.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const t={};t.database=Rl(this.serializer),this.e_(t)}P_(t){const e={streamToken:this.lastStreamToken,writes:t.map(i=>zS(this.serializer,i))};this.e_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC extends class{}{constructor(t,e,i,o){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=o,this.d_=!1}A_(){if(this.d_)throw new L(C.FAILED_PRECONDITION,"The client has already been terminated.")}wo(t,e,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.wo(t,e,i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new L(C.UNKNOWN,o.toString())})}Co(t,e,i,o){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Co(t,e,i,a,l,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(C.UNKNOWN,a.toString())})}terminate(){this.d_=!0}}class NC{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(t){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.p_("Offline")))}set(t){this.S_(),this.V_=0,t==="Online"&&(this.f_=!1),this.p_(t)}p_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}y_(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(hn(e),this.f_=!1):M("OnlineStateTracker",e)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(t,e,i,o,a){this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=a,this.F_.ro(l=>{i.enqueueAndForget(async()=>{nr(this)&&(M("RemoteStore","Restarting streams for network reachability change."),await async function(d){const m=j(d);m.C_.add(4),await os(m),m.M_.set("Unknown"),m.C_.delete(4),await aa(m)}(this))})}),this.M_=new NC(i,o)}}async function aa(n){if(nr(n))for(const t of n.v_)await t(!0)}async function os(n){for(const t of n.v_)await t(!1)}function pm(n,t){const e=j(n);e.D_.has(t.targetId)||(e.D_.set(t.targetId,t),gc(e)?dc(e):zr(e).Ho()&&fc(e,t))}function mm(n,t){const e=j(n),i=zr(e);e.D_.delete(t),i.Ho()&&_m(e,t),e.D_.size===0&&(i.Ho()?i.Zo():nr(e)&&e.M_.set("Unknown"))}function fc(n,t){if(n.x_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(K.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}zr(n).u_(t)}function _m(n,t){n.x_.Oe(t),zr(n).c_(t)}function dc(n){n.x_=new LS({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>n.D_.get(t)||null,nt:()=>n.datastore.serializer.databaseId}),zr(n).start(),n.M_.g_()}function gc(n){return nr(n)&&!zr(n).jo()&&n.D_.size>0}function nr(n){return j(n).C_.size===0}function ym(n){n.x_=void 0}async function MC(n){n.D_.forEach((t,e)=>{fc(n,t)})}async function LC(n,t){ym(n),gc(n)?(n.M_.w_(t),dc(n)):n.M_.set("Unknown")}async function kC(n,t,e){if(n.M_.set("Online"),t instanceof im&&t.state===2&&t.cause)try{await async function(o,a){const l=a.cause;for(const h of a.targetIds)o.D_.has(h)&&(await o.remoteSyncer.rejectListen(h,l),o.D_.delete(h),o.x_.removeTarget(h))}(n,t)}catch(i){M("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),await ko(n,i)}else if(t instanceof yo?n.x_.$e(t):t instanceof rm?n.x_.Je(t):n.x_.Ge(t),!e.isEqual(K.min()))try{const i=await fm(n.localStore);e.compareTo(i)>=0&&await function(a,l){const h=a.x_.it(l);return h.targetChanges.forEach((d,m)=>{if(d.resumeToken.approximateByteSize()>0){const _=a.D_.get(m);_&&a.D_.set(m,_.withResumeToken(d.resumeToken,l))}}),h.targetMismatches.forEach((d,m)=>{const _=a.D_.get(d);if(!_)return;a.D_.set(d,_.withResumeToken(ne.EMPTY_BYTE_STRING,_.snapshotVersion)),_m(a,d);const w=new An(_.target,d,m,_.sequenceNumber);fc(a,w)}),a.remoteSyncer.applyRemoteEvent(h)}(n,e)}catch(i){M("RemoteStore","Failed to raise snapshot:",i),await ko(n,i)}}async function ko(n,t,e){if(!ns(t))throw t;n.C_.add(1),await os(n),n.M_.set("Offline"),e||(e=()=>fm(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{M("RemoteStore","Retrying IndexedDB access"),await e(),n.C_.delete(1),await aa(n)})}function vm(n,t){return t().catch(e=>ko(n,e,t))}async function ua(n){const t=j(n),e=xn(t);let i=t.b_.length>0?t.b_[t.b_.length-1].batchId:-1;for(;FC(t);)try{const o=await wC(t.localStore,i);if(o===null){t.b_.length===0&&e.Zo();break}i=o.batchId,UC(t,o)}catch(o){await ko(t,o)}Em(t)&&Tm(t)}function FC(n){return nr(n)&&n.b_.length<10}function UC(n,t){n.b_.push(t);const e=xn(n);e.Ho()&&e.h_&&e.P_(t.mutations)}function Em(n){return nr(n)&&!xn(n).jo()&&n.b_.length>0}function Tm(n){xn(n).start()}async function BC(n){xn(n).E_()}async function qC(n){const t=xn(n);for(const e of n.b_)t.P_(e.mutations)}async function $C(n,t,e){const i=n.b_.shift(),o=oc.from(i,t,e);await vm(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await ua(n)}async function WC(n,t){t&&xn(n).h_&&await async function(i,o){if(function(l){return NS(l)&&l!==C.ABORTED}(o.code)){const a=i.b_.shift();xn(i).Yo(),await vm(i,()=>i.remoteSyncer.rejectFailedWrite(a.batchId,o)),await ua(i)}}(n,t),Em(n)&&Tm(n)}async function ng(n,t){const e=j(n);e.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");const i=nr(e);e.C_.add(3),await os(e),i&&e.M_.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.C_.delete(3),await aa(e)}async function zC(n,t){const e=j(n);t?(e.C_.delete(2),await aa(e)):t||(e.C_.add(2),await os(e),e.M_.set("Unknown"))}function zr(n){return n.O_||(n.O_=function(e,i,o){const a=j(e);return a.A_(),new DC(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{ho:MC.bind(null,n),Io:LC.bind(null,n),a_:kC.bind(null,n)}),n.v_.push(async t=>{t?(n.O_.Yo(),gc(n)?dc(n):n.M_.set("Unknown")):(await n.O_.stop(),ym(n))})),n.O_}function xn(n){return n.N_||(n.N_=function(e,i,o){const a=j(e);return a.A_(),new xC(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{ho:BC.bind(null,n),Io:WC.bind(null,n),T_:qC.bind(null,n),I_:$C.bind(null,n)}),n.v_.push(async t=>{t?(n.N_.Yo(),await ua(n)):(await n.N_.stop(),n.b_.length>0&&(M("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))})),n.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(t,e,i,o,a){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=o,this.removalCallback=a,this.deferred=new Cn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,o,a){const l=Date.now()+i,h=new pc(t,e,l,o,a);return h.start(i),h}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(C.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function mc(n,t){if(hn("AsyncQueue",`${t}: ${n}`),ns(n))return new L(C.UNAVAILABLE,`${t}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(t){this.comparator=t?(e,i)=>t(e,i)||U.comparator(e.key,i.key):(e,i)=>U.comparator(e.key,i.key),this.keyedMap=Ii(),this.sortedSet=new It(this.comparator)}static emptySet(t){return new Pr(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,i)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Pr)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){const o=e.getNext().key,a=i.getNext().key;if(!o.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const i=new Pr;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(){this.B_=new It(U.comparator)}track(t){const e=t.doc.key,i=this.B_.get(e);i?t.type!==0&&i.type===3?this.B_=this.B_.insert(e,t):t.type===3&&i.type!==1?this.B_=this.B_.insert(e,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.B_=this.B_.insert(e,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.B_=this.B_.insert(e,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.B_=this.B_.remove(e):t.type===1&&i.type===2?this.B_=this.B_.insert(e,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.B_=this.B_.insert(e,{type:2,doc:t.doc}):W():this.B_=this.B_.insert(e,t)}L_(){const t=[];return this.B_.inorderTraversal((e,i)=>{t.push(i)}),t}}class Lr{constructor(t,e,i,o,a,l,h,d,m){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(t,e,i,o,a){const l=[];return e.forEach(h=>{l.push({type:0,doc:h})}),new Lr(t,e,Pr.emptySet(e),l,i,o,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ea(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let o=0;o<e.length;o++)if(e[o].type!==i[o].type||!e[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(){this.k_=void 0,this.listeners=[]}}class HC{constructor(){this.queries=new Wr(t=>Wp(t),ea),this.onlineState="Unknown",this.q_=new Set}}async function KC(n,t){const e=j(n),i=t.query;let o=!1,a=e.queries.get(i);if(a||(o=!0,a=new GC),o)try{a.k_=await e.onListen(i)}catch(l){const h=mc(l,`Initialization of query '${Tr(t.query)}' failed`);return void t.onError(h)}e.queries.set(i,a),a.listeners.push(t),t.Q_(e.onlineState),a.k_&&t.K_(a.k_)&&_c(e)}async function QC(n,t){const e=j(n),i=t.query;let o=!1;const a=e.queries.get(i);if(a){const l=a.listeners.indexOf(t);l>=0&&(a.listeners.splice(l,1),o=a.listeners.length===0)}if(o)return e.queries.delete(i),e.onUnlisten(i)}function jC(n,t){const e=j(n);let i=!1;for(const o of t){const a=o.query,l=e.queries.get(a);if(l){for(const h of l.listeners)h.K_(o)&&(i=!0);l.k_=o}}i&&_c(e)}function YC(n,t,e){const i=j(n),o=i.queries.get(t);if(o)for(const a of o.listeners)a.onError(e);i.queries.delete(t)}function _c(n){n.q_.forEach(t=>{t.next()})}class XC{constructor(t,e,i){this.query=t,this.U_=e,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=i||{}}K_(t){if(!this.options.includeMetadataChanges){const i=[];for(const o of t.docChanges)o.type!==3&&i.push(o);t=new Lr(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.W_?this.z_(t)&&(this.U_.next(t),e=!0):this.j_(t,this.onlineState)&&(this.H_(t),e=!0),this.G_=t,e}onError(t){this.U_.error(t)}Q_(t){this.onlineState=t;let e=!1;return this.G_&&!this.W_&&this.j_(this.G_,t)&&(this.H_(this.G_),e=!0),e}j_(t,e){if(!t.fromCache)return!0;const i=e!=="Offline";return(!this.options.J_||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}z_(t){if(t.docChanges.length>0)return!0;const e=this.G_&&this.G_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}H_(t){t=Lr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.W_=!0,this.U_.next(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(t){this.key=t}}class Im{constructor(t){this.key=t}}class JC{constructor(t,e){this.query=t,this.ia=e,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=nt(),this.mutatedKeys=nt(),this._a=zp(t),this.aa=new Pr(this._a)}get ua(){return this.ia}ca(t,e){const i=e?e.la:new rg,o=e?e.aa:this.aa;let a=e?e.mutatedKeys:this.mutatedKeys,l=o,h=!1;const d=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(t.inorderTraversal((_,w)=>{const P=o.get(_),x=na(this.query,w)?w:null,z=!!P&&this.mutatedKeys.has(P.key),X=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let F=!1;P&&x?P.data.isEqual(x.data)?z!==X&&(i.track({type:3,doc:x}),F=!0):this.ha(P,x)||(i.track({type:2,doc:x}),F=!0,(d&&this._a(x,d)>0||m&&this._a(x,m)<0)&&(h=!0)):!P&&x?(i.track({type:0,doc:x}),F=!0):P&&!x&&(i.track({type:1,doc:P}),F=!0,(d||m)&&(h=!0)),F&&(x?(l=l.add(x),a=X?a.add(_):a.delete(_)):(l=l.delete(_),a=a.delete(_)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),a=a.delete(_.key),i.track({type:1,doc:_})}return{aa:l,la:i,Zi:h,mutatedKeys:a}}ha(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i){const o=this.aa;this.aa=t.aa,this.mutatedKeys=t.mutatedKeys;const a=t.la.L_();a.sort((m,_)=>function(P,x){const z=X=>{switch(X){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return z(P)-z(x)}(m.type,_.type)||this._a(m.doc,_.doc)),this.Pa(i);const l=e?this.Ia():[],h=this.oa.size===0&&this.current?1:0,d=h!==this.sa;return this.sa=h,a.length!==0||d?{snapshot:new Lr(this.query,t.aa,o,a,t.mutatedKeys,h===0,d,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ta:l}:{Ta:l}}Q_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new rg,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(t){return!this.ia.has(t)&&!!this.aa.has(t)&&!this.aa.get(t).hasLocalMutations}Pa(t){t&&(t.addedDocuments.forEach(e=>this.ia=this.ia.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.ia=this.ia.delete(e)),this.current=t.current)}Ia(){if(!this.current)return[];const t=this.oa;this.oa=nt(),this.aa.forEach(i=>{this.Ea(i.key)&&(this.oa=this.oa.add(i.key))});const e=[];return t.forEach(i=>{this.oa.has(i)||e.push(new Im(i))}),this.oa.forEach(i=>{t.has(i)||e.push(new wm(i))}),e}da(t){this.ia=t.ls,this.oa=nt();const e=this.ca(t.documents);return this.applyChanges(e,!0)}Aa(){return Lr.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class ZC{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}}class tP{constructor(t){this.key=t,this.Ra=!1}}class eP{constructor(t,e,i,o,a,l){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=o,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Va={},this.ma=new Wr(h=>Wp(h),ea),this.fa=new Map,this.ga=new Set,this.pa=new It(U.comparator),this.ya=new Map,this.wa=new lc,this.Sa={},this.ba=new Map,this.Da=Mr.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function nP(n,t){const e=fP(n);let i,o;const a=e.ma.get(t);if(a)i=a.targetId,e.sharedClientState.addLocalQueryTarget(i),o=a.view.Aa();else{const l=await IC(e.localStore,je(t)),h=e.sharedClientState.addLocalQueryTarget(l.targetId);i=l.targetId,o=await rP(e,t,i,h==="current",l.resumeToken),e.isPrimaryClient&&pm(e.remoteStore,l)}return o}async function rP(n,t,e,i,o){n.va=(w,P,x)=>async function(X,F,lt,Ot){let yt=F.view.ca(lt);yt.Zi&&(yt=await Zd(X.localStore,F.query,!1).then(({documents:ve})=>F.view.ca(ve,yt)));const Kt=Ot&&Ot.targetChanges.get(F.targetId),Qt=F.view.applyChanges(yt,X.isPrimaryClient,Kt);return sg(X,F.targetId,Qt.Ta),Qt.snapshot}(n,w,P,x);const a=await Zd(n.localStore,t,!0),l=new JC(t,a.ls),h=l.ca(a.documents),d=ss.createSynthesizedTargetChangeForCurrentChange(e,i&&n.onlineState!=="Offline",o),m=l.applyChanges(h,n.isPrimaryClient,d);sg(n,e,m.Ta);const _=new ZC(t,e,l);return n.ma.set(t,_),n.fa.has(e)?n.fa.get(e).push(t):n.fa.set(e,[t]),m.snapshot}async function iP(n,t){const e=j(n),i=e.ma.get(t),o=e.fa.get(i.targetId);if(o.length>1)return e.fa.set(i.targetId,o.filter(a=>!ea(a,t))),void e.ma.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(i.targetId),e.sharedClientState.isActiveQueryTarget(i.targetId)||await Sl(e.localStore,i.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(i.targetId),mm(e.remoteStore,i.targetId),Cl(e,i.targetId)}).catch(es)):(Cl(e,i.targetId),await Sl(e.localStore,i.targetId,!0))}async function sP(n,t,e){const i=dP(n);try{const o=await function(l,h){const d=j(l),m=Nt.now(),_=h.reduce((x,z)=>x.add(z.key),nt());let w,P;return d.persistence.runTransaction("Locally write mutations","readwrite",x=>{let z=fn(),X=nt();return d.ss.getEntries(x,_).next(F=>{z=F,z.forEach((lt,Ot)=>{Ot.isValidDocument()||(X=X.add(lt))})}).next(()=>d.localDocuments.getOverlayedDocuments(x,z)).next(F=>{w=F;const lt=[];for(const Ot of h){const yt=PS(Ot,w.get(Ot.key).overlayedDocument);yt!=null&&lt.push(new er(Ot.key,yt,Op(yt.value.mapValue),Ue.exists(!0)))}return d.mutationQueue.addMutationBatch(x,m,lt,h)}).next(F=>{P=F;const lt=F.applyToLocalDocumentSet(w,X);return d.documentOverlayCache.saveOverlays(x,F.batchId,lt)})}).then(()=>({batchId:P.batchId,changes:Hp(w)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(o.batchId),function(l,h,d){let m=l.Sa[l.currentUser.toKey()];m||(m=new It(at)),m=m.insert(h,d),l.Sa[l.currentUser.toKey()]=m}(i,o.batchId,e),await as(i,o.changes),await ua(i.remoteStore)}catch(o){const a=mc(o,"Failed to persist write");e.reject(a)}}async function Am(n,t){const e=j(n);try{const i=await EC(e.localStore,t);t.targetChanges.forEach((o,a)=>{const l=e.ya.get(a);l&&(_t(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1),o.addedDocuments.size>0?l.Ra=!0:o.modifiedDocuments.size>0?_t(l.Ra):o.removedDocuments.size>0&&(_t(l.Ra),l.Ra=!1))}),await as(e,i,t)}catch(i){await es(i)}}function ig(n,t,e){const i=j(n);if(i.isPrimaryClient&&e===0||!i.isPrimaryClient&&e===1){const o=[];i.ma.forEach((a,l)=>{const h=l.view.Q_(t);h.snapshot&&o.push(h.snapshot)}),function(l,h){const d=j(l);d.onlineState=h;let m=!1;d.queries.forEach((_,w)=>{for(const P of w.listeners)P.Q_(h)&&(m=!0)}),m&&_c(d)}(i.eventManager,t),o.length&&i.Va.a_(o),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function oP(n,t,e){const i=j(n);i.sharedClientState.updateQueryState(t,"rejected",e);const o=i.ya.get(t),a=o&&o.key;if(a){let l=new It(U.comparator);l=l.insert(a,Zt.newNoDocument(a,K.min()));const h=nt().add(a),d=new sa(K.min(),new Map,new It(at),l,h);await Am(i,d),i.pa=i.pa.remove(a),i.ya.delete(t),yc(i)}else await Sl(i.localStore,t,!1).then(()=>Cl(i,t,e)).catch(es)}async function aP(n,t){const e=j(n),i=t.batch.batchId;try{const o=await vC(e.localStore,t);Sm(e,i,null),Rm(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await as(e,o)}catch(o){await es(o)}}async function uP(n,t,e){const i=j(n);try{const o=await function(l,h){const d=j(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let _;return d.mutationQueue.lookupMutationBatch(m,h).next(w=>(_t(w!==null),_=w.keys(),d.mutationQueue.removeMutationBatch(m,w))).next(()=>d.mutationQueue.performConsistencyCheck(m)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(m,_,h)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_)).next(()=>d.localDocuments.getDocuments(m,_))})}(i.localStore,t);Sm(i,t,e),Rm(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),await as(i,o)}catch(o){await es(o)}}function Rm(n,t){(n.ba.get(t)||[]).forEach(e=>{e.resolve()}),n.ba.delete(t)}function Sm(n,t,e){const i=j(n);let o=i.Sa[i.currentUser.toKey()];if(o){const a=o.get(t);a&&(e?a.reject(e):a.resolve(),o=o.remove(t)),i.Sa[i.currentUser.toKey()]=o}}function Cl(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.fa.get(t))n.ma.delete(i),e&&n.Va.Fa(i,e);n.fa.delete(t),n.isPrimaryClient&&n.wa.Rr(t).forEach(i=>{n.wa.containsKey(i)||Cm(n,i)})}function Cm(n,t){n.ga.delete(t.path.canonicalString());const e=n.pa.get(t);e!==null&&(mm(n.remoteStore,e),n.pa=n.pa.remove(t),n.ya.delete(e),yc(n))}function sg(n,t,e){for(const i of e)i instanceof wm?(n.wa.addReference(i.key,t),lP(n,i)):i instanceof Im?(M("SyncEngine","Document no longer in limbo: "+i.key),n.wa.removeReference(i.key,t),n.wa.containsKey(i.key)||Cm(n,i.key)):W()}function lP(n,t){const e=t.key,i=e.path.canonicalString();n.pa.get(e)||n.ga.has(i)||(M("SyncEngine","New document in limbo: "+e),n.ga.add(i),yc(n))}function yc(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const t=n.ga.values().next().value;n.ga.delete(t);const e=new U(mt.fromString(t)),i=n.Da.next();n.ya.set(i,new tP(e)),n.pa=n.pa.insert(e,i),pm(n.remoteStore,new An(je(qp(e.path)),i,"TargetPurposeLimboResolution",Zl._e))}}async function as(n,t,e){const i=j(n),o=[],a=[],l=[];i.ma.isEmpty()||(i.ma.forEach((h,d)=>{l.push(i.va(d,t,e).then(m=>{if((m||e)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(d.targetId,m!=null&&m.fromCache?"not-current":"current"),m){o.push(m);const _=hc.Qi(d.targetId,m);a.push(_)}}))}),await Promise.all(l),i.Va.a_(o),await async function(d,m){const _=j(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>D.forEach(m,P=>D.forEach(P.ki,x=>_.persistence.referenceDelegate.addReference(w,P.targetId,x)).next(()=>D.forEach(P.qi,x=>_.persistence.referenceDelegate.removeReference(w,P.targetId,x)))))}catch(w){if(!ns(w))throw w;M("LocalStore","Failed to update sequence numbers: "+w)}for(const w of m){const P=w.targetId;if(!w.fromCache){const x=_.ts.get(P),z=x.snapshotVersion,X=x.withLastLimboFreeSnapshotVersion(z);_.ts=_.ts.insert(P,X)}}}(i.localStore,a))}async function cP(n,t){const e=j(n);if(!e.currentUser.isEqual(t)){M("SyncEngine","User change. New user:",t.toKey());const i=await hm(e.localStore,t);e.currentUser=t,function(a,l){a.ba.forEach(h=>{h.forEach(d=>{d.reject(new L(C.CANCELLED,l))})}),a.ba.clear()}(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await as(e,i._s)}}function hP(n,t){const e=j(n),i=e.ya.get(t);if(i&&i.Ra)return nt().add(i.key);{let o=nt();const a=e.fa.get(t);if(!a)return o;for(const l of a){const h=e.ma.get(l);o=o.unionWith(h.view.ua)}return o}}function fP(n){const t=j(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=Am.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=hP.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=oP.bind(null,t),t.Va.a_=jC.bind(null,t.eventManager),t.Va.Fa=YC.bind(null,t.eventManager),t}function dP(n){const t=j(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=aP.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=uP.bind(null,t),t}class og{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=oa(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return yC(this.persistence,new mC,t.initialUser,this.serializer)}createPersistence(t){return new dC(cc.jr,this.serializer)}createSharedClientState(t){return new RC}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class gP{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>ig(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=cP.bind(null,this.syncEngine),await zC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new HC}()}createDatastore(t){const e=oa(t.databaseInfo.databaseId),i=function(a){return new VC(a)}(t.databaseInfo);return function(a,l,h,d){return new bC(a,l,h,d)}(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return function(i,o,a,l,h){return new OC(i,o,a,l,h)}(this.localStore,this.datastore,t.asyncQueue,e=>ig(this.syncEngine,e,0),function(){return eg.D()?new eg:new SC}())}createSyncEngine(t,e){return function(o,a,l,h,d,m,_){const w=new eP(o,a,l,h,d,m);return _&&(w.Ca=!0),w}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(e){const i=j(e);M("RemoteStore","RemoteStore shutting down."),i.C_.add(5),await os(i),i.F_.shutdown(),i.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Oa(this.observer.next,t)}error(t){this.observer.error?this.Oa(this.observer.error,t):hn("Uncaught Error in snapshot listener:",t.toString())}Na(){this.muted=!0}Oa(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(t,e,i,o){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=o,this.user=Jt.UNAUTHENTICATED,this.clientId=xp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,async a=>{M("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(i,a=>(M("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new L(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Cn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const i=mc(e,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function Yu(n,t){n.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");const e=await n.getConfiguration();await t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener(async o=>{i.isEqual(o)||(await hm(t.localStore,o),i=o)}),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}async function ag(n,t){n.asyncQueue.verifyOperationInProgress();const e=await yP(n);M("FirestoreClient","Initializing OnlineComponentProvider");const i=await n.getConfiguration();await t.initialize(e,i),n.setCredentialChangeListener(o=>ng(t.remoteStore,o)),n.setAppCheckTokenChangeListener((o,a)=>ng(t.remoteStore,a)),n._onlineComponents=t}function _P(n){return n.name==="FirebaseError"?n.code===C.FAILED_PRECONDITION||n.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function yP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M("FirestoreClient","Using user provided OfflineComponentProvider");try{await Yu(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!_P(e))throw e;xr("Error using user provided cache. Falling back to memory cache: "+e),await Yu(n,new og)}}else M("FirestoreClient","Using default OfflineComponentProvider"),await Yu(n,new og);return n._offlineComponents}async function Pm(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(M("FirestoreClient","Using user provided OnlineComponentProvider"),await ag(n,n._uninitializedComponentsProvider._online)):(M("FirestoreClient","Using default OnlineComponentProvider"),await ag(n,new gP))),n._onlineComponents}function vP(n){return Pm(n).then(t=>t.syncEngine)}async function EP(n){const t=await Pm(n),e=t.eventManager;return e.onListen=nP.bind(null,t.syncEngine),e.onUnlisten=iP.bind(null,t.syncEngine),e}function TP(n,t,e={}){const i=new Cn;return n.asyncQueue.enqueueAndForget(async()=>function(a,l,h,d,m){const _=new pP({next:P=>{l.enqueueAndForget(()=>QC(a,w)),P.fromCache&&d.source==="server"?m.reject(new L(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(P)},error:P=>m.reject(P)}),w=new XC(h,_,{includeMetadataChanges:!0,J_:!0});return KC(a,w)}(await EP(n),n.asyncQueue,t,e,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dm(n,t,e){if(!e)throw new L(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function wP(n,t,e,i){if(t===!0&&i===!0)throw new L(C.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function lg(n){if(!U.isDocumentKey(n))throw new L(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function cg(n){if(U.isDocumentKey(n))throw new L(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function la(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":W()}function Zn(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new L(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=la(n);throw new L(C.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(t){var e,i;if(t.host===void 0){if(t.ssl!==void 0)throw new L(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(e=t.ssl)===null||e===void 0||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new L(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}wP("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vm((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,o){return i.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ca{constructor(t,e,i,o){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new L(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new L(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hg(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new UR;switch(i.type){case"firstParty":return new WR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new L(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const i=ug.get(e);i&&(M("ComponentProvider","Removing Datastore"),ug.delete(e),i.terminate())}(this),Promise.resolve()}}function IP(n,t,e,i={}){var o;const a=(n=Zn(n,ca))._getSettings(),l=`${t}:${e}`;if(a.host!=="firestore.googleapis.com"&&a.host!==l&&xr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},a),{host:l,ssl:!1})),i.mockUserToken){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=Jt.MOCK_USER;else{h=mA(i.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new L(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Jt(m)}n._authCredentials=new BR(new Dp(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Gr(this.firestore,t,this._query)}}class _e{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new _e(this.firestore,t,this._key)}}class Pn extends Gr{constructor(t,e,i){super(t,e,qp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new _e(this.firestore,null,new U(t))}withConverter(t){return new Pn(this.firestore,t,this._path)}}function fg(n,t,...e){if(n=Vr(n),Dm("collection","path",t),n instanceof ca){const i=mt.fromString(t,...e);return cg(i),new Pn(n,null,i)}{if(!(n instanceof _e||n instanceof Pn))throw new L(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(mt.fromString(t,...e));return cg(i),new Pn(n.firestore,null,i)}}function Pl(n,t,...e){if(n=Vr(n),arguments.length===1&&(t=xp.newId()),Dm("doc","path",t),n instanceof ca){const i=mt.fromString(t,...e);return lg(i),new _e(n,null,new U(i))}{if(!(n instanceof _e||n instanceof Pn))throw new L(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(mt.fromString(t,...e));return lg(i),new _e(n.firestore,n instanceof Pn?n.converter:null,new U(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new dm(this,"async_queue_retry"),this.iu=()=>{const e=ju();e&&M("AsyncQueue","Visibility state changed to "+e.visibilityState),this.zo.Qo()};const t=ju();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.su(),this.ou(t)}enterRestrictedMode(t){if(!this.Za){this.Za=!0,this.nu=t||!1;const e=ju();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this.iu)}}enqueue(t){if(this.su(),this.Za)return new Promise(()=>{});const e=new Cn;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ya.push(t),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(t){if(!ns(t))throw t;M("AsyncQueue","Operation failed with retryable error: "+t)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(t){const e=this.Ja.then(()=>(this.tu=!0,t().catch(i=>{this.eu=i,this.tu=!1;const o=function(l){let h=l.message||"";return l.stack&&(h=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),h}(i);throw hn("INTERNAL UNHANDLED ERROR: ",o),i}).then(i=>(this.tu=!1,i))));return this.Ja=e,e}enqueueAfterDelay(t,e,i){this.su(),this.ru.indexOf(t)>-1&&(e=0);const o=pc.createAndSchedule(this,t,e,i,a=>this.au(a));return this.Xa.push(o),o}su(){this.eu&&W()}verifyOperationInProgress(){}async uu(){let t;do t=this.Ja,await t;while(t!==this.Ja)}cu(t){for(const e of this.Xa)if(e.timerId===t)return!0;return!1}lu(t){return this.uu().then(()=>{this.Xa.sort((e,i)=>e.targetTimeMs-i.targetTimeMs);for(const e of this.Xa)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.uu()})}hu(t){this.ru.push(t)}au(t){const e=this.Xa.indexOf(t);this.Xa.splice(e,1)}}class us extends ca{constructor(t,e,i,o){super(t,e,i,o),this.type="firestore",this._queue=function(){return new AP}(),this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||bm(this),this._firestoreClient.terminate()}}function RP(n,t){const e=typeof n=="object"?n:E1(),i=typeof n=="string"?n:t||"(default)",o=m1(e,"firestore").getImmediate({identifier:i});if(!o._initialized){const a=gA("firestore");a&&IP(o,...a)}return o}function xm(n){return n._firestoreClient||bm(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function bm(n){var t,e,i;const o=n._freezeSettings(),a=function(h,d,m,_){return new eS(h,d,m,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Vm(_.experimentalLongPollingOptions),_.useFetchStreams)}(n._databaseId,((t=n._app)===null||t===void 0?void 0:t.options.appId)||"",n._persistenceKey,o);n._firestoreClient=new mP(n._authCredentials,n._appCheckCredentials,n._queue,a),!((e=o.localCache)===null||e===void 0)&&e._offlineComponentProvider&&(!((i=o.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:o.localCache.kind,_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(t){this._byteString=t}static fromBase64String(t){try{return new kr(ne.fromBase64String(t))}catch(e){throw new L(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new kr(ne.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new L(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new L(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new L(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return at(this._lat,t._lat)||at(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SP=/^__.*__$/;class CP{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new er(t,this.data,this.fieldMask,e,this.fieldTransforms):new is(t,this.data,e,this.fieldTransforms)}}function Om(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}class Tc{constructor(t,e,i,o,a,l){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=o,a===void 0&&this.Pu(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(t){return new Tc(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(t){var e;const i=(e=this.path)===null||e===void 0?void 0:e.child(t),o=this.Tu({path:i,du:!1});return o.Au(t),o}Ru(t){var e;const i=(e=this.path)===null||e===void 0?void 0:e.child(t),o=this.Tu({path:i,du:!1});return o.Pu(),o}Vu(t){return this.Tu({path:void 0,du:!0})}mu(t){return Fo(t,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}Pu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Au(this.path.get(t))}Au(t){if(t.length===0)throw this.mu("Document fields must not be empty");if(Om(this.Iu)&&SP.test(t))throw this.mu('Document fields cannot begin and end with "__"')}}class PP{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||oa(t)}pu(t,e,i,o=!1){return new Tc({Iu:t,methodName:e,gu:i,path:zt.emptyPath(),du:!1,fu:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function wc(n){const t=n._freezeSettings(),e=oa(n._databaseId);return new PP(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Mm(n,t,e,i,o,a={}){const l=n.pu(a.merge||a.mergeFields?2:0,t,e,o);Fm("Data must be an object, but it was:",l,i);const h=Lm(i,l);let d,m;if(a.merge)d=new Fe(l.fieldMask),m=l.fieldTransforms;else if(a.mergeFields){const _=[];for(const w of a.mergeFields){const P=DP(t,w,e);if(!l.contains(P))throw new L(C.INVALID_ARGUMENT,`Field '${P}' is specified in your field mask but missing from your input data.`);bP(_,P)||_.push(P)}d=new Fe(_),m=l.fieldTransforms.filter(w=>d.covers(w.field))}else d=null,m=l.fieldTransforms;return new CP(new De(h),d,m)}function VP(n,t,e,i=!1){return Ic(e,n.pu(i?4:3,t))}function Ic(n,t){if(km(n=Vr(n)))return Fm("Unsupported field value:",t,n),Lm(n,t);if(n instanceof Nm)return function(i,o){if(!Om(o.Iu))throw o.mu(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.mu(`${i._methodName}() is not currently supported inside arrays`);const a=i._toFieldTransform(o);a&&o.fieldTransforms.push(a)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.du&&t.Iu!==4)throw t.mu("Nested arrays are not supported");return function(i,o){const a=[];let l=0;for(const h of i){let d=Ic(h,o.Vu(l));d==null&&(d={nullValue:"NULL_VALUE"}),a.push(d),l++}return{arrayValue:{values:a}}}(n,t)}return function(i,o){if((i=Vr(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return wS(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const a=Nt.fromDate(i);return{timestampValue:Lo(o.serializer,a)}}if(i instanceof Nt){const a=new Nt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Lo(o.serializer,a)}}if(i instanceof Ec)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof kr)return{bytesValue:sm(o.serializer,i._byteString)};if(i instanceof _e){const a=o.databaseId,l=i.firestore._databaseId;if(!l.isEqual(a))throw o.mu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:uc(i.firestore._databaseId||o.databaseId,i._key.path)}}throw o.mu(`Unsupported field value: ${la(i)}`)}(n,t)}function Lm(n,t){const e={};return bp(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):$r(n,(i,o)=>{const a=Ic(o,t.Eu(i));a!=null&&(e[i]=a)}),{mapValue:{fields:e}}}function km(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Nt||n instanceof Ec||n instanceof kr||n instanceof _e||n instanceof Nm)}function Fm(n,t,e){if(!km(e)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(e)){const i=la(e);throw i==="an object"?t.mu(n+" a custom object"):t.mu(n+" "+i)}}function DP(n,t,e){if((t=Vr(t))instanceof vc)return t._internalPath;if(typeof t=="string")return Um(n,t);throw Fo("Field path arguments must be of type string or ",n,!1,void 0,e)}const xP=new RegExp("[~\\*/\\[\\]]");function Um(n,t,e){if(t.search(xP)>=0)throw Fo(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new vc(...t.split("."))._internalPath}catch{throw Fo(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function Fo(n,t,e,i,o){const a=i&&!i.isEmpty(),l=o!==void 0;let h=`Function ${t}() called with invalid data`;e&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(a||l)&&(d+=" (found",a&&(d+=` in field ${i}`),l&&(d+=` in document ${o}`),d+=")"),new L(C.INVALID_ARGUMENT,h+n+d)}function bP(n,t){return n.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(t,e,i,o,a){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=o,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new _e(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new NP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(qm("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class NP extends Bm{data(){return super.data()}}function qm(n,t){return typeof t=="string"?Um(n,t):t instanceof vc?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ac{}class MP extends Ac{}function LP(n,t,...e){let i=[];t instanceof Ac&&i.push(t),i=i.concat(e),function(a){const l=a.filter(d=>d instanceof Sc).length,h=a.filter(d=>d instanceof Rc).length;if(l>1||l>0&&h>0)throw new L(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const o of i)n=o._apply(n);return n}class Rc extends MP{constructor(t,e,i){super(),this._field=t,this._op=e,this._value=i,this.type="where"}static _create(t,e,i){return new Rc(t,e,i)}_apply(t){const e=this._parse(t);return $m(t._query,e),new Gr(t.firestore,t.converter,El(t._query,e))}_parse(t){const e=wc(t.firestore);return function(a,l,h,d,m,_,w){let P;if(m.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new L(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){gg(w,_);const x=[];for(const z of w)x.push(dg(d,a,z));P={arrayValue:{values:x}}}else P=dg(d,a,w)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||gg(w,_),P=VP(h,l,w,_==="in"||_==="not-in");return Dt.create(m,_,P)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}class Sc extends Ac{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new Sc(t,e)}_parse(t){const e=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return e.length===1?e[0]:qe.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:(function(o,a){let l=o;const h=a.getFlattenedFilters();for(const d of h)$m(l,d),l=El(l,d)}(t._query,e),new Gr(t.firestore,t.converter,El(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function dg(n,t,e){if(typeof(e=Vr(e))=="string"){if(e==="")throw new L(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$p(t)&&e.indexOf("/")!==-1)throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const i=t.path.child(mt.fromString(e));if(!U.isDocumentKey(i))throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ld(n,new U(i))}if(e instanceof _e)return Ld(n,e._key);throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${la(e)}.`)}function gg(n,t){if(!Array.isArray(n)||n.length===0)throw new L(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function $m(n,t){const e=function(o,a){for(const l of o)for(const h of l.getFlattenedFilters())if(a.indexOf(h.op)>=0)return h.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(e!==null)throw e===t.op?new L(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new L(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class kP{convertValue(t,e="none"){switch(Jn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Vt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Xn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw W()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const i={};return $r(t,(o,a)=>{i[o]=this.convertValue(a,e)}),i}convertGeoPoint(t){return new Ec(Vt(t.latitude),Vt(t.longitude))}convertArray(t,e){return(t.values||[]).map(i=>this.convertValue(i,e))}convertServerTimestamp(t,e){switch(e){case"previous":const i=ec(t);return i==null?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(qi(t));default:return null}}convertTimestamp(t){const e=Dn(t);return new Nt(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=mt.fromString(t);_t(cm(i));const o=new $i(i.get(1),i.get(3)),a=new U(i.popFirst(5));return o.isEqual(e)||hn(`Document ${a} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(n,t,e){let i;return i=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class FP extends Bm{constructor(t,e,i,o,a,l){super(t,e,i,o,l),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new vo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const i=this._document.data.field(qm("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}}class vo extends FP{data(t={}){return super.data(t)}}class UP{constructor(t,e,i,o){this._firestore=t,this._userDataWriter=e,this._snapshot=o,this.metadata=new go(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach(i=>{t.call(e,new vo(this._firestore,this._userDataWriter,i.key,i,new go(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new L(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(o,a){if(o._snapshot.oldDocs.isEmpty()){let l=0;return o._snapshot.docChanges.map(h=>{const d=new vo(o._firestore,o._userDataWriter,h.doc.key,h.doc,new go(o._snapshot.mutatedKeys.has(h.doc.key),o._snapshot.fromCache),o.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}})}{let l=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(h=>a||h.type!==3).map(h=>{const d=new vo(o._firestore,o._userDataWriter,h.doc.key,h.doc,new go(o._snapshot.mutatedKeys.has(h.doc.key),o._snapshot.fromCache),o.query.converter);let m=-1,_=-1;return h.type!==0&&(m=l.indexOf(h.doc.key),l=l.delete(h.doc.key)),h.type!==1&&(l=l.add(h.doc),_=l.indexOf(h.doc.key)),{type:BP(h.type),doc:d,oldIndex:m,newIndex:_}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function BP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}class qP extends kP{constructor(t){super(),this.firestore=t}convertBytes(t){return new kr(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new _e(this.firestore,null,e)}}function $P(n){n=Zn(n,Gr);const t=Zn(n.firestore,us),e=xm(t),i=new qP(t);return OP(n._query),TP(e,n._query).then(o=>new UP(t,i,n,o))}function WP(n,t,e){n=Zn(n,_e);const i=Zn(n.firestore,us),o=Wm(n.converter,t,e);return Cc(i,[Mm(wc(i),"setDoc",n._key,o,n.converter!==null,e).toMutation(n._key,Ue.none())])}function zP(n){return Cc(Zn(n.firestore,us),[new sc(n._key,Ue.none())])}function GP(n,t){const e=Zn(n.firestore,us),i=Pl(n),o=Wm(n.converter,t);return Cc(e,[Mm(wc(n.firestore),"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,Ue.exists(!1))]).then(()=>i)}function Cc(n,t){return function(i,o){const a=new Cn;return i.asyncQueue.enqueueAndForget(async()=>sP(await vP(i),o,a)),a.promise}(xm(n),t)}(function(t,e=!0){(function(o){qr=o})(v1),Io(new Di("firestore",(i,{instanceIdentifier:o,options:a})=>{const l=i.getProvider("app").getImmediate(),h=new us(new qR(i.getProvider("auth-internal")),new GR(i.getProvider("app-check-internal")),function(m,_){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new L(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $i(m.options.projectId,_)}(l,o),l);return a=Object.assign({useFetchStreams:e},a),h._setSettings(a),h},"PUBLIC").setMultipleInstances(!0)),Rr(bd,"4.3.2",t),Rr(bd,"4.3.2","esm2017")})();const zm=(n={})=>{n={collection:"",data:{},model:{id:!1,name:""},options:{},events:[],...n},n.data={...n.model};const t=UI(),e=RP(Rg(t.public.firebase)),i=pg({busy:!1,data:n.data,async create(){if(i.data.id||!1)return;const a=fg(e,n.collection),l=await GP(a,i.data);return i.data.id=l.id,i.eventDispatch("created"),i.eventDispatch("saved"),l},async update(){const o=i.data.id||!1;if(!o)return;const a=Pl(e,n.collection,o),l=await WP(a,i.data);return i.eventDispatch("updated"),i.eventDispatch("saved"),l},async save(){return i.data.id?i.update():i.create()},async delete(o={}){const a=o.id||!1;if(!a)return;const l=await zP(Pl(e,n.collection,a));return i.eventDispatch("deleted"),l},async setData(o){i.data={...n.model,...o}},async resetData(){i.data={...n.model}},async eventDispatch(o){i.events.forEach(([a,l])=>{a==o&&l()})},events:n.events,options:n.options,search:{busy:!1,params:{orderBy:"id",limit:25},data:[],pagination:{},async submit(){let o=[];const a=fg(e,n.collection),l=LP(a);(await $P(l)).forEach(d=>{o.push({...n.model,...d.data(),id:d.id})}),i.search.data=o}}});return i},HP=kt("div",{style:{width:"5px"}},null,-1),KP=kt("th",{style:{width:"50px"}},null,-1),QP=kt("th",null,"Name",-1),jP=kt("th",{style:{width:"50px"}},null,-1),YP=kt("td",null,null,-1),XP={class:"d-flex pe-2",style:{gap:"10px"}},JP={__name:"crud",props:{model:{type:String,default:""},tableRowActions:{type:Object,default:()=>({})}},setup(n){const t=n,e=(d={})=>({...d}),i=zm(iA[t.model]||{});i.events.push(["saved",()=>{i.resetData(),i.search.submit(),h.hide()}]),i.events.push(["deleted",()=>{i.resetData(),i.search.submit()}]),i.search.submit();const o={VBtn:{size:35,flat:!0}},a=mg.merge({delete:{title:"Delete",icon:"mdi-delete",color:"error",onClick:(d,m)=>{}},edit:{title:"Edit",icon:"mdi-pencil",color:"primary",onClick(d,m){i.setData({...m.item}),h.show()}}},t.tableRowActions),l=(d,m)=>{if(typeof d=="object"){for(let _ in d){const w=d[_];typeof w=="function"&&(d[_]=P=>w(P,m))}return d}},h=pg({visible:!1,show(){h.visible=!0},hide(){h.visible=!1}});return(d,m)=>(Ei(),po("div",null,[wt(HI,Ou({items:ke(i).search.data},ke(i).options.datatable),{top:Et(()=>[wt(BI,{flat:""},{append:Et(()=>[wt(pi,{icon:"mdi-plus",onClick:m[0]||(m[0]=_=>h.show())}),HP]),default:Et(()=>[wt(qI,null,{default:Et(()=>[ro(In(ke(i).options.plural),1)]),_:1})]),_:1})]),headers:Et(_=>[kt("tr",null,[KP,bu(d.$slots,"table-header",io(Nu(e(_))),()=>[QP]),jP])]),item:Et(_=>[kt("tr",null,[YP,bu(d.$slots,"table-row",io(Nu(e(_))),()=>[kt("td",null,In(_.item.name),1)]),kt("td",null,[wt(ad,{defaults:o},{default:Et(()=>[wt($I,{location:"start"},{activator:Et(w=>[wt(pi,Ou({icon:"mdi-dots-horizontal"},w.props),null,16)]),default:Et(()=>[wt(ad,{defaults:o},{default:Et(()=>[kt("div",XP,[(Ei(!0),po(ud,null,WI(ke(a),w=>(Ei(),po(ud,null,[w?(Ei(),zI(pi,io(Ou({key:0},l(w,_))),null,16)):GI("",!0)],64))),256))])]),_:2},1024)]),_:2},1024)]),_:2},1024)])])]),_:3},16,["items"]),wt(ZI,{modelValue:h.visible,"onUpdate:modelValue":m[4]||(m[4]=_=>h.visible=_),location:"end",width:"600"},{default:Et(()=>[wt(KI,{onSubmit:m[3]||(m[3]=QI(_=>ke(i).save(),["prevent"]))},{default:Et(()=>[wt(jI,null,{default:Et(()=>[ro(In(ke(i).data.id?"Edit":"Create")+" "+In(ke(i).options.singular),1)]),_:1}),wt(YI,null,{default:Et(()=>[bu(d.$slots,"form",io(Nu(e({model:ke(i)}))),()=>[wt(Xu,{label:"Name",modelValue:ke(i).data.name,"onUpdate:modelValue":m[1]||(m[1]=_=>ke(i).data.name=_)},null,8,["modelValue"])])]),_:3}),wt(XI,null,{default:Et(()=>[wt(pi,{onClick:m[2]||(m[2]=_=>{ke(i).resetData(),h.hide()})},{default:Et(()=>[ro("Close")]),_:1}),wt(JI),wt(pi,{type:"submit"},{default:Et(()=>[ro("Save")]),_:1})]),_:1})]),_:3})]),_:3},8,["modelValue"])]))}},ZP=kt("th",null,"Nome",-1),tV=kt("th",null,"Nome",-1),eV=kt("th",null,"Nível",-1),nV=kt("th",null,"Permissões",-1),aV={__name:"index",setup(n){const t=zm({collection:"test",model:{id:!1,name:"",level:"user",permissions:[]},events:[["saved",()=>{t.resetData(),t.search.submit()}],["deleted",()=>t.search.submit()]],options:{levels:[{value:"user",title:"User"},{value:"admin",title:"Admin"}],permissions:[{value:"posts:create",title:"Create Posts"},{value:"posts:update",title:"Update Posts"},{value:"posts:delete",title:"Delete Posts"}]}});return t.search.submit(),(e,i)=>{const o=JP;return Ei(),po("div",null,[wt(tA,null,{default:Et(()=>[wt(eA,null,{default:Et(()=>[wt(o,{model:"page",tableRowActions:{test:{title:"Edit",icon:"mdi-home"}}},{"table-header":Et(a=>[ZP]),"table-row":Et(a=>[kt("td",null,In(a.item.name),1)]),form:Et(a=>[wt(Xu,{label:"Title",modelValue:a.model.data.name,"onUpdate:modelValue":l=>a.model.data.name=l},null,8,["modelValue","onUpdate:modelValue"]),wt(Xu,{label:"Slug",modelValue:a.model.data.slug,"onUpdate:modelValue":l=>a.model.data.slug=l},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),wt(o,{model:"test",tableRowActions:{test:{title:"Edit",icon:"mdi-home",onClick(a,l,h){console.log({a,b:l,c:h})}}}},{"table-header":Et(a=>[tV,eV,nV]),"table-row":Et(a=>[kt("td",null,In(a.item.name),1),kt("td",null,In(a.item.level),1),kt("td",null,In(a.item.permissions.join(", ")),1)]),_:1},8,["tableRowActions"])]),_:1})]),_:1})])}}};export{aV as default};
