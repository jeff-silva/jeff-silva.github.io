import{O as gg,m as kI,t as eo,v as xu,z as Ut,A as Bt,P as FI,Q as gi,R as UI,B as no,y as ro,S as Le,x as Ge,T as bu,U as io,W as Nu,X as od,Y as BI,Z as Ou,$ as ad,a0 as qI,M as $I,a1 as WI,a2 as zI,a3 as GI,a4 as HI,a5 as KI,a6 as QI,N as jI,a7 as YI,a8 as XI,a9 as JI}from"./entry.22f4b26d.js";var pi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ZI(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var vo={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */vo.exports;(function(n,t){(function(){var e,i="4.17.21",o=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",m=500,_="__lodash_placeholder__",w=1,P=2,x=4,z=1,X=2,F=1,lt=2,bt=4,yt=8,Ht=16,Kt=32,ye=64,ve=128,nr=256,Gr=512,as=30,Wm="...",zm=800,Gm=16,Cc=1,Hm=2,Km=3,Nn=1/0,dn=9007199254740991,Qm=17976931348623157e292,us=0/0,qe=4294967295,jm=qe-1,Ym=qe>>>1,Xm=[["ary",ve],["bind",F],["bindKey",lt],["curry",yt],["curryRight",Ht],["flip",Gr],["partial",Kt],["partialRight",ye],["rearg",nr]],rr="[object Arguments]",ls="[object Array]",Jm="[object AsyncFunction]",Hr="[object Boolean]",Kr="[object Date]",Zm="[object DOMException]",cs="[object Error]",hs="[object Function]",Pc="[object GeneratorFunction]",De="[object Map]",Qr="[object Number]",t_="[object Null]",Je="[object Object]",Vc="[object Promise]",e_="[object Proxy]",jr="[object RegExp]",xe="[object Set]",Yr="[object String]",fs="[object Symbol]",n_="[object Undefined]",Xr="[object WeakMap]",r_="[object WeakSet]",Jr="[object ArrayBuffer]",ir="[object DataView]",ca="[object Float32Array]",ha="[object Float64Array]",fa="[object Int8Array]",da="[object Int16Array]",ga="[object Int32Array]",pa="[object Uint8Array]",ma="[object Uint8ClampedArray]",_a="[object Uint16Array]",ya="[object Uint32Array]",i_=/\b__p \+= '';/g,s_=/\b(__p \+=) '' \+/g,o_=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Dc=/&(?:amp|lt|gt|quot|#39);/g,xc=/[&<>"']/g,a_=RegExp(Dc.source),u_=RegExp(xc.source),l_=/<%-([\s\S]+?)%>/g,c_=/<%([\s\S]+?)%>/g,bc=/<%=([\s\S]+?)%>/g,h_=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,f_=/^\w*$/,d_=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,va=/[\\^$.*+?()[\]{}|]/g,g_=RegExp(va.source),Ea=/^\s+/,p_=/\s/,m_=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,__=/\{\n\/\* \[wrapped with (.+)\] \*/,y_=/,? & /,v_=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,E_=/[()=,{}\[\]\/\s]/,T_=/\\(\\)?/g,w_=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Nc=/\w*$/,I_=/^[-+]0x[0-9a-f]+$/i,A_=/^0b[01]+$/i,R_=/^\[object .+?Constructor\]$/,S_=/^0o[0-7]+$/i,C_=/^(?:0|[1-9]\d*)$/,P_=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ds=/($^)/,V_=/['\n\r\u2028\u2029\\]/g,gs="\\ud800-\\udfff",D_="\\u0300-\\u036f",x_="\\ufe20-\\ufe2f",b_="\\u20d0-\\u20ff",Oc=D_+x_+b_,Mc="\\u2700-\\u27bf",Lc="a-z\\xdf-\\xf6\\xf8-\\xff",N_="\\xac\\xb1\\xd7\\xf7",O_="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",M_="\\u2000-\\u206f",L_=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",kc="A-Z\\xc0-\\xd6\\xd8-\\xde",Fc="\\ufe0e\\ufe0f",Uc=N_+O_+M_+L_,Ta="['’]",k_="["+gs+"]",Bc="["+Uc+"]",ps="["+Oc+"]",qc="\\d+",F_="["+Mc+"]",$c="["+Lc+"]",Wc="[^"+gs+Uc+qc+Mc+Lc+kc+"]",wa="\\ud83c[\\udffb-\\udfff]",U_="(?:"+ps+"|"+wa+")",zc="[^"+gs+"]",Ia="(?:\\ud83c[\\udde6-\\uddff]){2}",Aa="[\\ud800-\\udbff][\\udc00-\\udfff]",sr="["+kc+"]",Gc="\\u200d",Hc="(?:"+$c+"|"+Wc+")",B_="(?:"+sr+"|"+Wc+")",Kc="(?:"+Ta+"(?:d|ll|m|re|s|t|ve))?",Qc="(?:"+Ta+"(?:D|LL|M|RE|S|T|VE))?",jc=U_+"?",Yc="["+Fc+"]?",q_="(?:"+Gc+"(?:"+[zc,Ia,Aa].join("|")+")"+Yc+jc+")*",$_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",W_="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Xc=Yc+jc+q_,z_="(?:"+[F_,Ia,Aa].join("|")+")"+Xc,G_="(?:"+[zc+ps+"?",ps,Ia,Aa,k_].join("|")+")",H_=RegExp(Ta,"g"),K_=RegExp(ps,"g"),Ra=RegExp(wa+"(?="+wa+")|"+G_+Xc,"g"),Q_=RegExp([sr+"?"+$c+"+"+Kc+"(?="+[Bc,sr,"$"].join("|")+")",B_+"+"+Qc+"(?="+[Bc,sr+Hc,"$"].join("|")+")",sr+"?"+Hc+"+"+Kc,sr+"+"+Qc,W_,$_,qc,z_].join("|"),"g"),j_=RegExp("["+Gc+gs+Oc+Fc+"]"),Y_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,X_=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],J_=-1,gt={};gt[ca]=gt[ha]=gt[fa]=gt[da]=gt[ga]=gt[pa]=gt[ma]=gt[_a]=gt[ya]=!0,gt[rr]=gt[ls]=gt[Jr]=gt[Hr]=gt[ir]=gt[Kr]=gt[cs]=gt[hs]=gt[De]=gt[Qr]=gt[Je]=gt[jr]=gt[xe]=gt[Yr]=gt[Xr]=!1;var dt={};dt[rr]=dt[ls]=dt[Jr]=dt[ir]=dt[Hr]=dt[Kr]=dt[ca]=dt[ha]=dt[fa]=dt[da]=dt[ga]=dt[De]=dt[Qr]=dt[Je]=dt[jr]=dt[xe]=dt[Yr]=dt[fs]=dt[pa]=dt[ma]=dt[_a]=dt[ya]=!0,dt[cs]=dt[hs]=dt[Xr]=!1;var Z_={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},ty={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ey={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ny={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ry=parseFloat,iy=parseInt,Jc=typeof pi=="object"&&pi&&pi.Object===Object&&pi,sy=typeof self=="object"&&self&&self.Object===Object&&self,kt=Jc||sy||Function("return this")(),Sa=t&&!t.nodeType&&t,On=Sa&&!0&&n&&!n.nodeType&&n,Zc=On&&On.exports===Sa,Ca=Zc&&Jc.process,Ee=function(){try{var E=On&&On.require&&On.require("util").types;return E||Ca&&Ca.binding&&Ca.binding("util")}catch{}}(),th=Ee&&Ee.isArrayBuffer,eh=Ee&&Ee.isDate,nh=Ee&&Ee.isMap,rh=Ee&&Ee.isRegExp,ih=Ee&&Ee.isSet,sh=Ee&&Ee.isTypedArray;function ce(E,A,I){switch(I.length){case 0:return E.call(A);case 1:return E.call(A,I[0]);case 2:return E.call(A,I[0],I[1]);case 3:return E.call(A,I[0],I[1],I[2])}return E.apply(A,I)}function oy(E,A,I,O){for(var H=-1,ot=E==null?0:E.length;++H<ot;){var Vt=E[H];A(O,Vt,I(Vt),E)}return O}function Te(E,A){for(var I=-1,O=E==null?0:E.length;++I<O&&A(E[I],I,E)!==!1;);return E}function ay(E,A){for(var I=E==null?0:E.length;I--&&A(E[I],I,E)!==!1;);return E}function oh(E,A){for(var I=-1,O=E==null?0:E.length;++I<O;)if(!A(E[I],I,E))return!1;return!0}function gn(E,A){for(var I=-1,O=E==null?0:E.length,H=0,ot=[];++I<O;){var Vt=E[I];A(Vt,I,E)&&(ot[H++]=Vt)}return ot}function ms(E,A){var I=E==null?0:E.length;return!!I&&or(E,A,0)>-1}function Pa(E,A,I){for(var O=-1,H=E==null?0:E.length;++O<H;)if(I(A,E[O]))return!0;return!1}function vt(E,A){for(var I=-1,O=E==null?0:E.length,H=Array(O);++I<O;)H[I]=A(E[I],I,E);return H}function pn(E,A){for(var I=-1,O=A.length,H=E.length;++I<O;)E[H+I]=A[I];return E}function Va(E,A,I,O){var H=-1,ot=E==null?0:E.length;for(O&&ot&&(I=E[++H]);++H<ot;)I=A(I,E[H],H,E);return I}function uy(E,A,I,O){var H=E==null?0:E.length;for(O&&H&&(I=E[--H]);H--;)I=A(I,E[H],H,E);return I}function Da(E,A){for(var I=-1,O=E==null?0:E.length;++I<O;)if(A(E[I],I,E))return!0;return!1}var ly=xa("length");function cy(E){return E.split("")}function hy(E){return E.match(v_)||[]}function ah(E,A,I){var O;return I(E,function(H,ot,Vt){if(A(H,ot,Vt))return O=ot,!1}),O}function _s(E,A,I,O){for(var H=E.length,ot=I+(O?1:-1);O?ot--:++ot<H;)if(A(E[ot],ot,E))return ot;return-1}function or(E,A,I){return A===A?Iy(E,A,I):_s(E,uh,I)}function fy(E,A,I,O){for(var H=I-1,ot=E.length;++H<ot;)if(O(E[H],A))return H;return-1}function uh(E){return E!==E}function lh(E,A){var I=E==null?0:E.length;return I?Na(E,A)/I:us}function xa(E){return function(A){return A==null?e:A[E]}}function ba(E){return function(A){return E==null?e:E[A]}}function ch(E,A,I,O,H){return H(E,function(ot,Vt,ft){I=O?(O=!1,ot):A(I,ot,Vt,ft)}),I}function dy(E,A){var I=E.length;for(E.sort(A);I--;)E[I]=E[I].value;return E}function Na(E,A){for(var I,O=-1,H=E.length;++O<H;){var ot=A(E[O]);ot!==e&&(I=I===e?ot:I+ot)}return I}function Oa(E,A){for(var I=-1,O=Array(E);++I<E;)O[I]=A(I);return O}function gy(E,A){return vt(A,function(I){return[I,E[I]]})}function hh(E){return E&&E.slice(0,ph(E)+1).replace(Ea,"")}function he(E){return function(A){return E(A)}}function Ma(E,A){return vt(A,function(I){return E[I]})}function Zr(E,A){return E.has(A)}function fh(E,A){for(var I=-1,O=E.length;++I<O&&or(A,E[I],0)>-1;);return I}function dh(E,A){for(var I=E.length;I--&&or(A,E[I],0)>-1;);return I}function py(E,A){for(var I=E.length,O=0;I--;)E[I]===A&&++O;return O}var my=ba(Z_),_y=ba(ty);function yy(E){return"\\"+ny[E]}function vy(E,A){return E==null?e:E[A]}function ar(E){return j_.test(E)}function Ey(E){return Y_.test(E)}function Ty(E){for(var A,I=[];!(A=E.next()).done;)I.push(A.value);return I}function La(E){var A=-1,I=Array(E.size);return E.forEach(function(O,H){I[++A]=[H,O]}),I}function gh(E,A){return function(I){return E(A(I))}}function mn(E,A){for(var I=-1,O=E.length,H=0,ot=[];++I<O;){var Vt=E[I];(Vt===A||Vt===_)&&(E[I]=_,ot[H++]=I)}return ot}function ys(E){var A=-1,I=Array(E.size);return E.forEach(function(O){I[++A]=O}),I}function wy(E){var A=-1,I=Array(E.size);return E.forEach(function(O){I[++A]=[O,O]}),I}function Iy(E,A,I){for(var O=I-1,H=E.length;++O<H;)if(E[O]===A)return O;return-1}function Ay(E,A,I){for(var O=I+1;O--;)if(E[O]===A)return O;return O}function ur(E){return ar(E)?Sy(E):ly(E)}function be(E){return ar(E)?Cy(E):cy(E)}function ph(E){for(var A=E.length;A--&&p_.test(E.charAt(A)););return A}var Ry=ba(ey);function Sy(E){for(var A=Ra.lastIndex=0;Ra.test(E);)++A;return A}function Cy(E){return E.match(Ra)||[]}function Py(E){return E.match(Q_)||[]}var Vy=function E(A){A=A==null?kt:lr.defaults(kt.Object(),A,lr.pick(kt,X_));var I=A.Array,O=A.Date,H=A.Error,ot=A.Function,Vt=A.Math,ft=A.Object,ka=A.RegExp,Dy=A.String,we=A.TypeError,vs=I.prototype,xy=ot.prototype,cr=ft.prototype,Es=A["__core-js_shared__"],Ts=xy.toString,ct=cr.hasOwnProperty,by=0,mh=function(){var r=/[^.]+$/.exec(Es&&Es.keys&&Es.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),ws=cr.toString,Ny=Ts.call(ft),Oy=kt._,My=ka("^"+Ts.call(ct).replace(va,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Is=Zc?A.Buffer:e,_n=A.Symbol,As=A.Uint8Array,_h=Is?Is.allocUnsafe:e,Rs=gh(ft.getPrototypeOf,ft),yh=ft.create,vh=cr.propertyIsEnumerable,Ss=vs.splice,Eh=_n?_n.isConcatSpreadable:e,ti=_n?_n.iterator:e,Mn=_n?_n.toStringTag:e,Cs=function(){try{var r=Bn(ft,"defineProperty");return r({},"",{}),r}catch{}}(),Ly=A.clearTimeout!==kt.clearTimeout&&A.clearTimeout,ky=O&&O.now!==kt.Date.now&&O.now,Fy=A.setTimeout!==kt.setTimeout&&A.setTimeout,Ps=Vt.ceil,Vs=Vt.floor,Fa=ft.getOwnPropertySymbols,Uy=Is?Is.isBuffer:e,Th=A.isFinite,By=vs.join,qy=gh(ft.keys,ft),Dt=Vt.max,Qt=Vt.min,$y=O.now,Wy=A.parseInt,wh=Vt.random,zy=vs.reverse,Ua=Bn(A,"DataView"),ei=Bn(A,"Map"),Ba=Bn(A,"Promise"),hr=Bn(A,"Set"),ni=Bn(A,"WeakMap"),ri=Bn(ft,"create"),Ds=ni&&new ni,fr={},Gy=qn(Ua),Hy=qn(ei),Ky=qn(Ba),Qy=qn(hr),jy=qn(ni),xs=_n?_n.prototype:e,ii=xs?xs.valueOf:e,Ih=xs?xs.toString:e;function g(r){if(wt(r)&&!Q(r)&&!(r instanceof et)){if(r instanceof Ie)return r;if(ct.call(r,"__wrapped__"))return Rf(r)}return new Ie(r)}var dr=function(){function r(){}return function(s){if(!Et(s))return{};if(yh)return yh(s);r.prototype=s;var u=new r;return r.prototype=e,u}}();function bs(){}function Ie(r,s){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=e}g.templateSettings={escape:l_,evaluate:c_,interpolate:bc,variable:"",imports:{_:g}},g.prototype=bs.prototype,g.prototype.constructor=g,Ie.prototype=dr(bs.prototype),Ie.prototype.constructor=Ie;function et(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=qe,this.__views__=[]}function Yy(){var r=new et(this.__wrapped__);return r.__actions__=oe(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=oe(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=oe(this.__views__),r}function Xy(){if(this.__filtered__){var r=new et(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function Jy(){var r=this.__wrapped__.value(),s=this.__dir__,u=Q(r),c=s<0,f=u?r.length:0,p=c0(0,f,this.__views__),y=p.start,v=p.end,T=v-y,R=c?v:y-1,S=this.__iteratees__,V=S.length,b=0,k=Qt(T,this.__takeCount__);if(!u||!c&&f==T&&k==T)return Kh(r,this.__actions__);var q=[];t:for(;T--&&b<k;){R+=s;for(var J=-1,$=r[R];++J<V;){var tt=S[J],rt=tt.iteratee,ge=tt.type,ie=rt($);if(ge==Hm)$=ie;else if(!ie){if(ge==Cc)continue t;break t}}q[b++]=$}return q}et.prototype=dr(bs.prototype),et.prototype.constructor=et;function Ln(r){var s=-1,u=r==null?0:r.length;for(this.clear();++s<u;){var c=r[s];this.set(c[0],c[1])}}function Zy(){this.__data__=ri?ri(null):{},this.size=0}function tv(r){var s=this.has(r)&&delete this.__data__[r];return this.size-=s?1:0,s}function ev(r){var s=this.__data__;if(ri){var u=s[r];return u===d?e:u}return ct.call(s,r)?s[r]:e}function nv(r){var s=this.__data__;return ri?s[r]!==e:ct.call(s,r)}function rv(r,s){var u=this.__data__;return this.size+=this.has(r)?0:1,u[r]=ri&&s===e?d:s,this}Ln.prototype.clear=Zy,Ln.prototype.delete=tv,Ln.prototype.get=ev,Ln.prototype.has=nv,Ln.prototype.set=rv;function Ze(r){var s=-1,u=r==null?0:r.length;for(this.clear();++s<u;){var c=r[s];this.set(c[0],c[1])}}function iv(){this.__data__=[],this.size=0}function sv(r){var s=this.__data__,u=Ns(s,r);if(u<0)return!1;var c=s.length-1;return u==c?s.pop():Ss.call(s,u,1),--this.size,!0}function ov(r){var s=this.__data__,u=Ns(s,r);return u<0?e:s[u][1]}function av(r){return Ns(this.__data__,r)>-1}function uv(r,s){var u=this.__data__,c=Ns(u,r);return c<0?(++this.size,u.push([r,s])):u[c][1]=s,this}Ze.prototype.clear=iv,Ze.prototype.delete=sv,Ze.prototype.get=ov,Ze.prototype.has=av,Ze.prototype.set=uv;function tn(r){var s=-1,u=r==null?0:r.length;for(this.clear();++s<u;){var c=r[s];this.set(c[0],c[1])}}function lv(){this.size=0,this.__data__={hash:new Ln,map:new(ei||Ze),string:new Ln}}function cv(r){var s=Gs(this,r).delete(r);return this.size-=s?1:0,s}function hv(r){return Gs(this,r).get(r)}function fv(r){return Gs(this,r).has(r)}function dv(r,s){var u=Gs(this,r),c=u.size;return u.set(r,s),this.size+=u.size==c?0:1,this}tn.prototype.clear=lv,tn.prototype.delete=cv,tn.prototype.get=hv,tn.prototype.has=fv,tn.prototype.set=dv;function kn(r){var s=-1,u=r==null?0:r.length;for(this.__data__=new tn;++s<u;)this.add(r[s])}function gv(r){return this.__data__.set(r,d),this}function pv(r){return this.__data__.has(r)}kn.prototype.add=kn.prototype.push=gv,kn.prototype.has=pv;function Ne(r){var s=this.__data__=new Ze(r);this.size=s.size}function mv(){this.__data__=new Ze,this.size=0}function _v(r){var s=this.__data__,u=s.delete(r);return this.size=s.size,u}function yv(r){return this.__data__.get(r)}function vv(r){return this.__data__.has(r)}function Ev(r,s){var u=this.__data__;if(u instanceof Ze){var c=u.__data__;if(!ei||c.length<o-1)return c.push([r,s]),this.size=++u.size,this;u=this.__data__=new tn(c)}return u.set(r,s),this.size=u.size,this}Ne.prototype.clear=mv,Ne.prototype.delete=_v,Ne.prototype.get=yv,Ne.prototype.has=vv,Ne.prototype.set=Ev;function Ah(r,s){var u=Q(r),c=!u&&$n(r),f=!u&&!c&&wn(r),p=!u&&!c&&!f&&_r(r),y=u||c||f||p,v=y?Oa(r.length,Dy):[],T=v.length;for(var R in r)(s||ct.call(r,R))&&!(y&&(R=="length"||f&&(R=="offset"||R=="parent")||p&&(R=="buffer"||R=="byteLength"||R=="byteOffset")||sn(R,T)))&&v.push(R);return v}function Rh(r){var s=r.length;return s?r[Xa(0,s-1)]:e}function Tv(r,s){return Hs(oe(r),Fn(s,0,r.length))}function wv(r){return Hs(oe(r))}function qa(r,s,u){(u!==e&&!Oe(r[s],u)||u===e&&!(s in r))&&en(r,s,u)}function si(r,s,u){var c=r[s];(!(ct.call(r,s)&&Oe(c,u))||u===e&&!(s in r))&&en(r,s,u)}function Ns(r,s){for(var u=r.length;u--;)if(Oe(r[u][0],s))return u;return-1}function Iv(r,s,u,c){return yn(r,function(f,p,y){s(c,f,u(f),y)}),c}function Sh(r,s){return r&&We(s,Nt(s),r)}function Av(r,s){return r&&We(s,ue(s),r)}function en(r,s,u){s=="__proto__"&&Cs?Cs(r,s,{configurable:!0,enumerable:!0,value:u,writable:!0}):r[s]=u}function $a(r,s){for(var u=-1,c=s.length,f=I(c),p=r==null;++u<c;)f[u]=p?e:wu(r,s[u]);return f}function Fn(r,s,u){return r===r&&(u!==e&&(r=r<=u?r:u),s!==e&&(r=r>=s?r:s)),r}function Ae(r,s,u,c,f,p){var y,v=s&w,T=s&P,R=s&x;if(u&&(y=f?u(r,c,f,p):u(r)),y!==e)return y;if(!Et(r))return r;var S=Q(r);if(S){if(y=f0(r),!v)return oe(r,y)}else{var V=jt(r),b=V==hs||V==Pc;if(wn(r))return Yh(r,v);if(V==Je||V==rr||b&&!f){if(y=T||b?{}:mf(r),!v)return T?e0(r,Av(y,r)):t0(r,Sh(y,r))}else{if(!dt[V])return f?r:{};y=d0(r,V,v)}}p||(p=new Ne);var k=p.get(r);if(k)return k;p.set(r,y),Gf(r)?r.forEach(function($){y.add(Ae($,s,u,$,r,p))}):Wf(r)&&r.forEach(function($,tt){y.set(tt,Ae($,s,u,tt,r,p))});var q=R?T?uu:au:T?ue:Nt,J=S?e:q(r);return Te(J||r,function($,tt){J&&(tt=$,$=r[tt]),si(y,tt,Ae($,s,u,tt,r,p))}),y}function Rv(r){var s=Nt(r);return function(u){return Ch(u,r,s)}}function Ch(r,s,u){var c=u.length;if(r==null)return!c;for(r=ft(r);c--;){var f=u[c],p=s[f],y=r[f];if(y===e&&!(f in r)||!p(y))return!1}return!0}function Ph(r,s,u){if(typeof r!="function")throw new we(l);return fi(function(){r.apply(e,u)},s)}function oi(r,s,u,c){var f=-1,p=ms,y=!0,v=r.length,T=[],R=s.length;if(!v)return T;u&&(s=vt(s,he(u))),c?(p=Pa,y=!1):s.length>=o&&(p=Zr,y=!1,s=new kn(s));t:for(;++f<v;){var S=r[f],V=u==null?S:u(S);if(S=c||S!==0?S:0,y&&V===V){for(var b=R;b--;)if(s[b]===V)continue t;T.push(S)}else p(s,V,c)||T.push(S)}return T}var yn=ef($e),Vh=ef(za,!0);function Sv(r,s){var u=!0;return yn(r,function(c,f,p){return u=!!s(c,f,p),u}),u}function Os(r,s,u){for(var c=-1,f=r.length;++c<f;){var p=r[c],y=s(p);if(y!=null&&(v===e?y===y&&!de(y):u(y,v)))var v=y,T=p}return T}function Cv(r,s,u,c){var f=r.length;for(u=Y(u),u<0&&(u=-u>f?0:f+u),c=c===e||c>f?f:Y(c),c<0&&(c+=f),c=u>c?0:Kf(c);u<c;)r[u++]=s;return r}function Dh(r,s){var u=[];return yn(r,function(c,f,p){s(c,f,p)&&u.push(c)}),u}function Ft(r,s,u,c,f){var p=-1,y=r.length;for(u||(u=p0),f||(f=[]);++p<y;){var v=r[p];s>0&&u(v)?s>1?Ft(v,s-1,u,c,f):pn(f,v):c||(f[f.length]=v)}return f}var Wa=nf(),xh=nf(!0);function $e(r,s){return r&&Wa(r,s,Nt)}function za(r,s){return r&&xh(r,s,Nt)}function Ms(r,s){return gn(s,function(u){return on(r[u])})}function Un(r,s){s=En(s,r);for(var u=0,c=s.length;r!=null&&u<c;)r=r[ze(s[u++])];return u&&u==c?r:e}function bh(r,s,u){var c=s(r);return Q(r)?c:pn(c,u(r))}function ne(r){return r==null?r===e?n_:t_:Mn&&Mn in ft(r)?l0(r):w0(r)}function Ga(r,s){return r>s}function Pv(r,s){return r!=null&&ct.call(r,s)}function Vv(r,s){return r!=null&&s in ft(r)}function Dv(r,s,u){return r>=Qt(s,u)&&r<Dt(s,u)}function Ha(r,s,u){for(var c=u?Pa:ms,f=r[0].length,p=r.length,y=p,v=I(p),T=1/0,R=[];y--;){var S=r[y];y&&s&&(S=vt(S,he(s))),T=Qt(S.length,T),v[y]=!u&&(s||f>=120&&S.length>=120)?new kn(y&&S):e}S=r[0];var V=-1,b=v[0];t:for(;++V<f&&R.length<T;){var k=S[V],q=s?s(k):k;if(k=u||k!==0?k:0,!(b?Zr(b,q):c(R,q,u))){for(y=p;--y;){var J=v[y];if(!(J?Zr(J,q):c(r[y],q,u)))continue t}b&&b.push(q),R.push(k)}}return R}function xv(r,s,u,c){return $e(r,function(f,p,y){s(c,u(f),p,y)}),c}function ai(r,s,u){s=En(s,r),r=Ef(r,s);var c=r==null?r:r[ze(Se(s))];return c==null?e:ce(c,r,u)}function Nh(r){return wt(r)&&ne(r)==rr}function bv(r){return wt(r)&&ne(r)==Jr}function Nv(r){return wt(r)&&ne(r)==Kr}function ui(r,s,u,c,f){return r===s?!0:r==null||s==null||!wt(r)&&!wt(s)?r!==r&&s!==s:Ov(r,s,u,c,ui,f)}function Ov(r,s,u,c,f,p){var y=Q(r),v=Q(s),T=y?ls:jt(r),R=v?ls:jt(s);T=T==rr?Je:T,R=R==rr?Je:R;var S=T==Je,V=R==Je,b=T==R;if(b&&wn(r)){if(!wn(s))return!1;y=!0,S=!1}if(b&&!S)return p||(p=new Ne),y||_r(r)?df(r,s,u,c,f,p):a0(r,s,T,u,c,f,p);if(!(u&z)){var k=S&&ct.call(r,"__wrapped__"),q=V&&ct.call(s,"__wrapped__");if(k||q){var J=k?r.value():r,$=q?s.value():s;return p||(p=new Ne),f(J,$,u,c,p)}}return b?(p||(p=new Ne),u0(r,s,u,c,f,p)):!1}function Mv(r){return wt(r)&&jt(r)==De}function Ka(r,s,u,c){var f=u.length,p=f,y=!c;if(r==null)return!p;for(r=ft(r);f--;){var v=u[f];if(y&&v[2]?v[1]!==r[v[0]]:!(v[0]in r))return!1}for(;++f<p;){v=u[f];var T=v[0],R=r[T],S=v[1];if(y&&v[2]){if(R===e&&!(T in r))return!1}else{var V=new Ne;if(c)var b=c(R,S,T,r,s,V);if(!(b===e?ui(S,R,z|X,c,V):b))return!1}}return!0}function Oh(r){if(!Et(r)||_0(r))return!1;var s=on(r)?My:R_;return s.test(qn(r))}function Lv(r){return wt(r)&&ne(r)==jr}function kv(r){return wt(r)&&jt(r)==xe}function Fv(r){return wt(r)&&Js(r.length)&&!!gt[ne(r)]}function Mh(r){return typeof r=="function"?r:r==null?le:typeof r=="object"?Q(r)?Fh(r[0],r[1]):kh(r):id(r)}function Qa(r){if(!hi(r))return qy(r);var s=[];for(var u in ft(r))ct.call(r,u)&&u!="constructor"&&s.push(u);return s}function Uv(r){if(!Et(r))return T0(r);var s=hi(r),u=[];for(var c in r)c=="constructor"&&(s||!ct.call(r,c))||u.push(c);return u}function ja(r,s){return r<s}function Lh(r,s){var u=-1,c=ae(r)?I(r.length):[];return yn(r,function(f,p,y){c[++u]=s(f,p,y)}),c}function kh(r){var s=cu(r);return s.length==1&&s[0][2]?yf(s[0][0],s[0][1]):function(u){return u===r||Ka(u,r,s)}}function Fh(r,s){return fu(r)&&_f(s)?yf(ze(r),s):function(u){var c=wu(u,r);return c===e&&c===s?Iu(u,r):ui(s,c,z|X)}}function Ls(r,s,u,c,f){r!==s&&Wa(s,function(p,y){if(f||(f=new Ne),Et(p))Bv(r,s,y,u,Ls,c,f);else{var v=c?c(gu(r,y),p,y+"",r,s,f):e;v===e&&(v=p),qa(r,y,v)}},ue)}function Bv(r,s,u,c,f,p,y){var v=gu(r,u),T=gu(s,u),R=y.get(T);if(R){qa(r,u,R);return}var S=p?p(v,T,u+"",r,s,y):e,V=S===e;if(V){var b=Q(T),k=!b&&wn(T),q=!b&&!k&&_r(T);S=T,b||k||q?Q(v)?S=v:At(v)?S=oe(v):k?(V=!1,S=Yh(T,!0)):q?(V=!1,S=Xh(T,!0)):S=[]:di(T)||$n(T)?(S=v,$n(v)?S=Qf(v):(!Et(v)||on(v))&&(S=mf(T))):V=!1}V&&(y.set(T,S),f(S,T,c,p,y),y.delete(T)),qa(r,u,S)}function Uh(r,s){var u=r.length;if(u)return s+=s<0?u:0,sn(s,u)?r[s]:e}function Bh(r,s,u){s.length?s=vt(s,function(p){return Q(p)?function(y){return Un(y,p.length===1?p[0]:p)}:p}):s=[le];var c=-1;s=vt(s,he(B()));var f=Lh(r,function(p,y,v){var T=vt(s,function(R){return R(p)});return{criteria:T,index:++c,value:p}});return dy(f,function(p,y){return Zv(p,y,u)})}function qv(r,s){return qh(r,s,function(u,c){return Iu(r,c)})}function qh(r,s,u){for(var c=-1,f=s.length,p={};++c<f;){var y=s[c],v=Un(r,y);u(v,y)&&li(p,En(y,r),v)}return p}function $v(r){return function(s){return Un(s,r)}}function Ya(r,s,u,c){var f=c?fy:or,p=-1,y=s.length,v=r;for(r===s&&(s=oe(s)),u&&(v=vt(r,he(u)));++p<y;)for(var T=0,R=s[p],S=u?u(R):R;(T=f(v,S,T,c))>-1;)v!==r&&Ss.call(v,T,1),Ss.call(r,T,1);return r}function $h(r,s){for(var u=r?s.length:0,c=u-1;u--;){var f=s[u];if(u==c||f!==p){var p=f;sn(f)?Ss.call(r,f,1):tu(r,f)}}return r}function Xa(r,s){return r+Vs(wh()*(s-r+1))}function Wv(r,s,u,c){for(var f=-1,p=Dt(Ps((s-r)/(u||1)),0),y=I(p);p--;)y[c?p:++f]=r,r+=u;return y}function Ja(r,s){var u="";if(!r||s<1||s>dn)return u;do s%2&&(u+=r),s=Vs(s/2),s&&(r+=r);while(s);return u}function Z(r,s){return pu(vf(r,s,le),r+"")}function zv(r){return Rh(yr(r))}function Gv(r,s){var u=yr(r);return Hs(u,Fn(s,0,u.length))}function li(r,s,u,c){if(!Et(r))return r;s=En(s,r);for(var f=-1,p=s.length,y=p-1,v=r;v!=null&&++f<p;){var T=ze(s[f]),R=u;if(T==="__proto__"||T==="constructor"||T==="prototype")return r;if(f!=y){var S=v[T];R=c?c(S,T,v):e,R===e&&(R=Et(S)?S:sn(s[f+1])?[]:{})}si(v,T,R),v=v[T]}return r}var Wh=Ds?function(r,s){return Ds.set(r,s),r}:le,Hv=Cs?function(r,s){return Cs(r,"toString",{configurable:!0,enumerable:!1,value:Ru(s),writable:!0})}:le;function Kv(r){return Hs(yr(r))}function Re(r,s,u){var c=-1,f=r.length;s<0&&(s=-s>f?0:f+s),u=u>f?f:u,u<0&&(u+=f),f=s>u?0:u-s>>>0,s>>>=0;for(var p=I(f);++c<f;)p[c]=r[c+s];return p}function Qv(r,s){var u;return yn(r,function(c,f,p){return u=s(c,f,p),!u}),!!u}function ks(r,s,u){var c=0,f=r==null?c:r.length;if(typeof s=="number"&&s===s&&f<=Ym){for(;c<f;){var p=c+f>>>1,y=r[p];y!==null&&!de(y)&&(u?y<=s:y<s)?c=p+1:f=p}return f}return Za(r,s,le,u)}function Za(r,s,u,c){var f=0,p=r==null?0:r.length;if(p===0)return 0;s=u(s);for(var y=s!==s,v=s===null,T=de(s),R=s===e;f<p;){var S=Vs((f+p)/2),V=u(r[S]),b=V!==e,k=V===null,q=V===V,J=de(V);if(y)var $=c||q;else R?$=q&&(c||b):v?$=q&&b&&(c||!k):T?$=q&&b&&!k&&(c||!J):k||J?$=!1:$=c?V<=s:V<s;$?f=S+1:p=S}return Qt(p,jm)}function zh(r,s){for(var u=-1,c=r.length,f=0,p=[];++u<c;){var y=r[u],v=s?s(y):y;if(!u||!Oe(v,T)){var T=v;p[f++]=y===0?0:y}}return p}function Gh(r){return typeof r=="number"?r:de(r)?us:+r}function fe(r){if(typeof r=="string")return r;if(Q(r))return vt(r,fe)+"";if(de(r))return Ih?Ih.call(r):"";var s=r+"";return s=="0"&&1/r==-Nn?"-0":s}function vn(r,s,u){var c=-1,f=ms,p=r.length,y=!0,v=[],T=v;if(u)y=!1,f=Pa;else if(p>=o){var R=s?null:s0(r);if(R)return ys(R);y=!1,f=Zr,T=new kn}else T=s?[]:v;t:for(;++c<p;){var S=r[c],V=s?s(S):S;if(S=u||S!==0?S:0,y&&V===V){for(var b=T.length;b--;)if(T[b]===V)continue t;s&&T.push(V),v.push(S)}else f(T,V,u)||(T!==v&&T.push(V),v.push(S))}return v}function tu(r,s){return s=En(s,r),r=Ef(r,s),r==null||delete r[ze(Se(s))]}function Hh(r,s,u,c){return li(r,s,u(Un(r,s)),c)}function Fs(r,s,u,c){for(var f=r.length,p=c?f:-1;(c?p--:++p<f)&&s(r[p],p,r););return u?Re(r,c?0:p,c?p+1:f):Re(r,c?p+1:0,c?f:p)}function Kh(r,s){var u=r;return u instanceof et&&(u=u.value()),Va(s,function(c,f){return f.func.apply(f.thisArg,pn([c],f.args))},u)}function eu(r,s,u){var c=r.length;if(c<2)return c?vn(r[0]):[];for(var f=-1,p=I(c);++f<c;)for(var y=r[f],v=-1;++v<c;)v!=f&&(p[f]=oi(p[f]||y,r[v],s,u));return vn(Ft(p,1),s,u)}function Qh(r,s,u){for(var c=-1,f=r.length,p=s.length,y={};++c<f;){var v=c<p?s[c]:e;u(y,r[c],v)}return y}function nu(r){return At(r)?r:[]}function ru(r){return typeof r=="function"?r:le}function En(r,s){return Q(r)?r:fu(r,s)?[r]:Af(ut(r))}var jv=Z;function Tn(r,s,u){var c=r.length;return u=u===e?c:u,!s&&u>=c?r:Re(r,s,u)}var jh=Ly||function(r){return kt.clearTimeout(r)};function Yh(r,s){if(s)return r.slice();var u=r.length,c=_h?_h(u):new r.constructor(u);return r.copy(c),c}function iu(r){var s=new r.constructor(r.byteLength);return new As(s).set(new As(r)),s}function Yv(r,s){var u=s?iu(r.buffer):r.buffer;return new r.constructor(u,r.byteOffset,r.byteLength)}function Xv(r){var s=new r.constructor(r.source,Nc.exec(r));return s.lastIndex=r.lastIndex,s}function Jv(r){return ii?ft(ii.call(r)):{}}function Xh(r,s){var u=s?iu(r.buffer):r.buffer;return new r.constructor(u,r.byteOffset,r.length)}function Jh(r,s){if(r!==s){var u=r!==e,c=r===null,f=r===r,p=de(r),y=s!==e,v=s===null,T=s===s,R=de(s);if(!v&&!R&&!p&&r>s||p&&y&&T&&!v&&!R||c&&y&&T||!u&&T||!f)return 1;if(!c&&!p&&!R&&r<s||R&&u&&f&&!c&&!p||v&&u&&f||!y&&f||!T)return-1}return 0}function Zv(r,s,u){for(var c=-1,f=r.criteria,p=s.criteria,y=f.length,v=u.length;++c<y;){var T=Jh(f[c],p[c]);if(T){if(c>=v)return T;var R=u[c];return T*(R=="desc"?-1:1)}}return r.index-s.index}function Zh(r,s,u,c){for(var f=-1,p=r.length,y=u.length,v=-1,T=s.length,R=Dt(p-y,0),S=I(T+R),V=!c;++v<T;)S[v]=s[v];for(;++f<y;)(V||f<p)&&(S[u[f]]=r[f]);for(;R--;)S[v++]=r[f++];return S}function tf(r,s,u,c){for(var f=-1,p=r.length,y=-1,v=u.length,T=-1,R=s.length,S=Dt(p-v,0),V=I(S+R),b=!c;++f<S;)V[f]=r[f];for(var k=f;++T<R;)V[k+T]=s[T];for(;++y<v;)(b||f<p)&&(V[k+u[y]]=r[f++]);return V}function oe(r,s){var u=-1,c=r.length;for(s||(s=I(c));++u<c;)s[u]=r[u];return s}function We(r,s,u,c){var f=!u;u||(u={});for(var p=-1,y=s.length;++p<y;){var v=s[p],T=c?c(u[v],r[v],v,u,r):e;T===e&&(T=r[v]),f?en(u,v,T):si(u,v,T)}return u}function t0(r,s){return We(r,hu(r),s)}function e0(r,s){return We(r,gf(r),s)}function Us(r,s){return function(u,c){var f=Q(u)?oy:Iv,p=s?s():{};return f(u,r,B(c,2),p)}}function gr(r){return Z(function(s,u){var c=-1,f=u.length,p=f>1?u[f-1]:e,y=f>2?u[2]:e;for(p=r.length>3&&typeof p=="function"?(f--,p):e,y&&re(u[0],u[1],y)&&(p=f<3?e:p,f=1),s=ft(s);++c<f;){var v=u[c];v&&r(s,v,c,p)}return s})}function ef(r,s){return function(u,c){if(u==null)return u;if(!ae(u))return r(u,c);for(var f=u.length,p=s?f:-1,y=ft(u);(s?p--:++p<f)&&c(y[p],p,y)!==!1;);return u}}function nf(r){return function(s,u,c){for(var f=-1,p=ft(s),y=c(s),v=y.length;v--;){var T=y[r?v:++f];if(u(p[T],T,p)===!1)break}return s}}function n0(r,s,u){var c=s&F,f=ci(r);function p(){var y=this&&this!==kt&&this instanceof p?f:r;return y.apply(c?u:this,arguments)}return p}function rf(r){return function(s){s=ut(s);var u=ar(s)?be(s):e,c=u?u[0]:s.charAt(0),f=u?Tn(u,1).join(""):s.slice(1);return c[r]()+f}}function pr(r){return function(s){return Va(nd(ed(s).replace(H_,"")),r,"")}}function ci(r){return function(){var s=arguments;switch(s.length){case 0:return new r;case 1:return new r(s[0]);case 2:return new r(s[0],s[1]);case 3:return new r(s[0],s[1],s[2]);case 4:return new r(s[0],s[1],s[2],s[3]);case 5:return new r(s[0],s[1],s[2],s[3],s[4]);case 6:return new r(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new r(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var u=dr(r.prototype),c=r.apply(u,s);return Et(c)?c:u}}function r0(r,s,u){var c=ci(r);function f(){for(var p=arguments.length,y=I(p),v=p,T=mr(f);v--;)y[v]=arguments[v];var R=p<3&&y[0]!==T&&y[p-1]!==T?[]:mn(y,T);if(p-=R.length,p<u)return lf(r,s,Bs,f.placeholder,e,y,R,e,e,u-p);var S=this&&this!==kt&&this instanceof f?c:r;return ce(S,this,y)}return f}function sf(r){return function(s,u,c){var f=ft(s);if(!ae(s)){var p=B(u,3);s=Nt(s),u=function(v){return p(f[v],v,f)}}var y=r(s,u,c);return y>-1?f[p?s[y]:y]:e}}function of(r){return rn(function(s){var u=s.length,c=u,f=Ie.prototype.thru;for(r&&s.reverse();c--;){var p=s[c];if(typeof p!="function")throw new we(l);if(f&&!y&&zs(p)=="wrapper")var y=new Ie([],!0)}for(c=y?c:u;++c<u;){p=s[c];var v=zs(p),T=v=="wrapper"?lu(p):e;T&&du(T[0])&&T[1]==(ve|yt|Kt|nr)&&!T[4].length&&T[9]==1?y=y[zs(T[0])].apply(y,T[3]):y=p.length==1&&du(p)?y[v]():y.thru(p)}return function(){var R=arguments,S=R[0];if(y&&R.length==1&&Q(S))return y.plant(S).value();for(var V=0,b=u?s[V].apply(this,R):S;++V<u;)b=s[V].call(this,b);return b}})}function Bs(r,s,u,c,f,p,y,v,T,R){var S=s&ve,V=s&F,b=s&lt,k=s&(yt|Ht),q=s&Gr,J=b?e:ci(r);function $(){for(var tt=arguments.length,rt=I(tt),ge=tt;ge--;)rt[ge]=arguments[ge];if(k)var ie=mr($),pe=py(rt,ie);if(c&&(rt=Zh(rt,c,f,k)),p&&(rt=tf(rt,p,y,k)),tt-=pe,k&&tt<R){var Rt=mn(rt,ie);return lf(r,s,Bs,$.placeholder,u,rt,Rt,v,T,R-tt)}var Me=V?u:this,un=b?Me[r]:r;return tt=rt.length,v?rt=I0(rt,v):q&&tt>1&&rt.reverse(),S&&T<tt&&(rt.length=T),this&&this!==kt&&this instanceof $&&(un=J||ci(un)),un.apply(Me,rt)}return $}function af(r,s){return function(u,c){return xv(u,r,s(c),{})}}function qs(r,s){return function(u,c){var f;if(u===e&&c===e)return s;if(u!==e&&(f=u),c!==e){if(f===e)return c;typeof u=="string"||typeof c=="string"?(u=fe(u),c=fe(c)):(u=Gh(u),c=Gh(c)),f=r(u,c)}return f}}function su(r){return rn(function(s){return s=vt(s,he(B())),Z(function(u){var c=this;return r(s,function(f){return ce(f,c,u)})})})}function $s(r,s){s=s===e?" ":fe(s);var u=s.length;if(u<2)return u?Ja(s,r):s;var c=Ja(s,Ps(r/ur(s)));return ar(s)?Tn(be(c),0,r).join(""):c.slice(0,r)}function i0(r,s,u,c){var f=s&F,p=ci(r);function y(){for(var v=-1,T=arguments.length,R=-1,S=c.length,V=I(S+T),b=this&&this!==kt&&this instanceof y?p:r;++R<S;)V[R]=c[R];for(;T--;)V[R++]=arguments[++v];return ce(b,f?u:this,V)}return y}function uf(r){return function(s,u,c){return c&&typeof c!="number"&&re(s,u,c)&&(u=c=e),s=an(s),u===e?(u=s,s=0):u=an(u),c=c===e?s<u?1:-1:an(c),Wv(s,u,c,r)}}function Ws(r){return function(s,u){return typeof s=="string"&&typeof u=="string"||(s=Ce(s),u=Ce(u)),r(s,u)}}function lf(r,s,u,c,f,p,y,v,T,R){var S=s&yt,V=S?y:e,b=S?e:y,k=S?p:e,q=S?e:p;s|=S?Kt:ye,s&=~(S?ye:Kt),s&bt||(s&=~(F|lt));var J=[r,s,f,k,V,q,b,v,T,R],$=u.apply(e,J);return du(r)&&Tf($,J),$.placeholder=c,wf($,r,s)}function ou(r){var s=Vt[r];return function(u,c){if(u=Ce(u),c=c==null?0:Qt(Y(c),292),c&&Th(u)){var f=(ut(u)+"e").split("e"),p=s(f[0]+"e"+(+f[1]+c));return f=(ut(p)+"e").split("e"),+(f[0]+"e"+(+f[1]-c))}return s(u)}}var s0=hr&&1/ys(new hr([,-0]))[1]==Nn?function(r){return new hr(r)}:Pu;function cf(r){return function(s){var u=jt(s);return u==De?La(s):u==xe?wy(s):gy(s,r(s))}}function nn(r,s,u,c,f,p,y,v){var T=s&lt;if(!T&&typeof r!="function")throw new we(l);var R=c?c.length:0;if(R||(s&=~(Kt|ye),c=f=e),y=y===e?y:Dt(Y(y),0),v=v===e?v:Y(v),R-=f?f.length:0,s&ye){var S=c,V=f;c=f=e}var b=T?e:lu(r),k=[r,s,u,c,f,S,V,p,y,v];if(b&&E0(k,b),r=k[0],s=k[1],u=k[2],c=k[3],f=k[4],v=k[9]=k[9]===e?T?0:r.length:Dt(k[9]-R,0),!v&&s&(yt|Ht)&&(s&=~(yt|Ht)),!s||s==F)var q=n0(r,s,u);else s==yt||s==Ht?q=r0(r,s,v):(s==Kt||s==(F|Kt))&&!f.length?q=i0(r,s,u,c):q=Bs.apply(e,k);var J=b?Wh:Tf;return wf(J(q,k),r,s)}function hf(r,s,u,c){return r===e||Oe(r,cr[u])&&!ct.call(c,u)?s:r}function ff(r,s,u,c,f,p){return Et(r)&&Et(s)&&(p.set(s,r),Ls(r,s,e,ff,p),p.delete(s)),r}function o0(r){return di(r)?e:r}function df(r,s,u,c,f,p){var y=u&z,v=r.length,T=s.length;if(v!=T&&!(y&&T>v))return!1;var R=p.get(r),S=p.get(s);if(R&&S)return R==s&&S==r;var V=-1,b=!0,k=u&X?new kn:e;for(p.set(r,s),p.set(s,r);++V<v;){var q=r[V],J=s[V];if(c)var $=y?c(J,q,V,s,r,p):c(q,J,V,r,s,p);if($!==e){if($)continue;b=!1;break}if(k){if(!Da(s,function(tt,rt){if(!Zr(k,rt)&&(q===tt||f(q,tt,u,c,p)))return k.push(rt)})){b=!1;break}}else if(!(q===J||f(q,J,u,c,p))){b=!1;break}}return p.delete(r),p.delete(s),b}function a0(r,s,u,c,f,p,y){switch(u){case ir:if(r.byteLength!=s.byteLength||r.byteOffset!=s.byteOffset)return!1;r=r.buffer,s=s.buffer;case Jr:return!(r.byteLength!=s.byteLength||!p(new As(r),new As(s)));case Hr:case Kr:case Qr:return Oe(+r,+s);case cs:return r.name==s.name&&r.message==s.message;case jr:case Yr:return r==s+"";case De:var v=La;case xe:var T=c&z;if(v||(v=ys),r.size!=s.size&&!T)return!1;var R=y.get(r);if(R)return R==s;c|=X,y.set(r,s);var S=df(v(r),v(s),c,f,p,y);return y.delete(r),S;case fs:if(ii)return ii.call(r)==ii.call(s)}return!1}function u0(r,s,u,c,f,p){var y=u&z,v=au(r),T=v.length,R=au(s),S=R.length;if(T!=S&&!y)return!1;for(var V=T;V--;){var b=v[V];if(!(y?b in s:ct.call(s,b)))return!1}var k=p.get(r),q=p.get(s);if(k&&q)return k==s&&q==r;var J=!0;p.set(r,s),p.set(s,r);for(var $=y;++V<T;){b=v[V];var tt=r[b],rt=s[b];if(c)var ge=y?c(rt,tt,b,s,r,p):c(tt,rt,b,r,s,p);if(!(ge===e?tt===rt||f(tt,rt,u,c,p):ge)){J=!1;break}$||($=b=="constructor")}if(J&&!$){var ie=r.constructor,pe=s.constructor;ie!=pe&&"constructor"in r&&"constructor"in s&&!(typeof ie=="function"&&ie instanceof ie&&typeof pe=="function"&&pe instanceof pe)&&(J=!1)}return p.delete(r),p.delete(s),J}function rn(r){return pu(vf(r,e,Pf),r+"")}function au(r){return bh(r,Nt,hu)}function uu(r){return bh(r,ue,gf)}var lu=Ds?function(r){return Ds.get(r)}:Pu;function zs(r){for(var s=r.name+"",u=fr[s],c=ct.call(fr,s)?u.length:0;c--;){var f=u[c],p=f.func;if(p==null||p==r)return f.name}return s}function mr(r){var s=ct.call(g,"placeholder")?g:r;return s.placeholder}function B(){var r=g.iteratee||Su;return r=r===Su?Mh:r,arguments.length?r(arguments[0],arguments[1]):r}function Gs(r,s){var u=r.__data__;return m0(s)?u[typeof s=="string"?"string":"hash"]:u.map}function cu(r){for(var s=Nt(r),u=s.length;u--;){var c=s[u],f=r[c];s[u]=[c,f,_f(f)]}return s}function Bn(r,s){var u=vy(r,s);return Oh(u)?u:e}function l0(r){var s=ct.call(r,Mn),u=r[Mn];try{r[Mn]=e;var c=!0}catch{}var f=ws.call(r);return c&&(s?r[Mn]=u:delete r[Mn]),f}var hu=Fa?function(r){return r==null?[]:(r=ft(r),gn(Fa(r),function(s){return vh.call(r,s)}))}:Vu,gf=Fa?function(r){for(var s=[];r;)pn(s,hu(r)),r=Rs(r);return s}:Vu,jt=ne;(Ua&&jt(new Ua(new ArrayBuffer(1)))!=ir||ei&&jt(new ei)!=De||Ba&&jt(Ba.resolve())!=Vc||hr&&jt(new hr)!=xe||ni&&jt(new ni)!=Xr)&&(jt=function(r){var s=ne(r),u=s==Je?r.constructor:e,c=u?qn(u):"";if(c)switch(c){case Gy:return ir;case Hy:return De;case Ky:return Vc;case Qy:return xe;case jy:return Xr}return s});function c0(r,s,u){for(var c=-1,f=u.length;++c<f;){var p=u[c],y=p.size;switch(p.type){case"drop":r+=y;break;case"dropRight":s-=y;break;case"take":s=Qt(s,r+y);break;case"takeRight":r=Dt(r,s-y);break}}return{start:r,end:s}}function h0(r){var s=r.match(__);return s?s[1].split(y_):[]}function pf(r,s,u){s=En(s,r);for(var c=-1,f=s.length,p=!1;++c<f;){var y=ze(s[c]);if(!(p=r!=null&&u(r,y)))break;r=r[y]}return p||++c!=f?p:(f=r==null?0:r.length,!!f&&Js(f)&&sn(y,f)&&(Q(r)||$n(r)))}function f0(r){var s=r.length,u=new r.constructor(s);return s&&typeof r[0]=="string"&&ct.call(r,"index")&&(u.index=r.index,u.input=r.input),u}function mf(r){return typeof r.constructor=="function"&&!hi(r)?dr(Rs(r)):{}}function d0(r,s,u){var c=r.constructor;switch(s){case Jr:return iu(r);case Hr:case Kr:return new c(+r);case ir:return Yv(r,u);case ca:case ha:case fa:case da:case ga:case pa:case ma:case _a:case ya:return Xh(r,u);case De:return new c;case Qr:case Yr:return new c(r);case jr:return Xv(r);case xe:return new c;case fs:return Jv(r)}}function g0(r,s){var u=s.length;if(!u)return r;var c=u-1;return s[c]=(u>1?"& ":"")+s[c],s=s.join(u>2?", ":" "),r.replace(m_,`{
/* [wrapped with `+s+`] */
`)}function p0(r){return Q(r)||$n(r)||!!(Eh&&r&&r[Eh])}function sn(r,s){var u=typeof r;return s=s??dn,!!s&&(u=="number"||u!="symbol"&&C_.test(r))&&r>-1&&r%1==0&&r<s}function re(r,s,u){if(!Et(u))return!1;var c=typeof s;return(c=="number"?ae(u)&&sn(s,u.length):c=="string"&&s in u)?Oe(u[s],r):!1}function fu(r,s){if(Q(r))return!1;var u=typeof r;return u=="number"||u=="symbol"||u=="boolean"||r==null||de(r)?!0:f_.test(r)||!h_.test(r)||s!=null&&r in ft(s)}function m0(r){var s=typeof r;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?r!=="__proto__":r===null}function du(r){var s=zs(r),u=g[s];if(typeof u!="function"||!(s in et.prototype))return!1;if(r===u)return!0;var c=lu(u);return!!c&&r===c[0]}function _0(r){return!!mh&&mh in r}var y0=Es?on:Du;function hi(r){var s=r&&r.constructor,u=typeof s=="function"&&s.prototype||cr;return r===u}function _f(r){return r===r&&!Et(r)}function yf(r,s){return function(u){return u==null?!1:u[r]===s&&(s!==e||r in ft(u))}}function v0(r){var s=Ys(r,function(c){return u.size===m&&u.clear(),c}),u=s.cache;return s}function E0(r,s){var u=r[1],c=s[1],f=u|c,p=f<(F|lt|ve),y=c==ve&&u==yt||c==ve&&u==nr&&r[7].length<=s[8]||c==(ve|nr)&&s[7].length<=s[8]&&u==yt;if(!(p||y))return r;c&F&&(r[2]=s[2],f|=u&F?0:bt);var v=s[3];if(v){var T=r[3];r[3]=T?Zh(T,v,s[4]):v,r[4]=T?mn(r[3],_):s[4]}return v=s[5],v&&(T=r[5],r[5]=T?tf(T,v,s[6]):v,r[6]=T?mn(r[5],_):s[6]),v=s[7],v&&(r[7]=v),c&ve&&(r[8]=r[8]==null?s[8]:Qt(r[8],s[8])),r[9]==null&&(r[9]=s[9]),r[0]=s[0],r[1]=f,r}function T0(r){var s=[];if(r!=null)for(var u in ft(r))s.push(u);return s}function w0(r){return ws.call(r)}function vf(r,s,u){return s=Dt(s===e?r.length-1:s,0),function(){for(var c=arguments,f=-1,p=Dt(c.length-s,0),y=I(p);++f<p;)y[f]=c[s+f];f=-1;for(var v=I(s+1);++f<s;)v[f]=c[f];return v[s]=u(y),ce(r,this,v)}}function Ef(r,s){return s.length<2?r:Un(r,Re(s,0,-1))}function I0(r,s){for(var u=r.length,c=Qt(s.length,u),f=oe(r);c--;){var p=s[c];r[c]=sn(p,u)?f[p]:e}return r}function gu(r,s){if(!(s==="constructor"&&typeof r[s]=="function")&&s!="__proto__")return r[s]}var Tf=If(Wh),fi=Fy||function(r,s){return kt.setTimeout(r,s)},pu=If(Hv);function wf(r,s,u){var c=s+"";return pu(r,g0(c,A0(h0(c),u)))}function If(r){var s=0,u=0;return function(){var c=$y(),f=Gm-(c-u);if(u=c,f>0){if(++s>=zm)return arguments[0]}else s=0;return r.apply(e,arguments)}}function Hs(r,s){var u=-1,c=r.length,f=c-1;for(s=s===e?c:s;++u<s;){var p=Xa(u,f),y=r[p];r[p]=r[u],r[u]=y}return r.length=s,r}var Af=v0(function(r){var s=[];return r.charCodeAt(0)===46&&s.push(""),r.replace(d_,function(u,c,f,p){s.push(f?p.replace(T_,"$1"):c||u)}),s});function ze(r){if(typeof r=="string"||de(r))return r;var s=r+"";return s=="0"&&1/r==-Nn?"-0":s}function qn(r){if(r!=null){try{return Ts.call(r)}catch{}try{return r+""}catch{}}return""}function A0(r,s){return Te(Xm,function(u){var c="_."+u[0];s&u[1]&&!ms(r,c)&&r.push(c)}),r.sort()}function Rf(r){if(r instanceof et)return r.clone();var s=new Ie(r.__wrapped__,r.__chain__);return s.__actions__=oe(r.__actions__),s.__index__=r.__index__,s.__values__=r.__values__,s}function R0(r,s,u){(u?re(r,s,u):s===e)?s=1:s=Dt(Y(s),0);var c=r==null?0:r.length;if(!c||s<1)return[];for(var f=0,p=0,y=I(Ps(c/s));f<c;)y[p++]=Re(r,f,f+=s);return y}function S0(r){for(var s=-1,u=r==null?0:r.length,c=0,f=[];++s<u;){var p=r[s];p&&(f[c++]=p)}return f}function C0(){var r=arguments.length;if(!r)return[];for(var s=I(r-1),u=arguments[0],c=r;c--;)s[c-1]=arguments[c];return pn(Q(u)?oe(u):[u],Ft(s,1))}var P0=Z(function(r,s){return At(r)?oi(r,Ft(s,1,At,!0)):[]}),V0=Z(function(r,s){var u=Se(s);return At(u)&&(u=e),At(r)?oi(r,Ft(s,1,At,!0),B(u,2)):[]}),D0=Z(function(r,s){var u=Se(s);return At(u)&&(u=e),At(r)?oi(r,Ft(s,1,At,!0),e,u):[]});function x0(r,s,u){var c=r==null?0:r.length;return c?(s=u||s===e?1:Y(s),Re(r,s<0?0:s,c)):[]}function b0(r,s,u){var c=r==null?0:r.length;return c?(s=u||s===e?1:Y(s),s=c-s,Re(r,0,s<0?0:s)):[]}function N0(r,s){return r&&r.length?Fs(r,B(s,3),!0,!0):[]}function O0(r,s){return r&&r.length?Fs(r,B(s,3),!0):[]}function M0(r,s,u,c){var f=r==null?0:r.length;return f?(u&&typeof u!="number"&&re(r,s,u)&&(u=0,c=f),Cv(r,s,u,c)):[]}function Sf(r,s,u){var c=r==null?0:r.length;if(!c)return-1;var f=u==null?0:Y(u);return f<0&&(f=Dt(c+f,0)),_s(r,B(s,3),f)}function Cf(r,s,u){var c=r==null?0:r.length;if(!c)return-1;var f=c-1;return u!==e&&(f=Y(u),f=u<0?Dt(c+f,0):Qt(f,c-1)),_s(r,B(s,3),f,!0)}function Pf(r){var s=r==null?0:r.length;return s?Ft(r,1):[]}function L0(r){var s=r==null?0:r.length;return s?Ft(r,Nn):[]}function k0(r,s){var u=r==null?0:r.length;return u?(s=s===e?1:Y(s),Ft(r,s)):[]}function F0(r){for(var s=-1,u=r==null?0:r.length,c={};++s<u;){var f=r[s];c[f[0]]=f[1]}return c}function Vf(r){return r&&r.length?r[0]:e}function U0(r,s,u){var c=r==null?0:r.length;if(!c)return-1;var f=u==null?0:Y(u);return f<0&&(f=Dt(c+f,0)),or(r,s,f)}function B0(r){var s=r==null?0:r.length;return s?Re(r,0,-1):[]}var q0=Z(function(r){var s=vt(r,nu);return s.length&&s[0]===r[0]?Ha(s):[]}),$0=Z(function(r){var s=Se(r),u=vt(r,nu);return s===Se(u)?s=e:u.pop(),u.length&&u[0]===r[0]?Ha(u,B(s,2)):[]}),W0=Z(function(r){var s=Se(r),u=vt(r,nu);return s=typeof s=="function"?s:e,s&&u.pop(),u.length&&u[0]===r[0]?Ha(u,e,s):[]});function z0(r,s){return r==null?"":By.call(r,s)}function Se(r){var s=r==null?0:r.length;return s?r[s-1]:e}function G0(r,s,u){var c=r==null?0:r.length;if(!c)return-1;var f=c;return u!==e&&(f=Y(u),f=f<0?Dt(c+f,0):Qt(f,c-1)),s===s?Ay(r,s,f):_s(r,uh,f,!0)}function H0(r,s){return r&&r.length?Uh(r,Y(s)):e}var K0=Z(Df);function Df(r,s){return r&&r.length&&s&&s.length?Ya(r,s):r}function Q0(r,s,u){return r&&r.length&&s&&s.length?Ya(r,s,B(u,2)):r}function j0(r,s,u){return r&&r.length&&s&&s.length?Ya(r,s,e,u):r}var Y0=rn(function(r,s){var u=r==null?0:r.length,c=$a(r,s);return $h(r,vt(s,function(f){return sn(f,u)?+f:f}).sort(Jh)),c});function X0(r,s){var u=[];if(!(r&&r.length))return u;var c=-1,f=[],p=r.length;for(s=B(s,3);++c<p;){var y=r[c];s(y,c,r)&&(u.push(y),f.push(c))}return $h(r,f),u}function mu(r){return r==null?r:zy.call(r)}function J0(r,s,u){var c=r==null?0:r.length;return c?(u&&typeof u!="number"&&re(r,s,u)?(s=0,u=c):(s=s==null?0:Y(s),u=u===e?c:Y(u)),Re(r,s,u)):[]}function Z0(r,s){return ks(r,s)}function tE(r,s,u){return Za(r,s,B(u,2))}function eE(r,s){var u=r==null?0:r.length;if(u){var c=ks(r,s);if(c<u&&Oe(r[c],s))return c}return-1}function nE(r,s){return ks(r,s,!0)}function rE(r,s,u){return Za(r,s,B(u,2),!0)}function iE(r,s){var u=r==null?0:r.length;if(u){var c=ks(r,s,!0)-1;if(Oe(r[c],s))return c}return-1}function sE(r){return r&&r.length?zh(r):[]}function oE(r,s){return r&&r.length?zh(r,B(s,2)):[]}function aE(r){var s=r==null?0:r.length;return s?Re(r,1,s):[]}function uE(r,s,u){return r&&r.length?(s=u||s===e?1:Y(s),Re(r,0,s<0?0:s)):[]}function lE(r,s,u){var c=r==null?0:r.length;return c?(s=u||s===e?1:Y(s),s=c-s,Re(r,s<0?0:s,c)):[]}function cE(r,s){return r&&r.length?Fs(r,B(s,3),!1,!0):[]}function hE(r,s){return r&&r.length?Fs(r,B(s,3)):[]}var fE=Z(function(r){return vn(Ft(r,1,At,!0))}),dE=Z(function(r){var s=Se(r);return At(s)&&(s=e),vn(Ft(r,1,At,!0),B(s,2))}),gE=Z(function(r){var s=Se(r);return s=typeof s=="function"?s:e,vn(Ft(r,1,At,!0),e,s)});function pE(r){return r&&r.length?vn(r):[]}function mE(r,s){return r&&r.length?vn(r,B(s,2)):[]}function _E(r,s){return s=typeof s=="function"?s:e,r&&r.length?vn(r,e,s):[]}function _u(r){if(!(r&&r.length))return[];var s=0;return r=gn(r,function(u){if(At(u))return s=Dt(u.length,s),!0}),Oa(s,function(u){return vt(r,xa(u))})}function xf(r,s){if(!(r&&r.length))return[];var u=_u(r);return s==null?u:vt(u,function(c){return ce(s,e,c)})}var yE=Z(function(r,s){return At(r)?oi(r,s):[]}),vE=Z(function(r){return eu(gn(r,At))}),EE=Z(function(r){var s=Se(r);return At(s)&&(s=e),eu(gn(r,At),B(s,2))}),TE=Z(function(r){var s=Se(r);return s=typeof s=="function"?s:e,eu(gn(r,At),e,s)}),wE=Z(_u);function IE(r,s){return Qh(r||[],s||[],si)}function AE(r,s){return Qh(r||[],s||[],li)}var RE=Z(function(r){var s=r.length,u=s>1?r[s-1]:e;return u=typeof u=="function"?(r.pop(),u):e,xf(r,u)});function bf(r){var s=g(r);return s.__chain__=!0,s}function SE(r,s){return s(r),r}function Ks(r,s){return s(r)}var CE=rn(function(r){var s=r.length,u=s?r[0]:0,c=this.__wrapped__,f=function(p){return $a(p,r)};return s>1||this.__actions__.length||!(c instanceof et)||!sn(u)?this.thru(f):(c=c.slice(u,+u+(s?1:0)),c.__actions__.push({func:Ks,args:[f],thisArg:e}),new Ie(c,this.__chain__).thru(function(p){return s&&!p.length&&p.push(e),p}))});function PE(){return bf(this)}function VE(){return new Ie(this.value(),this.__chain__)}function DE(){this.__values__===e&&(this.__values__=Hf(this.value()));var r=this.__index__>=this.__values__.length,s=r?e:this.__values__[this.__index__++];return{done:r,value:s}}function xE(){return this}function bE(r){for(var s,u=this;u instanceof bs;){var c=Rf(u);c.__index__=0,c.__values__=e,s?f.__wrapped__=c:s=c;var f=c;u=u.__wrapped__}return f.__wrapped__=r,s}function NE(){var r=this.__wrapped__;if(r instanceof et){var s=r;return this.__actions__.length&&(s=new et(this)),s=s.reverse(),s.__actions__.push({func:Ks,args:[mu],thisArg:e}),new Ie(s,this.__chain__)}return this.thru(mu)}function OE(){return Kh(this.__wrapped__,this.__actions__)}var ME=Us(function(r,s,u){ct.call(r,u)?++r[u]:en(r,u,1)});function LE(r,s,u){var c=Q(r)?oh:Sv;return u&&re(r,s,u)&&(s=e),c(r,B(s,3))}function kE(r,s){var u=Q(r)?gn:Dh;return u(r,B(s,3))}var FE=sf(Sf),UE=sf(Cf);function BE(r,s){return Ft(Qs(r,s),1)}function qE(r,s){return Ft(Qs(r,s),Nn)}function $E(r,s,u){return u=u===e?1:Y(u),Ft(Qs(r,s),u)}function Nf(r,s){var u=Q(r)?Te:yn;return u(r,B(s,3))}function Of(r,s){var u=Q(r)?ay:Vh;return u(r,B(s,3))}var WE=Us(function(r,s,u){ct.call(r,u)?r[u].push(s):en(r,u,[s])});function zE(r,s,u,c){r=ae(r)?r:yr(r),u=u&&!c?Y(u):0;var f=r.length;return u<0&&(u=Dt(f+u,0)),Zs(r)?u<=f&&r.indexOf(s,u)>-1:!!f&&or(r,s,u)>-1}var GE=Z(function(r,s,u){var c=-1,f=typeof s=="function",p=ae(r)?I(r.length):[];return yn(r,function(y){p[++c]=f?ce(s,y,u):ai(y,s,u)}),p}),HE=Us(function(r,s,u){en(r,u,s)});function Qs(r,s){var u=Q(r)?vt:Lh;return u(r,B(s,3))}function KE(r,s,u,c){return r==null?[]:(Q(s)||(s=s==null?[]:[s]),u=c?e:u,Q(u)||(u=u==null?[]:[u]),Bh(r,s,u))}var QE=Us(function(r,s,u){r[u?0:1].push(s)},function(){return[[],[]]});function jE(r,s,u){var c=Q(r)?Va:ch,f=arguments.length<3;return c(r,B(s,4),u,f,yn)}function YE(r,s,u){var c=Q(r)?uy:ch,f=arguments.length<3;return c(r,B(s,4),u,f,Vh)}function XE(r,s){var u=Q(r)?gn:Dh;return u(r,Xs(B(s,3)))}function JE(r){var s=Q(r)?Rh:zv;return s(r)}function ZE(r,s,u){(u?re(r,s,u):s===e)?s=1:s=Y(s);var c=Q(r)?Tv:Gv;return c(r,s)}function tT(r){var s=Q(r)?wv:Kv;return s(r)}function eT(r){if(r==null)return 0;if(ae(r))return Zs(r)?ur(r):r.length;var s=jt(r);return s==De||s==xe?r.size:Qa(r).length}function nT(r,s,u){var c=Q(r)?Da:Qv;return u&&re(r,s,u)&&(s=e),c(r,B(s,3))}var rT=Z(function(r,s){if(r==null)return[];var u=s.length;return u>1&&re(r,s[0],s[1])?s=[]:u>2&&re(s[0],s[1],s[2])&&(s=[s[0]]),Bh(r,Ft(s,1),[])}),js=ky||function(){return kt.Date.now()};function iT(r,s){if(typeof s!="function")throw new we(l);return r=Y(r),function(){if(--r<1)return s.apply(this,arguments)}}function Mf(r,s,u){return s=u?e:s,s=r&&s==null?r.length:s,nn(r,ve,e,e,e,e,s)}function Lf(r,s){var u;if(typeof s!="function")throw new we(l);return r=Y(r),function(){return--r>0&&(u=s.apply(this,arguments)),r<=1&&(s=e),u}}var yu=Z(function(r,s,u){var c=F;if(u.length){var f=mn(u,mr(yu));c|=Kt}return nn(r,c,s,u,f)}),kf=Z(function(r,s,u){var c=F|lt;if(u.length){var f=mn(u,mr(kf));c|=Kt}return nn(s,c,r,u,f)});function Ff(r,s,u){s=u?e:s;var c=nn(r,yt,e,e,e,e,e,s);return c.placeholder=Ff.placeholder,c}function Uf(r,s,u){s=u?e:s;var c=nn(r,Ht,e,e,e,e,e,s);return c.placeholder=Uf.placeholder,c}function Bf(r,s,u){var c,f,p,y,v,T,R=0,S=!1,V=!1,b=!0;if(typeof r!="function")throw new we(l);s=Ce(s)||0,Et(u)&&(S=!!u.leading,V="maxWait"in u,p=V?Dt(Ce(u.maxWait)||0,s):p,b="trailing"in u?!!u.trailing:b);function k(Rt){var Me=c,un=f;return c=f=e,R=Rt,y=r.apply(un,Me),y}function q(Rt){return R=Rt,v=fi(tt,s),S?k(Rt):y}function J(Rt){var Me=Rt-T,un=Rt-R,sd=s-Me;return V?Qt(sd,p-un):sd}function $(Rt){var Me=Rt-T,un=Rt-R;return T===e||Me>=s||Me<0||V&&un>=p}function tt(){var Rt=js();if($(Rt))return rt(Rt);v=fi(tt,J(Rt))}function rt(Rt){return v=e,b&&c?k(Rt):(c=f=e,y)}function ge(){v!==e&&jh(v),R=0,c=T=f=v=e}function ie(){return v===e?y:rt(js())}function pe(){var Rt=js(),Me=$(Rt);if(c=arguments,f=this,T=Rt,Me){if(v===e)return q(T);if(V)return jh(v),v=fi(tt,s),k(T)}return v===e&&(v=fi(tt,s)),y}return pe.cancel=ge,pe.flush=ie,pe}var sT=Z(function(r,s){return Ph(r,1,s)}),oT=Z(function(r,s,u){return Ph(r,Ce(s)||0,u)});function aT(r){return nn(r,Gr)}function Ys(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new we(l);var u=function(){var c=arguments,f=s?s.apply(this,c):c[0],p=u.cache;if(p.has(f))return p.get(f);var y=r.apply(this,c);return u.cache=p.set(f,y)||p,y};return u.cache=new(Ys.Cache||tn),u}Ys.Cache=tn;function Xs(r){if(typeof r!="function")throw new we(l);return function(){var s=arguments;switch(s.length){case 0:return!r.call(this);case 1:return!r.call(this,s[0]);case 2:return!r.call(this,s[0],s[1]);case 3:return!r.call(this,s[0],s[1],s[2])}return!r.apply(this,s)}}function uT(r){return Lf(2,r)}var lT=jv(function(r,s){s=s.length==1&&Q(s[0])?vt(s[0],he(B())):vt(Ft(s,1),he(B()));var u=s.length;return Z(function(c){for(var f=-1,p=Qt(c.length,u);++f<p;)c[f]=s[f].call(this,c[f]);return ce(r,this,c)})}),vu=Z(function(r,s){var u=mn(s,mr(vu));return nn(r,Kt,e,s,u)}),qf=Z(function(r,s){var u=mn(s,mr(qf));return nn(r,ye,e,s,u)}),cT=rn(function(r,s){return nn(r,nr,e,e,e,s)});function hT(r,s){if(typeof r!="function")throw new we(l);return s=s===e?s:Y(s),Z(r,s)}function fT(r,s){if(typeof r!="function")throw new we(l);return s=s==null?0:Dt(Y(s),0),Z(function(u){var c=u[s],f=Tn(u,0,s);return c&&pn(f,c),ce(r,this,f)})}function dT(r,s,u){var c=!0,f=!0;if(typeof r!="function")throw new we(l);return Et(u)&&(c="leading"in u?!!u.leading:c,f="trailing"in u?!!u.trailing:f),Bf(r,s,{leading:c,maxWait:s,trailing:f})}function gT(r){return Mf(r,1)}function pT(r,s){return vu(ru(s),r)}function mT(){if(!arguments.length)return[];var r=arguments[0];return Q(r)?r:[r]}function _T(r){return Ae(r,x)}function yT(r,s){return s=typeof s=="function"?s:e,Ae(r,x,s)}function vT(r){return Ae(r,w|x)}function ET(r,s){return s=typeof s=="function"?s:e,Ae(r,w|x,s)}function TT(r,s){return s==null||Ch(r,s,Nt(s))}function Oe(r,s){return r===s||r!==r&&s!==s}var wT=Ws(Ga),IT=Ws(function(r,s){return r>=s}),$n=Nh(function(){return arguments}())?Nh:function(r){return wt(r)&&ct.call(r,"callee")&&!vh.call(r,"callee")},Q=I.isArray,AT=th?he(th):bv;function ae(r){return r!=null&&Js(r.length)&&!on(r)}function At(r){return wt(r)&&ae(r)}function RT(r){return r===!0||r===!1||wt(r)&&ne(r)==Hr}var wn=Uy||Du,ST=eh?he(eh):Nv;function CT(r){return wt(r)&&r.nodeType===1&&!di(r)}function PT(r){if(r==null)return!0;if(ae(r)&&(Q(r)||typeof r=="string"||typeof r.splice=="function"||wn(r)||_r(r)||$n(r)))return!r.length;var s=jt(r);if(s==De||s==xe)return!r.size;if(hi(r))return!Qa(r).length;for(var u in r)if(ct.call(r,u))return!1;return!0}function VT(r,s){return ui(r,s)}function DT(r,s,u){u=typeof u=="function"?u:e;var c=u?u(r,s):e;return c===e?ui(r,s,e,u):!!c}function Eu(r){if(!wt(r))return!1;var s=ne(r);return s==cs||s==Zm||typeof r.message=="string"&&typeof r.name=="string"&&!di(r)}function xT(r){return typeof r=="number"&&Th(r)}function on(r){if(!Et(r))return!1;var s=ne(r);return s==hs||s==Pc||s==Jm||s==e_}function $f(r){return typeof r=="number"&&r==Y(r)}function Js(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=dn}function Et(r){var s=typeof r;return r!=null&&(s=="object"||s=="function")}function wt(r){return r!=null&&typeof r=="object"}var Wf=nh?he(nh):Mv;function bT(r,s){return r===s||Ka(r,s,cu(s))}function NT(r,s,u){return u=typeof u=="function"?u:e,Ka(r,s,cu(s),u)}function OT(r){return zf(r)&&r!=+r}function MT(r){if(y0(r))throw new H(a);return Oh(r)}function LT(r){return r===null}function kT(r){return r==null}function zf(r){return typeof r=="number"||wt(r)&&ne(r)==Qr}function di(r){if(!wt(r)||ne(r)!=Je)return!1;var s=Rs(r);if(s===null)return!0;var u=ct.call(s,"constructor")&&s.constructor;return typeof u=="function"&&u instanceof u&&Ts.call(u)==Ny}var Tu=rh?he(rh):Lv;function FT(r){return $f(r)&&r>=-dn&&r<=dn}var Gf=ih?he(ih):kv;function Zs(r){return typeof r=="string"||!Q(r)&&wt(r)&&ne(r)==Yr}function de(r){return typeof r=="symbol"||wt(r)&&ne(r)==fs}var _r=sh?he(sh):Fv;function UT(r){return r===e}function BT(r){return wt(r)&&jt(r)==Xr}function qT(r){return wt(r)&&ne(r)==r_}var $T=Ws(ja),WT=Ws(function(r,s){return r<=s});function Hf(r){if(!r)return[];if(ae(r))return Zs(r)?be(r):oe(r);if(ti&&r[ti])return Ty(r[ti]());var s=jt(r),u=s==De?La:s==xe?ys:yr;return u(r)}function an(r){if(!r)return r===0?r:0;if(r=Ce(r),r===Nn||r===-Nn){var s=r<0?-1:1;return s*Qm}return r===r?r:0}function Y(r){var s=an(r),u=s%1;return s===s?u?s-u:s:0}function Kf(r){return r?Fn(Y(r),0,qe):0}function Ce(r){if(typeof r=="number")return r;if(de(r))return us;if(Et(r)){var s=typeof r.valueOf=="function"?r.valueOf():r;r=Et(s)?s+"":s}if(typeof r!="string")return r===0?r:+r;r=hh(r);var u=A_.test(r);return u||S_.test(r)?iy(r.slice(2),u?2:8):I_.test(r)?us:+r}function Qf(r){return We(r,ue(r))}function zT(r){return r?Fn(Y(r),-dn,dn):r===0?r:0}function ut(r){return r==null?"":fe(r)}var GT=gr(function(r,s){if(hi(s)||ae(s)){We(s,Nt(s),r);return}for(var u in s)ct.call(s,u)&&si(r,u,s[u])}),jf=gr(function(r,s){We(s,ue(s),r)}),to=gr(function(r,s,u,c){We(s,ue(s),r,c)}),HT=gr(function(r,s,u,c){We(s,Nt(s),r,c)}),KT=rn($a);function QT(r,s){var u=dr(r);return s==null?u:Sh(u,s)}var jT=Z(function(r,s){r=ft(r);var u=-1,c=s.length,f=c>2?s[2]:e;for(f&&re(s[0],s[1],f)&&(c=1);++u<c;)for(var p=s[u],y=ue(p),v=-1,T=y.length;++v<T;){var R=y[v],S=r[R];(S===e||Oe(S,cr[R])&&!ct.call(r,R))&&(r[R]=p[R])}return r}),YT=Z(function(r){return r.push(e,ff),ce(Yf,e,r)});function XT(r,s){return ah(r,B(s,3),$e)}function JT(r,s){return ah(r,B(s,3),za)}function ZT(r,s){return r==null?r:Wa(r,B(s,3),ue)}function tw(r,s){return r==null?r:xh(r,B(s,3),ue)}function ew(r,s){return r&&$e(r,B(s,3))}function nw(r,s){return r&&za(r,B(s,3))}function rw(r){return r==null?[]:Ms(r,Nt(r))}function iw(r){return r==null?[]:Ms(r,ue(r))}function wu(r,s,u){var c=r==null?e:Un(r,s);return c===e?u:c}function sw(r,s){return r!=null&&pf(r,s,Pv)}function Iu(r,s){return r!=null&&pf(r,s,Vv)}var ow=af(function(r,s,u){s!=null&&typeof s.toString!="function"&&(s=ws.call(s)),r[s]=u},Ru(le)),aw=af(function(r,s,u){s!=null&&typeof s.toString!="function"&&(s=ws.call(s)),ct.call(r,s)?r[s].push(u):r[s]=[u]},B),uw=Z(ai);function Nt(r){return ae(r)?Ah(r):Qa(r)}function ue(r){return ae(r)?Ah(r,!0):Uv(r)}function lw(r,s){var u={};return s=B(s,3),$e(r,function(c,f,p){en(u,s(c,f,p),c)}),u}function cw(r,s){var u={};return s=B(s,3),$e(r,function(c,f,p){en(u,f,s(c,f,p))}),u}var hw=gr(function(r,s,u){Ls(r,s,u)}),Yf=gr(function(r,s,u,c){Ls(r,s,u,c)}),fw=rn(function(r,s){var u={};if(r==null)return u;var c=!1;s=vt(s,function(p){return p=En(p,r),c||(c=p.length>1),p}),We(r,uu(r),u),c&&(u=Ae(u,w|P|x,o0));for(var f=s.length;f--;)tu(u,s[f]);return u});function dw(r,s){return Xf(r,Xs(B(s)))}var gw=rn(function(r,s){return r==null?{}:qv(r,s)});function Xf(r,s){if(r==null)return{};var u=vt(uu(r),function(c){return[c]});return s=B(s),qh(r,u,function(c,f){return s(c,f[0])})}function pw(r,s,u){s=En(s,r);var c=-1,f=s.length;for(f||(f=1,r=e);++c<f;){var p=r==null?e:r[ze(s[c])];p===e&&(c=f,p=u),r=on(p)?p.call(r):p}return r}function mw(r,s,u){return r==null?r:li(r,s,u)}function _w(r,s,u,c){return c=typeof c=="function"?c:e,r==null?r:li(r,s,u,c)}var Jf=cf(Nt),Zf=cf(ue);function yw(r,s,u){var c=Q(r),f=c||wn(r)||_r(r);if(s=B(s,4),u==null){var p=r&&r.constructor;f?u=c?new p:[]:Et(r)?u=on(p)?dr(Rs(r)):{}:u={}}return(f?Te:$e)(r,function(y,v,T){return s(u,y,v,T)}),u}function vw(r,s){return r==null?!0:tu(r,s)}function Ew(r,s,u){return r==null?r:Hh(r,s,ru(u))}function Tw(r,s,u,c){return c=typeof c=="function"?c:e,r==null?r:Hh(r,s,ru(u),c)}function yr(r){return r==null?[]:Ma(r,Nt(r))}function ww(r){return r==null?[]:Ma(r,ue(r))}function Iw(r,s,u){return u===e&&(u=s,s=e),u!==e&&(u=Ce(u),u=u===u?u:0),s!==e&&(s=Ce(s),s=s===s?s:0),Fn(Ce(r),s,u)}function Aw(r,s,u){return s=an(s),u===e?(u=s,s=0):u=an(u),r=Ce(r),Dv(r,s,u)}function Rw(r,s,u){if(u&&typeof u!="boolean"&&re(r,s,u)&&(s=u=e),u===e&&(typeof s=="boolean"?(u=s,s=e):typeof r=="boolean"&&(u=r,r=e)),r===e&&s===e?(r=0,s=1):(r=an(r),s===e?(s=r,r=0):s=an(s)),r>s){var c=r;r=s,s=c}if(u||r%1||s%1){var f=wh();return Qt(r+f*(s-r+ry("1e-"+((f+"").length-1))),s)}return Xa(r,s)}var Sw=pr(function(r,s,u){return s=s.toLowerCase(),r+(u?td(s):s)});function td(r){return Au(ut(r).toLowerCase())}function ed(r){return r=ut(r),r&&r.replace(P_,my).replace(K_,"")}function Cw(r,s,u){r=ut(r),s=fe(s);var c=r.length;u=u===e?c:Fn(Y(u),0,c);var f=u;return u-=s.length,u>=0&&r.slice(u,f)==s}function Pw(r){return r=ut(r),r&&u_.test(r)?r.replace(xc,_y):r}function Vw(r){return r=ut(r),r&&g_.test(r)?r.replace(va,"\\$&"):r}var Dw=pr(function(r,s,u){return r+(u?"-":"")+s.toLowerCase()}),xw=pr(function(r,s,u){return r+(u?" ":"")+s.toLowerCase()}),bw=rf("toLowerCase");function Nw(r,s,u){r=ut(r),s=Y(s);var c=s?ur(r):0;if(!s||c>=s)return r;var f=(s-c)/2;return $s(Vs(f),u)+r+$s(Ps(f),u)}function Ow(r,s,u){r=ut(r),s=Y(s);var c=s?ur(r):0;return s&&c<s?r+$s(s-c,u):r}function Mw(r,s,u){r=ut(r),s=Y(s);var c=s?ur(r):0;return s&&c<s?$s(s-c,u)+r:r}function Lw(r,s,u){return u||s==null?s=0:s&&(s=+s),Wy(ut(r).replace(Ea,""),s||0)}function kw(r,s,u){return(u?re(r,s,u):s===e)?s=1:s=Y(s),Ja(ut(r),s)}function Fw(){var r=arguments,s=ut(r[0]);return r.length<3?s:s.replace(r[1],r[2])}var Uw=pr(function(r,s,u){return r+(u?"_":"")+s.toLowerCase()});function Bw(r,s,u){return u&&typeof u!="number"&&re(r,s,u)&&(s=u=e),u=u===e?qe:u>>>0,u?(r=ut(r),r&&(typeof s=="string"||s!=null&&!Tu(s))&&(s=fe(s),!s&&ar(r))?Tn(be(r),0,u):r.split(s,u)):[]}var qw=pr(function(r,s,u){return r+(u?" ":"")+Au(s)});function $w(r,s,u){return r=ut(r),u=u==null?0:Fn(Y(u),0,r.length),s=fe(s),r.slice(u,u+s.length)==s}function Ww(r,s,u){var c=g.templateSettings;u&&re(r,s,u)&&(s=e),r=ut(r),s=to({},s,c,hf);var f=to({},s.imports,c.imports,hf),p=Nt(f),y=Ma(f,p),v,T,R=0,S=s.interpolate||ds,V="__p += '",b=ka((s.escape||ds).source+"|"+S.source+"|"+(S===bc?w_:ds).source+"|"+(s.evaluate||ds).source+"|$","g"),k="//# sourceURL="+(ct.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++J_+"]")+`
`;r.replace(b,function($,tt,rt,ge,ie,pe){return rt||(rt=ge),V+=r.slice(R,pe).replace(V_,yy),tt&&(v=!0,V+=`' +
__e(`+tt+`) +
'`),ie&&(T=!0,V+=`';
`+ie+`;
__p += '`),rt&&(V+=`' +
((__t = (`+rt+`)) == null ? '' : __t) +
'`),R=pe+$.length,$}),V+=`';
`;var q=ct.call(s,"variable")&&s.variable;if(!q)V=`with (obj) {
`+V+`
}
`;else if(E_.test(q))throw new H(h);V=(T?V.replace(i_,""):V).replace(s_,"$1").replace(o_,"$1;"),V="function("+(q||"obj")+`) {
`+(q?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(v?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+V+`return __p
}`;var J=rd(function(){return ot(p,k+"return "+V).apply(e,y)});if(J.source=V,Eu(J))throw J;return J}function zw(r){return ut(r).toLowerCase()}function Gw(r){return ut(r).toUpperCase()}function Hw(r,s,u){if(r=ut(r),r&&(u||s===e))return hh(r);if(!r||!(s=fe(s)))return r;var c=be(r),f=be(s),p=fh(c,f),y=dh(c,f)+1;return Tn(c,p,y).join("")}function Kw(r,s,u){if(r=ut(r),r&&(u||s===e))return r.slice(0,ph(r)+1);if(!r||!(s=fe(s)))return r;var c=be(r),f=dh(c,be(s))+1;return Tn(c,0,f).join("")}function Qw(r,s,u){if(r=ut(r),r&&(u||s===e))return r.replace(Ea,"");if(!r||!(s=fe(s)))return r;var c=be(r),f=fh(c,be(s));return Tn(c,f).join("")}function jw(r,s){var u=as,c=Wm;if(Et(s)){var f="separator"in s?s.separator:f;u="length"in s?Y(s.length):u,c="omission"in s?fe(s.omission):c}r=ut(r);var p=r.length;if(ar(r)){var y=be(r);p=y.length}if(u>=p)return r;var v=u-ur(c);if(v<1)return c;var T=y?Tn(y,0,v).join(""):r.slice(0,v);if(f===e)return T+c;if(y&&(v+=T.length-v),Tu(f)){if(r.slice(v).search(f)){var R,S=T;for(f.global||(f=ka(f.source,ut(Nc.exec(f))+"g")),f.lastIndex=0;R=f.exec(S);)var V=R.index;T=T.slice(0,V===e?v:V)}}else if(r.indexOf(fe(f),v)!=v){var b=T.lastIndexOf(f);b>-1&&(T=T.slice(0,b))}return T+c}function Yw(r){return r=ut(r),r&&a_.test(r)?r.replace(Dc,Ry):r}var Xw=pr(function(r,s,u){return r+(u?" ":"")+s.toUpperCase()}),Au=rf("toUpperCase");function nd(r,s,u){return r=ut(r),s=u?e:s,s===e?Ey(r)?Py(r):hy(r):r.match(s)||[]}var rd=Z(function(r,s){try{return ce(r,e,s)}catch(u){return Eu(u)?u:new H(u)}}),Jw=rn(function(r,s){return Te(s,function(u){u=ze(u),en(r,u,yu(r[u],r))}),r});function Zw(r){var s=r==null?0:r.length,u=B();return r=s?vt(r,function(c){if(typeof c[1]!="function")throw new we(l);return[u(c[0]),c[1]]}):[],Z(function(c){for(var f=-1;++f<s;){var p=r[f];if(ce(p[0],this,c))return ce(p[1],this,c)}})}function tI(r){return Rv(Ae(r,w))}function Ru(r){return function(){return r}}function eI(r,s){return r==null||r!==r?s:r}var nI=of(),rI=of(!0);function le(r){return r}function Su(r){return Mh(typeof r=="function"?r:Ae(r,w))}function iI(r){return kh(Ae(r,w))}function sI(r,s){return Fh(r,Ae(s,w))}var oI=Z(function(r,s){return function(u){return ai(u,r,s)}}),aI=Z(function(r,s){return function(u){return ai(r,u,s)}});function Cu(r,s,u){var c=Nt(s),f=Ms(s,c);u==null&&!(Et(s)&&(f.length||!c.length))&&(u=s,s=r,r=this,f=Ms(s,Nt(s)));var p=!(Et(u)&&"chain"in u)||!!u.chain,y=on(r);return Te(f,function(v){var T=s[v];r[v]=T,y&&(r.prototype[v]=function(){var R=this.__chain__;if(p||R){var S=r(this.__wrapped__),V=S.__actions__=oe(this.__actions__);return V.push({func:T,args:arguments,thisArg:r}),S.__chain__=R,S}return T.apply(r,pn([this.value()],arguments))})}),r}function uI(){return kt._===this&&(kt._=Oy),this}function Pu(){}function lI(r){return r=Y(r),Z(function(s){return Uh(s,r)})}var cI=su(vt),hI=su(oh),fI=su(Da);function id(r){return fu(r)?xa(ze(r)):$v(r)}function dI(r){return function(s){return r==null?e:Un(r,s)}}var gI=uf(),pI=uf(!0);function Vu(){return[]}function Du(){return!1}function mI(){return{}}function _I(){return""}function yI(){return!0}function vI(r,s){if(r=Y(r),r<1||r>dn)return[];var u=qe,c=Qt(r,qe);s=B(s),r-=qe;for(var f=Oa(c,s);++u<r;)s(u);return f}function EI(r){return Q(r)?vt(r,ze):de(r)?[r]:oe(Af(ut(r)))}function TI(r){var s=++by;return ut(r)+s}var wI=qs(function(r,s){return r+s},0),II=ou("ceil"),AI=qs(function(r,s){return r/s},1),RI=ou("floor");function SI(r){return r&&r.length?Os(r,le,Ga):e}function CI(r,s){return r&&r.length?Os(r,B(s,2),Ga):e}function PI(r){return lh(r,le)}function VI(r,s){return lh(r,B(s,2))}function DI(r){return r&&r.length?Os(r,le,ja):e}function xI(r,s){return r&&r.length?Os(r,B(s,2),ja):e}var bI=qs(function(r,s){return r*s},1),NI=ou("round"),OI=qs(function(r,s){return r-s},0);function MI(r){return r&&r.length?Na(r,le):0}function LI(r,s){return r&&r.length?Na(r,B(s,2)):0}return g.after=iT,g.ary=Mf,g.assign=GT,g.assignIn=jf,g.assignInWith=to,g.assignWith=HT,g.at=KT,g.before=Lf,g.bind=yu,g.bindAll=Jw,g.bindKey=kf,g.castArray=mT,g.chain=bf,g.chunk=R0,g.compact=S0,g.concat=C0,g.cond=Zw,g.conforms=tI,g.constant=Ru,g.countBy=ME,g.create=QT,g.curry=Ff,g.curryRight=Uf,g.debounce=Bf,g.defaults=jT,g.defaultsDeep=YT,g.defer=sT,g.delay=oT,g.difference=P0,g.differenceBy=V0,g.differenceWith=D0,g.drop=x0,g.dropRight=b0,g.dropRightWhile=N0,g.dropWhile=O0,g.fill=M0,g.filter=kE,g.flatMap=BE,g.flatMapDeep=qE,g.flatMapDepth=$E,g.flatten=Pf,g.flattenDeep=L0,g.flattenDepth=k0,g.flip=aT,g.flow=nI,g.flowRight=rI,g.fromPairs=F0,g.functions=rw,g.functionsIn=iw,g.groupBy=WE,g.initial=B0,g.intersection=q0,g.intersectionBy=$0,g.intersectionWith=W0,g.invert=ow,g.invertBy=aw,g.invokeMap=GE,g.iteratee=Su,g.keyBy=HE,g.keys=Nt,g.keysIn=ue,g.map=Qs,g.mapKeys=lw,g.mapValues=cw,g.matches=iI,g.matchesProperty=sI,g.memoize=Ys,g.merge=hw,g.mergeWith=Yf,g.method=oI,g.methodOf=aI,g.mixin=Cu,g.negate=Xs,g.nthArg=lI,g.omit=fw,g.omitBy=dw,g.once=uT,g.orderBy=KE,g.over=cI,g.overArgs=lT,g.overEvery=hI,g.overSome=fI,g.partial=vu,g.partialRight=qf,g.partition=QE,g.pick=gw,g.pickBy=Xf,g.property=id,g.propertyOf=dI,g.pull=K0,g.pullAll=Df,g.pullAllBy=Q0,g.pullAllWith=j0,g.pullAt=Y0,g.range=gI,g.rangeRight=pI,g.rearg=cT,g.reject=XE,g.remove=X0,g.rest=hT,g.reverse=mu,g.sampleSize=ZE,g.set=mw,g.setWith=_w,g.shuffle=tT,g.slice=J0,g.sortBy=rT,g.sortedUniq=sE,g.sortedUniqBy=oE,g.split=Bw,g.spread=fT,g.tail=aE,g.take=uE,g.takeRight=lE,g.takeRightWhile=cE,g.takeWhile=hE,g.tap=SE,g.throttle=dT,g.thru=Ks,g.toArray=Hf,g.toPairs=Jf,g.toPairsIn=Zf,g.toPath=EI,g.toPlainObject=Qf,g.transform=yw,g.unary=gT,g.union=fE,g.unionBy=dE,g.unionWith=gE,g.uniq=pE,g.uniqBy=mE,g.uniqWith=_E,g.unset=vw,g.unzip=_u,g.unzipWith=xf,g.update=Ew,g.updateWith=Tw,g.values=yr,g.valuesIn=ww,g.without=yE,g.words=nd,g.wrap=pT,g.xor=vE,g.xorBy=EE,g.xorWith=TE,g.zip=wE,g.zipObject=IE,g.zipObjectDeep=AE,g.zipWith=RE,g.entries=Jf,g.entriesIn=Zf,g.extend=jf,g.extendWith=to,Cu(g,g),g.add=wI,g.attempt=rd,g.camelCase=Sw,g.capitalize=td,g.ceil=II,g.clamp=Iw,g.clone=_T,g.cloneDeep=vT,g.cloneDeepWith=ET,g.cloneWith=yT,g.conformsTo=TT,g.deburr=ed,g.defaultTo=eI,g.divide=AI,g.endsWith=Cw,g.eq=Oe,g.escape=Pw,g.escapeRegExp=Vw,g.every=LE,g.find=FE,g.findIndex=Sf,g.findKey=XT,g.findLast=UE,g.findLastIndex=Cf,g.findLastKey=JT,g.floor=RI,g.forEach=Nf,g.forEachRight=Of,g.forIn=ZT,g.forInRight=tw,g.forOwn=ew,g.forOwnRight=nw,g.get=wu,g.gt=wT,g.gte=IT,g.has=sw,g.hasIn=Iu,g.head=Vf,g.identity=le,g.includes=zE,g.indexOf=U0,g.inRange=Aw,g.invoke=uw,g.isArguments=$n,g.isArray=Q,g.isArrayBuffer=AT,g.isArrayLike=ae,g.isArrayLikeObject=At,g.isBoolean=RT,g.isBuffer=wn,g.isDate=ST,g.isElement=CT,g.isEmpty=PT,g.isEqual=VT,g.isEqualWith=DT,g.isError=Eu,g.isFinite=xT,g.isFunction=on,g.isInteger=$f,g.isLength=Js,g.isMap=Wf,g.isMatch=bT,g.isMatchWith=NT,g.isNaN=OT,g.isNative=MT,g.isNil=kT,g.isNull=LT,g.isNumber=zf,g.isObject=Et,g.isObjectLike=wt,g.isPlainObject=di,g.isRegExp=Tu,g.isSafeInteger=FT,g.isSet=Gf,g.isString=Zs,g.isSymbol=de,g.isTypedArray=_r,g.isUndefined=UT,g.isWeakMap=BT,g.isWeakSet=qT,g.join=z0,g.kebabCase=Dw,g.last=Se,g.lastIndexOf=G0,g.lowerCase=xw,g.lowerFirst=bw,g.lt=$T,g.lte=WT,g.max=SI,g.maxBy=CI,g.mean=PI,g.meanBy=VI,g.min=DI,g.minBy=xI,g.stubArray=Vu,g.stubFalse=Du,g.stubObject=mI,g.stubString=_I,g.stubTrue=yI,g.multiply=bI,g.nth=H0,g.noConflict=uI,g.noop=Pu,g.now=js,g.pad=Nw,g.padEnd=Ow,g.padStart=Mw,g.parseInt=Lw,g.random=Rw,g.reduce=jE,g.reduceRight=YE,g.repeat=kw,g.replace=Fw,g.result=pw,g.round=NI,g.runInContext=E,g.sample=JE,g.size=eT,g.snakeCase=Uw,g.some=nT,g.sortedIndex=Z0,g.sortedIndexBy=tE,g.sortedIndexOf=eE,g.sortedLastIndex=nE,g.sortedLastIndexBy=rE,g.sortedLastIndexOf=iE,g.startCase=qw,g.startsWith=$w,g.subtract=OI,g.sum=MI,g.sumBy=LI,g.template=Ww,g.times=vI,g.toFinite=an,g.toInteger=Y,g.toLength=Kf,g.toLower=zw,g.toNumber=Ce,g.toSafeInteger=zT,g.toString=ut,g.toUpper=Gw,g.trim=Hw,g.trimEnd=Kw,g.trimStart=Qw,g.truncate=jw,g.unescape=Yw,g.uniqueId=TI,g.upperCase=Xw,g.upperFirst=Au,g.each=Nf,g.eachRight=Of,g.first=Vf,Cu(g,function(){var r={};return $e(g,function(s,u){ct.call(g.prototype,u)||(r[u]=s)}),r}(),{chain:!1}),g.VERSION=i,Te(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){g[r].placeholder=g}),Te(["drop","take"],function(r,s){et.prototype[r]=function(u){u=u===e?1:Dt(Y(u),0);var c=this.__filtered__&&!s?new et(this):this.clone();return c.__filtered__?c.__takeCount__=Qt(u,c.__takeCount__):c.__views__.push({size:Qt(u,qe),type:r+(c.__dir__<0?"Right":"")}),c},et.prototype[r+"Right"]=function(u){return this.reverse()[r](u).reverse()}}),Te(["filter","map","takeWhile"],function(r,s){var u=s+1,c=u==Cc||u==Km;et.prototype[r]=function(f){var p=this.clone();return p.__iteratees__.push({iteratee:B(f,3),type:u}),p.__filtered__=p.__filtered__||c,p}}),Te(["head","last"],function(r,s){var u="take"+(s?"Right":"");et.prototype[r]=function(){return this[u](1).value()[0]}}),Te(["initial","tail"],function(r,s){var u="drop"+(s?"":"Right");et.prototype[r]=function(){return this.__filtered__?new et(this):this[u](1)}}),et.prototype.compact=function(){return this.filter(le)},et.prototype.find=function(r){return this.filter(r).head()},et.prototype.findLast=function(r){return this.reverse().find(r)},et.prototype.invokeMap=Z(function(r,s){return typeof r=="function"?new et(this):this.map(function(u){return ai(u,r,s)})}),et.prototype.reject=function(r){return this.filter(Xs(B(r)))},et.prototype.slice=function(r,s){r=Y(r);var u=this;return u.__filtered__&&(r>0||s<0)?new et(u):(r<0?u=u.takeRight(-r):r&&(u=u.drop(r)),s!==e&&(s=Y(s),u=s<0?u.dropRight(-s):u.take(s-r)),u)},et.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},et.prototype.toArray=function(){return this.take(qe)},$e(et.prototype,function(r,s){var u=/^(?:filter|find|map|reject)|While$/.test(s),c=/^(?:head|last)$/.test(s),f=g[c?"take"+(s=="last"?"Right":""):s],p=c||/^find/.test(s);f&&(g.prototype[s]=function(){var y=this.__wrapped__,v=c?[1]:arguments,T=y instanceof et,R=v[0],S=T||Q(y),V=function(tt){var rt=f.apply(g,pn([tt],v));return c&&b?rt[0]:rt};S&&u&&typeof R=="function"&&R.length!=1&&(T=S=!1);var b=this.__chain__,k=!!this.__actions__.length,q=p&&!b,J=T&&!k;if(!p&&S){y=J?y:new et(this);var $=r.apply(y,v);return $.__actions__.push({func:Ks,args:[V],thisArg:e}),new Ie($,b)}return q&&J?r.apply(this,v):($=this.thru(V),q?c?$.value()[0]:$.value():$)})}),Te(["pop","push","shift","sort","splice","unshift"],function(r){var s=vs[r],u=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",c=/^(?:pop|shift)$/.test(r);g.prototype[r]=function(){var f=arguments;if(c&&!this.__chain__){var p=this.value();return s.apply(Q(p)?p:[],f)}return this[u](function(y){return s.apply(Q(y)?y:[],f)})}}),$e(et.prototype,function(r,s){var u=g[s];if(u){var c=u.name+"";ct.call(fr,c)||(fr[c]=[]),fr[c].push({name:s,func:u})}}),fr[Bs(e,lt).name]=[{name:"wrapper",func:e}],et.prototype.clone=Yy,et.prototype.reverse=Xy,et.prototype.value=Jy,g.prototype.at=CE,g.prototype.chain=PE,g.prototype.commit=VE,g.prototype.next=DE,g.prototype.plant=bE,g.prototype.reverse=NE,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=OE,g.prototype.first=g.prototype.head,ti&&(g.prototype[ti]=xE),g},lr=Vy();On?((On.exports=lr)._=lr,Sa._=lr):kt._=lr}).call(pi)})(vo,vo.exports);var tA=vo.exports;const pg=ZI(tA),ud=n=>pg.merge({collection:"",model:{id:!1,name:""},options:{singular:"",plural:"",datatable:{headers:[{title:"Title",key:"name"}]}}},n),eA={page:ud({collection:"page",model:{id:!1,name:"",slug:"",compoments:[]},options:{singular:"Page",plural:"Pages",datatable:{headers:[{title:"Title",key:"name"},{title:"Slug",key:"slug"}]}}}),test:ud({collection:"test",model:{id:!1,name:"",level:"user",permissions:[]},options:{singular:"Test",plural:"Tests",datatable:{headers:[{title:"Name",key:"name"},{title:"Level",key:"level"},{title:"Permissions",key:"permissions"}]},levels:[{value:"user",title:"User"},{value:"admin",title:"Admin"}],permissions:[{value:"posts:create",title:"Create Posts"},{value:"posts:update",title:"Update Posts"},{value:"posts:delete",title:"Delete Posts"}]}})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mg=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?t[e++]=o:o<2048?(t[e++]=o>>6|192,t[e++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=o>>18|240,t[e++]=o>>12&63|128,t[e++]=o>>6&63|128,t[e++]=o&63|128):(t[e++]=o>>12|224,t[e++]=o>>6&63|128,t[e++]=o&63|128)}return t},nA=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const o=n[e++];if(o<128)t[i++]=String.fromCharCode(o);else if(o>191&&o<224){const a=n[e++];t[i++]=String.fromCharCode((o&31)<<6|a&63)}else if(o>239&&o<365){const a=n[e++],l=n[e++],h=n[e++],d=((o&7)<<18|(a&63)<<12|(l&63)<<6|h&63)-65536;t[i++]=String.fromCharCode(55296+(d>>10)),t[i++]=String.fromCharCode(56320+(d&1023))}else{const a=n[e++],l=n[e++];t[i++]=String.fromCharCode((o&15)<<12|(a&63)<<6|l&63)}}return t.join("")},_g={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const a=n[o],l=o+1<n.length,h=l?n[o+1]:0,d=o+2<n.length,m=d?n[o+2]:0,_=a>>2,w=(a&3)<<4|h>>4;let P=(h&15)<<2|m>>6,x=m&63;d||(x=64,l||(P=64)),i.push(e[_],e[w],e[P],e[x])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(mg(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):nA(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const a=e[n.charAt(o++)],h=o<n.length?e[n.charAt(o)]:0;++o;const m=o<n.length?e[n.charAt(o)]:64;++o;const w=o<n.length?e[n.charAt(o)]:64;if(++o,a==null||h==null||m==null||w==null)throw new rA;const P=a<<2|h>>4;if(i.push(P),m!==64){const x=h<<4&240|m>>2;if(i.push(x),w!==64){const z=m<<6&192|w;i.push(z)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class rA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const iA=function(n){const t=mg(n);return _g.encodeByteArray(t,!0)},Eo=function(n){return iA(n).replace(/\./g,"")},sA=function(n){try{return _g.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA=()=>oA().__FIREBASE_DEFAULTS__,uA=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},lA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&sA(n[1]);return t&&JSON.parse(t)},yg=()=>{try{return aA()||uA()||lA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},cA=n=>{var t,e;return(e=(t=yg())===null||t===void 0?void 0:t.emulatorHosts)===null||e===void 0?void 0:e[n]},hA=n=>{const t=cA(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},vg=()=>{var n;return(n=yg())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dA(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",o=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n),h="";return[Eo(JSON.stringify(e)),Eo(JSON.stringify(l)),h].join(".")}function gA(){try{return typeof indexedDB=="object"}catch{return!1}}function pA(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{e=!1},o.onerror=()=>{var a;t(((a=o.error)===null||a===void 0?void 0:a.message)||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA="FirebaseError";class kr extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=mA,Object.setPrototypeOf(this,kr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Eg.prototype.create)}}class Eg{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},o=`${this.service}/${t}`,a=this.errors[t],l=a?_A(a,i):"Error",h=`${this.serviceName}: ${l} (${o}).`;return new kr(o,h,i)}}function _A(n,t){return n.replace(yA,(e,i)=>{const o=t[i];return o!=null?String(o):`<${i}?>`})}const yA=/\{\$([^}]+)}/g;function Xu(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const o of e){if(!i.includes(o))return!1;const a=n[o],l=t[o];if(ld(a)&&ld(l)){if(!Xu(a,l))return!1}else if(a!==l)return!1}for(const o of i)if(!e.includes(o))return!1;return!0}function ld(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(n){return n&&n._delegate?n._delegate:n}class Pi{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new fA;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:e});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),o=(e=t==null?void 0:t.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(a){if(o)return null;throw a}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(TA(t))try{this.getOrInitializeService({instanceIdentifier:Wn})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(e);try{const a=this.getOrInitializeService({instanceIdentifier:o});i.resolve(a)}catch{}}}}clearInstance(t=Wn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Wn){return this.instances.has(t)}getOptions(t=Wn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[a,l]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(a);i===h&&l.resolve(o)}return o}onInit(t,e){var i;const o=this.normalizeInstanceIdentifier(e),a=(i=this.onInitCallbacks.get(o))!==null&&i!==void 0?i:new Set;a.add(t),this.onInitCallbacks.set(o,a);const l=this.instances.get(o);return l&&t(l,o),()=>{a.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const o of i)try{o(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:EA(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Wn){return this.component?this.component.multipleInstances?t:Wn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function EA(n){return n===Wn?void 0:n}function TA(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new vA(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(st||(st={}));const IA={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},AA=st.INFO,RA={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},SA=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),o=RA[t];if(o)console[o](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Tg{constructor(t){this.name=t,this._logLevel=AA,this._logHandler=SA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in st))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?IA[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...t),this._logHandler(this,st.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...t),this._logHandler(this,st.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,st.INFO,...t),this._logHandler(this,st.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,st.WARN,...t),this._logHandler(this,st.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...t),this._logHandler(this,st.ERROR,...t)}}const CA=(n,t)=>t.some(e=>n instanceof e);let cd,hd;function PA(){return cd||(cd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function VA(){return hd||(hd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wg=new WeakMap,Ju=new WeakMap,Ig=new WeakMap,Mu=new WeakMap,Pl=new WeakMap;function DA(n){const t=new Promise((e,i)=>{const o=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{e(An(n.result)),o()},l=()=>{i(n.error),o()};n.addEventListener("success",a),n.addEventListener("error",l)});return t.then(e=>{e instanceof IDBCursor&&wg.set(e,n)}).catch(()=>{}),Pl.set(t,n),t}function xA(n){if(Ju.has(n))return;const t=new Promise((e,i)=>{const o=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{e(),o()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});Ju.set(n,t)}let Zu={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Ju.get(n);if(t==="objectStoreNames")return n.objectStoreNames||Ig.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return An(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function bA(n){Zu=n(Zu)}function NA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(Lu(this),t,...e);return Ig.set(i,t.sort?t.sort():[t]),An(i)}:VA().includes(n)?function(...t){return n.apply(Lu(this),t),An(wg.get(this))}:function(...t){return An(n.apply(Lu(this),t))}}function OA(n){return typeof n=="function"?NA(n):(n instanceof IDBTransaction&&xA(n),CA(n,PA())?new Proxy(n,Zu):n)}function An(n){if(n instanceof IDBRequest)return DA(n);if(Mu.has(n))return Mu.get(n);const t=OA(n);return t!==n&&(Mu.set(n,t),Pl.set(t,n)),t}const Lu=n=>Pl.get(n);function MA(n,t,{blocked:e,upgrade:i,blocking:o,terminated:a}={}){const l=indexedDB.open(n,t),h=An(l);return i&&l.addEventListener("upgradeneeded",d=>{i(An(l.result),d.oldVersion,d.newVersion,An(l.transaction),d)}),e&&l.addEventListener("blocked",d=>e(d.oldVersion,d.newVersion,d)),h.then(d=>{a&&d.addEventListener("close",()=>a()),o&&d.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}const LA=["get","getKey","getAll","getAllKeys","count"],kA=["put","add","delete","clear"],ku=new Map;function fd(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(ku.get(t))return ku.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,o=kA.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(o||LA.includes(e)))return;const a=async function(l,...h){const d=this.transaction(l,o?"readwrite":"readonly");let m=d.store;return i&&(m=m.index(h.shift())),(await Promise.all([m[e](...h),o&&d.done]))[0]};return ku.set(t,a),a}bA(n=>({...n,get:(t,e,i)=>fd(t,e)||n.get(t,e,i),has:(t,e)=>!!fd(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(UA(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function UA(n){const t=n.getComponent();return(t==null?void 0:t.type)==="VERSION"}const tl="@firebase/app",dd="0.9.23";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn=new Tg("@firebase/app"),BA="@firebase/app-compat",qA="@firebase/analytics-compat",$A="@firebase/analytics",WA="@firebase/app-check-compat",zA="@firebase/app-check",GA="@firebase/auth",HA="@firebase/auth-compat",KA="@firebase/database",QA="@firebase/database-compat",jA="@firebase/functions",YA="@firebase/functions-compat",XA="@firebase/installations",JA="@firebase/installations-compat",ZA="@firebase/messaging",t1="@firebase/messaging-compat",e1="@firebase/performance",n1="@firebase/performance-compat",r1="@firebase/remote-config",i1="@firebase/remote-config-compat",s1="@firebase/storage",o1="@firebase/storage-compat",a1="@firebase/firestore",u1="@firebase/firestore-compat",l1="firebase",c1="10.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const el="[DEFAULT]",h1={[tl]:"fire-core",[BA]:"fire-core-compat",[$A]:"fire-analytics",[qA]:"fire-analytics-compat",[zA]:"fire-app-check",[WA]:"fire-app-check-compat",[GA]:"fire-auth",[HA]:"fire-auth-compat",[KA]:"fire-rtdb",[QA]:"fire-rtdb-compat",[jA]:"fire-fn",[YA]:"fire-fn-compat",[XA]:"fire-iid",[JA]:"fire-iid-compat",[ZA]:"fire-fcm",[t1]:"fire-fcm-compat",[e1]:"fire-perf",[n1]:"fire-perf-compat",[r1]:"fire-rc",[i1]:"fire-rc-compat",[s1]:"fire-gcs",[o1]:"fire-gcs-compat",[a1]:"fire-fst",[u1]:"fire-fst-compat","fire-js":"fire-js",[l1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=new Map,nl=new Map;function f1(n,t){try{n.container.addComponent(t)}catch(e){Qn.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function wo(n){const t=n.name;if(nl.has(t))return Qn.debug(`There were multiple attempts to register component ${t}.`),!1;nl.set(t,n);for(const e of To.values())f1(e,n);return!0}function d1(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Rn=new Eg("app","Firebase",g1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(t,e,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Pi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Rn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1=c1;function Ag(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i=Object.assign({name:el,automaticDataCollectionEnabled:!1},t),o=i.name;if(typeof o!="string"||!o)throw Rn.create("bad-app-name",{appName:String(o)});if(e||(e=vg()),!e)throw Rn.create("no-options");const a=To.get(o);if(a){if(Xu(e,a.options)&&Xu(i,a.config))return a;throw Rn.create("duplicate-app",{appName:o})}const l=new wA(o);for(const d of nl.values())l.addComponent(d);const h=new p1(e,i,l);return To.set(o,h),h}function _1(n=el){const t=To.get(n);if(!t&&n===el&&vg())return Ag();if(!t)throw Rn.create("no-app",{appName:n});return t}function Ar(n,t,e){var i;let o=(i=h1[n])!==null&&i!==void 0?i:n;e&&(o+=`-${e}`);const a=o.match(/\s|\//),l=t.match(/\s|\//);if(a||l){const h=[`Unable to register library "${o}" with version "${t}":`];a&&h.push(`library name "${o}" contains illegal characters (whitespace or "/")`),a&&l&&h.push("and"),l&&h.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Qn.warn(h.join(" "));return}wo(new Pi(`${o}-version`,()=>({library:o,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1="firebase-heartbeat-database",v1=1,Vi="firebase-heartbeat-store";let Fu=null;function Rg(){return Fu||(Fu=MA(y1,v1,{upgrade:(n,t)=>{switch(t){case 0:n.createObjectStore(Vi)}}}).catch(n=>{throw Rn.create("idb-open",{originalErrorMessage:n.message})})),Fu}async function E1(n){try{return await(await Rg()).transaction(Vi).objectStore(Vi).get(Sg(n))}catch(t){if(t instanceof kr)Qn.warn(t.message);else{const e=Rn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Qn.warn(e.message)}}}async function gd(n,t){try{const i=(await Rg()).transaction(Vi,"readwrite");await i.objectStore(Vi).put(t,Sg(n)),await i.done}catch(e){if(e instanceof kr)Qn.warn(e.message);else{const i=Rn.create("idb-set",{originalErrorMessage:e==null?void 0:e.message});Qn.warn(i.message)}}}function Sg(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1=1024,w1=30*24*60*60*1e3;class I1{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new R1(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=pd();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)))return this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=w1}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=pd(),{heartbeatsToSend:i,unsentEntries:o}=A1(this._heartbeatsCache.heartbeats),a=Eo(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}}function pd(){return new Date().toISOString().substring(0,10)}function A1(n,t=T1){const e=[];let i=n.slice();for(const o of n){const a=e.find(l=>l.agent===o.agent);if(a){if(a.dates.push(o.date),md(e)>t){a.dates.pop();break}}else if(e.push({agent:o.agent,dates:[o.date]}),md(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class R1{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gA()?pA().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await E1(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const o=await this.read();return gd(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:o.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){const o=await this.read();return gd(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...t.heartbeats]})}else return}}function md(n){return Eo(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S1(n){wo(new Pi("platform-logger",t=>new FA(t),"PRIVATE")),wo(new Pi("heartbeat",t=>new I1(t),"PRIVATE")),Ar(tl,dd,n),Ar(tl,dd,"esm2017"),Ar("fire-js","")}S1("");var C1="firebase",P1="10.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ar(C1,P1,"app");var V1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},N,Vl=Vl||{},G=V1||self;function Fo(n){var t=typeof n;return t=t!="object"?t:n?Array.isArray(n)?"array":t:"null",t=="array"||t=="object"&&typeof n.length=="number"}function zi(n){var t=typeof n;return t=="object"&&n!=null||t=="function"}function D1(n){return Object.prototype.hasOwnProperty.call(n,Uu)&&n[Uu]||(n[Uu]=++x1)}var Uu="closure_uid_"+(1e9*Math.random()>>>0),x1=0;function b1(n,t,e){return n.call.apply(n.bind,arguments)}function N1(n,t,e){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(o,i),n.apply(t,o)}}return function(){return n.apply(t,arguments)}}function Zt(n,t,e){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Zt=b1:Zt=N1,Zt.apply(null,arguments)}function so(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var i=e.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function Lt(n,t){function e(){}e.prototype=t.prototype,n.$=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.ac=function(i,o,a){for(var l=Array(arguments.length-2),h=2;h<arguments.length;h++)l[h-2]=arguments[h];return t.prototype[o].apply(i,l)}}function xn(){this.s=this.s,this.o=this.o}var O1=0;xn.prototype.s=!1;xn.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),O1!=0)&&D1(this)};xn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Cg=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if(typeof n=="string")return typeof t!="string"||t.length!=1?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function Dl(n){const t=n.length;if(0<t){const e=Array(t);for(let i=0;i<t;i++)e[i]=n[i];return e}return[]}function _d(n,t){for(let e=1;e<arguments.length;e++){const i=arguments[e];if(Fo(i)){const o=n.length||0,a=i.length||0;n.length=o+a;for(let l=0;l<a;l++)n[o+l]=i[l]}else n.push(i)}}function te(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}te.prototype.h=function(){this.defaultPrevented=!0};var M1=function(){if(!G.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{G.addEventListener("test",()=>{},t),G.removeEventListener("test",()=>{},t)}catch{}return n}();function Di(n){return/^[\s\xa0]*$/.test(n)}function Uo(){var n=G.navigator;return n&&(n=n.userAgent)?n:""}function He(n){return Uo().indexOf(n)!=-1}function xl(n){return xl[" "](n),n}xl[" "]=function(){};function L1(n,t){var e=PR;return Object.prototype.hasOwnProperty.call(e,n)?e[n]:e[n]=t(n)}var k1=He("Opera"),Vr=He("Trident")||He("MSIE"),Pg=He("Edge"),rl=Pg||Vr,Vg=He("Gecko")&&!(Uo().toLowerCase().indexOf("webkit")!=-1&&!He("Edge"))&&!(He("Trident")||He("MSIE"))&&!He("Edge"),F1=Uo().toLowerCase().indexOf("webkit")!=-1&&!He("Edge");function Dg(){var n=G.document;return n?n.documentMode:void 0}var il;t:{var Bu="",qu=function(){var n=Uo();if(Vg)return/rv:([^\);]+)(\)|;)/.exec(n);if(Pg)return/Edge\/([\d\.]+)/.exec(n);if(Vr)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(F1)return/WebKit\/(\S+)/.exec(n);if(k1)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(qu&&(Bu=qu?qu[1]:""),Vr){var $u=Dg();if($u!=null&&$u>parseFloat(Bu)){il=String($u);break t}}il=Bu}var sl;if(G.document&&Vr){var yd=Dg();sl=yd||parseInt(il,10)||void 0}else sl=void 0;var U1=sl;function xi(n,t){if(te.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(Vg){t:{try{xl(t.nodeName);var o=!0;break t}catch{}o=!1}o||(t=null)}}else e=="mouseover"?t=n.fromElement:e=="mouseout"&&(t=n.toElement);this.relatedTarget=t,i?(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:B1[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&xi.$.h.call(this)}}Lt(xi,te);var B1={2:"touch",3:"pen",4:"mouse"};xi.prototype.h=function(){xi.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Gi="closure_listenable_"+(1e6*Math.random()|0),q1=0;function $1(n,t,e,i,o){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!i,this.la=o,this.key=++q1,this.fa=this.ia=!1}function Bo(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function bl(n,t,e){for(const i in n)t.call(e,n[i],i,n)}function W1(n,t){for(const e in n)t.call(void 0,n[e],e,n)}function xg(n){const t={};for(const e in n)t[e]=n[e];return t}const vd="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function bg(n,t){let e,i;for(let o=1;o<arguments.length;o++){i=arguments[o];for(e in i)n[e]=i[e];for(let a=0;a<vd.length;a++)e=vd[a],Object.prototype.hasOwnProperty.call(i,e)&&(n[e]=i[e])}}function qo(n){this.src=n,this.g={},this.h=0}qo.prototype.add=function(n,t,e,i,o){var a=n.toString();n=this.g[a],n||(n=this.g[a]=[],this.h++);var l=al(n,t,i,o);return-1<l?(t=n[l],e||(t.ia=!1)):(t=new $1(t,this.src,a,!!i,o),t.ia=e,n.push(t)),t};function ol(n,t){var e=t.type;if(e in n.g){var i=n.g[e],o=Cg(i,t),a;(a=0<=o)&&Array.prototype.splice.call(i,o,1),a&&(Bo(t),n.g[e].length==0&&(delete n.g[e],n.h--))}}function al(n,t,e,i){for(var o=0;o<n.length;++o){var a=n[o];if(!a.fa&&a.listener==t&&a.capture==!!e&&a.la==i)return o}return-1}var Nl="closure_lm_"+(1e6*Math.random()|0),Wu={};function Ng(n,t,e,i,o){if(i&&i.once)return Mg(n,t,e,i,o);if(Array.isArray(t)){for(var a=0;a<t.length;a++)Ng(n,t[a],e,i,o);return null}return e=Ll(e),n&&n[Gi]?n.O(t,e,zi(i)?!!i.capture:!!i,o):Og(n,t,e,!1,i,o)}function Og(n,t,e,i,o,a){if(!t)throw Error("Invalid event type");var l=zi(o)?!!o.capture:!!o,h=Ml(n);if(h||(n[Nl]=h=new qo(n)),e=h.add(t,e,i,l,a),e.proxy)return e;if(i=z1(),e.proxy=i,i.src=n,i.listener=e,n.addEventListener)M1||(o=l),o===void 0&&(o=!1),n.addEventListener(t.toString(),i,o);else if(n.attachEvent)n.attachEvent(kg(t.toString()),i);else if(n.addListener&&n.removeListener)n.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return e}function z1(){function n(e){return t.call(n.src,n.listener,e)}const t=G1;return n}function Mg(n,t,e,i,o){if(Array.isArray(t)){for(var a=0;a<t.length;a++)Mg(n,t[a],e,i,o);return null}return e=Ll(e),n&&n[Gi]?n.P(t,e,zi(i)?!!i.capture:!!i,o):Og(n,t,e,!0,i,o)}function Lg(n,t,e,i,o){if(Array.isArray(t))for(var a=0;a<t.length;a++)Lg(n,t[a],e,i,o);else i=zi(i)?!!i.capture:!!i,e=Ll(e),n&&n[Gi]?(n=n.i,t=String(t).toString(),t in n.g&&(a=n.g[t],e=al(a,e,i,o),-1<e&&(Bo(a[e]),Array.prototype.splice.call(a,e,1),a.length==0&&(delete n.g[t],n.h--)))):n&&(n=Ml(n))&&(t=n.g[t.toString()],n=-1,t&&(n=al(t,e,i,o)),(e=-1<n?t[n]:null)&&Ol(e))}function Ol(n){if(typeof n!="number"&&n&&!n.fa){var t=n.src;if(t&&t[Gi])ol(t.i,n);else{var e=n.type,i=n.proxy;t.removeEventListener?t.removeEventListener(e,i,n.capture):t.detachEvent?t.detachEvent(kg(e),i):t.addListener&&t.removeListener&&t.removeListener(i),(e=Ml(t))?(ol(e,n),e.h==0&&(e.src=null,t[Nl]=null)):Bo(n)}}}function kg(n){return n in Wu?Wu[n]:Wu[n]="on"+n}function G1(n,t){if(n.fa)n=!0;else{t=new xi(t,this);var e=n.listener,i=n.la||n.src;n.ia&&Ol(n),n=e.call(i,t)}return n}function Ml(n){return n=n[Nl],n instanceof qo?n:null}var zu="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ll(n){return typeof n=="function"?n:(n[zu]||(n[zu]=function(t){return n.handleEvent(t)}),n[zu])}function Mt(){xn.call(this),this.i=new qo(this),this.S=this,this.J=null}Lt(Mt,xn);Mt.prototype[Gi]=!0;Mt.prototype.removeEventListener=function(n,t,e,i){Lg(this,n,t,e,i)};function zt(n,t){var e,i=n.J;if(i)for(e=[];i;i=i.J)e.push(i);if(n=n.S,i=t.type||t,typeof t=="string")t=new te(t,n);else if(t instanceof te)t.target=t.target||n;else{var o=t;t=new te(i,n),bg(t,o)}if(o=!0,e)for(var a=e.length-1;0<=a;a--){var l=t.g=e[a];o=oo(l,i,!0,t)&&o}if(l=t.g=n,o=oo(l,i,!0,t)&&o,o=oo(l,i,!1,t)&&o,e)for(a=0;a<e.length;a++)l=t.g=e[a],o=oo(l,i,!1,t)&&o}Mt.prototype.N=function(){if(Mt.$.N.call(this),this.i){var n=this.i,t;for(t in n.g){for(var e=n.g[t],i=0;i<e.length;i++)Bo(e[i]);delete n.g[t],n.h--}}this.J=null};Mt.prototype.O=function(n,t,e,i){return this.i.add(String(n),t,!1,e,i)};Mt.prototype.P=function(n,t,e,i){return this.i.add(String(n),t,!0,e,i)};function oo(n,t,e,i){if(t=n.i.g[String(t)],!t)return!0;t=t.concat();for(var o=!0,a=0;a<t.length;++a){var l=t[a];if(l&&!l.fa&&l.capture==e){var h=l.listener,d=l.la||l.src;l.ia&&ol(n.i,l),o=h.call(d,i)!==!1&&o}}return o&&!i.defaultPrevented}var kl=G.JSON.stringify;class H1{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}function K1(){var n=Fl;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}class Q1{constructor(){this.h=this.g=null}add(t,e){const i=Fg.get();i.set(t,e),this.h?this.h.next=i:this.g=i,this.h=i}}var Fg=new H1(()=>new j1,n=>n.reset());class j1{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Y1(n){var t=1;n=n.split(":");const e=[];for(;0<t&&n.length;)e.push(n.shift()),t--;return n.length&&e.push(n.join(":")),e}function X1(n){G.setTimeout(()=>{throw n},0)}let bi,Ni=!1,Fl=new Q1,Ug=()=>{const n=G.Promise.resolve(void 0);bi=()=>{n.then(J1)}};var J1=()=>{for(var n;n=K1();){try{n.h.call(n.g)}catch(e){X1(e)}var t=Fg;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}Ni=!1};function $o(n,t){Mt.call(this),this.h=n||1,this.g=t||G,this.j=Zt(this.qb,this),this.l=Date.now()}Lt($o,Mt);N=$o.prototype;N.ga=!1;N.T=null;N.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),zt(this,"tick"),this.ga&&(Ul(this),this.start()))}};N.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Ul(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}N.N=function(){$o.$.N.call(this),Ul(this),delete this.g};function Bl(n,t,e){if(typeof n=="function")e&&(n=Zt(n,e));else if(n&&typeof n.handleEvent=="function")n=Zt(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:G.setTimeout(n,t||0)}function Bg(n){n.g=Bl(()=>{n.g=null,n.i&&(n.i=!1,Bg(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}class Z1 extends xn{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Bg(this)}N(){super.N(),this.g&&(G.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Oi(n){xn.call(this),this.h=n,this.g={}}Lt(Oi,xn);var Ed=[];function qg(n,t,e,i){Array.isArray(e)||(e&&(Ed[0]=e.toString()),e=Ed);for(var o=0;o<e.length;o++){var a=Ng(t,e[o],i||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function $g(n){bl(n.g,function(t,e){this.g.hasOwnProperty(e)&&Ol(t)},n),n.g={}}Oi.prototype.N=function(){Oi.$.N.call(this),$g(this)};Oi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Wo(){this.g=!0}Wo.prototype.Ea=function(){this.g=!1};function tR(n,t,e,i,o,a){n.info(function(){if(n.g)if(a)for(var l="",h=a.split("&"),d=0;d<h.length;d++){var m=h[d].split("=");if(1<m.length){var _=m[0];m=m[1];var w=_.split("_");l=2<=w.length&&w[1]=="type"?l+(_+"="+m+"&"):l+(_+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+i+") [attempt "+o+"]: "+t+`
`+e+`
`+l})}function eR(n,t,e,i,o,a,l){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+o+"]: "+t+`
`+e+`
`+a+" "+l})}function Ir(n,t,e,i){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+rR(n,e)+(i?" "+i:"")})}function nR(n,t){n.info(function(){return"TIMEOUT: "+t})}Wo.prototype.info=function(){};function rR(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e){for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var i=e[n];if(!(2>i.length)){var o=i[1];if(Array.isArray(o)&&!(1>o.length)){var a=o[0];if(a!="noop"&&a!="stop"&&a!="close")for(var l=1;l<o.length;l++)o[l]=""}}}}return kl(e)}catch{return t}}var Zn={},Td=null;function zo(){return Td=Td||new Mt}Zn.Ta="serverreachability";function Wg(n){te.call(this,Zn.Ta,n)}Lt(Wg,te);function Mi(n){const t=zo();zt(t,new Wg(t))}Zn.STAT_EVENT="statevent";function zg(n,t){te.call(this,Zn.STAT_EVENT,n),this.stat=t}Lt(zg,te);function se(n){const t=zo();zt(t,new zg(t,n))}Zn.Ua="timingevent";function Gg(n,t){te.call(this,Zn.Ua,n),this.size=t}Lt(Gg,te);function Hi(n,t){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return G.setTimeout(function(){n()},t)}var Go={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Hg={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function ql(){}ql.prototype.h=null;function wd(n){return n.h||(n.h=n.i())}function Kg(){}var Ki={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function $l(){te.call(this,"d")}Lt($l,te);function Wl(){te.call(this,"c")}Lt(Wl,te);var ul;function Ho(){}Lt(Ho,ql);Ho.prototype.g=function(){return new XMLHttpRequest};Ho.prototype.i=function(){return{}};ul=new Ho;function Qi(n,t,e,i){this.l=n,this.j=t,this.m=e,this.W=i||1,this.U=new Oi(this),this.P=iR,n=rl?125:void 0,this.V=new $o(n),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Qg}function Qg(){this.i=null,this.g="",this.h=!1}var iR=45e3,ll={},Io={};N=Qi.prototype;N.setTimeout=function(n){this.P=n};function cl(n,t,e){n.L=1,n.v=Qo(cn(t)),n.s=e,n.S=!0,jg(n,null)}function jg(n,t){n.G=Date.now(),ji(n),n.A=cn(n.v);var e=n.A,i=n.W;Array.isArray(i)||(i=[String(i)]),rp(e.i,"t",i),n.C=0,e=n.l.J,n.h=new Qg,n.g=Ap(n.l,e?t:null,!n.s),0<n.O&&(n.M=new Z1(Zt(n.Pa,n,n.g),n.O)),qg(n.U,n.g,"readystatechange",n.nb),t=n.I?xg(n.I):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,t)):(n.u="GET",n.g.ha(n.A,n.u,null,t)),Mi(),tR(n.j,n.u,n.A,n.m,n.W,n.s)}N.nb=function(n){n=n.target;const t=this.M;t&&Ke(n)==3?t.l():this.Pa(n)};N.Pa=function(n){try{if(n==this.g)t:{const _=Ke(this.g);var t=this.g.Ia();const w=this.g.da();if(!(3>_)&&(_!=3||rl||this.g&&(this.h.h||this.g.ja()||Sd(this.g)))){this.J||_!=4||t==7||(t==8||0>=w?Mi(3):Mi(2)),Ko(this);var e=this.g.da();this.ca=e;e:if(Yg(this)){var i=Sd(this.g);n="";var o=i.length,a=Ke(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){zn(this),Ii(this);var l="";break e}this.h.i=new G.TextDecoder}for(t=0;t<o;t++)this.h.h=!0,n+=this.h.i.decode(i[t],{stream:a&&t==o-1});i.splice(0,o),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.ja();if(this.i=e==200,eR(this.j,this.u,this.A,this.m,this.W,_,e),this.i){if(this.aa&&!this.K){e:{if(this.g){var h,d=this.g;if((h=d.g?d.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Di(h)){var m=h;break e}}m=null}if(e=m)Ir(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,hl(this,e);else{this.i=!1,this.o=3,se(12),zn(this),Ii(this);break t}}this.S?(Xg(this,_,l),rl&&this.i&&_==3&&(qg(this.U,this.V,"tick",this.mb),this.V.start())):(Ir(this.j,this.m,l,null),hl(this,l)),_==4&&zn(this),this.i&&!this.J&&(_==4?Ep(this.l,this):(this.i=!1,ji(this)))}else RR(this.g),e==400&&0<l.indexOf("Unknown SID")?(this.o=3,se(12)):(this.o=0,se(13)),zn(this),Ii(this)}}}catch{}finally{}};function Yg(n){return n.g?n.u=="GET"&&n.L!=2&&n.l.Ha:!1}function Xg(n,t,e){let i=!0,o;for(;!n.J&&n.C<e.length;)if(o=sR(n,e),o==Io){t==4&&(n.o=4,se(14),i=!1),Ir(n.j,n.m,null,"[Incomplete Response]");break}else if(o==ll){n.o=4,se(15),Ir(n.j,n.m,e,"[Invalid Chunk]"),i=!1;break}else Ir(n.j,n.m,o,null),hl(n,o);Yg(n)&&o!=Io&&o!=ll&&(n.h.g="",n.C=0),t!=4||e.length!=0||n.h.h||(n.o=1,se(16),i=!1),n.i=n.i&&i,i?0<e.length&&!n.ba&&(n.ba=!0,t=n.l,t.g==n&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+e.length),jl(t),t.M=!0,se(11))):(Ir(n.j,n.m,e,"[Invalid Chunked Response]"),zn(n),Ii(n))}N.mb=function(){if(this.g){var n=Ke(this.g),t=this.g.ja();this.C<t.length&&(Ko(this),Xg(this,n,t),this.i&&n!=4&&ji(this))}};function sR(n,t){var e=n.C,i=t.indexOf(`
`,e);return i==-1?Io:(e=Number(t.substring(e,i)),isNaN(e)?ll:(i+=1,i+e>t.length?Io:(t=t.slice(i,i+e),n.C=i+e,t)))}N.cancel=function(){this.J=!0,zn(this)};function ji(n){n.Y=Date.now()+n.P,Jg(n,n.P)}function Jg(n,t){if(n.B!=null)throw Error("WatchDog timer not null");n.B=Hi(Zt(n.lb,n),t)}function Ko(n){n.B&&(G.clearTimeout(n.B),n.B=null)}N.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(nR(this.j,this.A),this.L!=2&&(Mi(),se(17)),zn(this),this.o=2,Ii(this)):Jg(this,this.Y-n)};function Ii(n){n.l.H==0||n.J||Ep(n.l,n)}function zn(n){Ko(n);var t=n.M;t&&typeof t.sa=="function"&&t.sa(),n.M=null,Ul(n.V),$g(n.U),n.g&&(t=n.g,n.g=null,t.abort(),t.sa())}function hl(n,t){try{var e=n.l;if(e.H!=0&&(e.g==n||fl(e.i,n))){if(!n.K&&fl(e.i,n)&&e.H==3){try{var i=e.Ja.g.parse(t)}catch{i=null}if(Array.isArray(i)&&i.length==3){var o=i;if(o[0]==0){t:if(!e.u){if(e.g)if(e.g.G+3e3<n.G)So(e),Xo(e);else break t;Ql(e),se(18)}}else e.Fa=o[1],0<e.Fa-e.V&&37500>o[2]&&e.G&&e.A==0&&!e.v&&(e.v=Hi(Zt(e.ib,e),6e3));if(1>=op(e.i)&&e.oa){try{e.oa()}catch{}e.oa=void 0}}else Gn(e,11)}else if((n.K||e.g==n)&&So(e),!Di(t))for(o=e.Ja.g.parse(t),t=0;t<o.length;t++){let m=o[t];if(e.V=m[0],m=m[1],e.H==2)if(m[0]=="c"){e.K=m[1],e.pa=m[2];const _=m[3];_!=null&&(e.ra=_,e.l.info("VER="+e.ra));const w=m[4];w!=null&&(e.Ga=w,e.l.info("SVER="+e.Ga));const P=m[5];P!=null&&typeof P=="number"&&0<P&&(i=1.5*P,e.L=i,e.l.info("backChannelRequestTimeoutMs_="+i)),i=e;const x=n.g;if(x){const z=x.g?x.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(z){var a=i.i;a.g||z.indexOf("spdy")==-1&&z.indexOf("quic")==-1&&z.indexOf("h2")==-1||(a.j=a.l,a.g=new Set,a.h&&(zl(a,a.h),a.h=null))}if(i.F){const X=x.g?x.g.getResponseHeader("X-HTTP-Session-Id"):null;X&&(i.Da=X,pt(i.I,i.F,X))}}e.H=3,e.h&&e.h.Ba(),e.ca&&(e.S=Date.now()-n.G,e.l.info("Handshake RTT: "+e.S+"ms")),i=e;var l=n;if(i.wa=Ip(i,i.J?i.pa:null,i.Y),l.K){ap(i.i,l);var h=l,d=i.L;d&&h.setTimeout(d),h.B&&(Ko(h),ji(h)),i.g=l}else yp(i);0<e.j.length&&Jo(e)}else m[0]!="stop"&&m[0]!="close"||Gn(e,7);else e.H==3&&(m[0]=="stop"||m[0]=="close"?m[0]=="stop"?Gn(e,7):Kl(e):m[0]!="noop"&&e.h&&e.h.Aa(m),e.A=0)}}Mi(4)}catch{}}function oR(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(Fo(n)){for(var t=[],e=n.length,i=0;i<e;i++)t.push(n[i]);return t}t=[],e=0;for(i in n)t[e++]=n[i];return t}function aR(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Fo(n)||typeof n=="string"){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const i in n)t[e++]=i;return t}}}function Zg(n,t){if(n.forEach&&typeof n.forEach=="function")n.forEach(t,void 0);else if(Fo(n)||typeof n=="string")Array.prototype.forEach.call(n,t,void 0);else for(var e=aR(n),i=oR(n),o=i.length,a=0;a<o;a++)t.call(void 0,i[a],e&&e[a],n)}var tp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uR(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var i=n[e].indexOf("="),o=null;if(0<=i){var a=n[e].substring(0,i);o=n[e].substring(i+1)}else a=n[e];t(a,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}function Kn(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Kn){this.h=n.h,Ao(this,n.j),this.s=n.s,this.g=n.g,Ro(this,n.m),this.l=n.l;var t=n.i,e=new Li;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),Id(this,e),this.o=n.o}else n&&(t=String(n).match(tp))?(this.h=!1,Ao(this,t[1]||"",!0),this.s=vi(t[2]||""),this.g=vi(t[3]||"",!0),Ro(this,t[4]),this.l=vi(t[5]||"",!0),Id(this,t[6]||"",!0),this.o=vi(t[7]||"")):(this.h=!1,this.i=new Li(null,this.h))}Kn.prototype.toString=function(){var n=[],t=this.j;t&&n.push(Ei(t,Ad,!0),":");var e=this.g;return(e||t=="file")&&(n.push("//"),(t=this.s)&&n.push(Ei(t,Ad,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e=this.m,e!=null&&n.push(":",String(e))),(e=this.l)&&(this.g&&e.charAt(0)!="/"&&n.push("/"),n.push(Ei(e,e.charAt(0)=="/"?hR:cR,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",Ei(e,dR)),n.join("")};function cn(n){return new Kn(n)}function Ao(n,t,e){n.j=e?vi(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function Ro(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function Id(n,t,e){t instanceof Li?(n.i=t,gR(n.i,n.h)):(e||(t=Ei(t,fR)),n.i=new Li(t,n.h))}function pt(n,t,e){n.i.set(t,e)}function Qo(n){return pt(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function vi(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Ei(n,t,e){return typeof n=="string"?(n=encodeURI(n).replace(t,lR),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function lR(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var Ad=/[#\/\?@]/g,cR=/[#\?:]/g,hR=/[#\?]/g,fR=/[#\?@]/g,dR=/#/g;function Li(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function bn(n){n.g||(n.g=new Map,n.h=0,n.i&&uR(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}N=Li.prototype;N.add=function(n,t){bn(this),this.i=null,n=Fr(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this};function ep(n,t){bn(n),t=Fr(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function np(n,t){return bn(n),t=Fr(n,t),n.g.has(t)}N.forEach=function(n,t){bn(this),this.g.forEach(function(e,i){e.forEach(function(o){n.call(t,o,i,this)},this)},this)};N.ta=function(){bn(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let i=0;i<t.length;i++){const o=n[i];for(let a=0;a<o.length;a++)e.push(t[i])}return e};N.Z=function(n){bn(this);let t=[];if(typeof n=="string")np(this,n)&&(t=t.concat(this.g.get(Fr(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t};N.set=function(n,t){return bn(this),this.i=null,n=Fr(this,n),np(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this};N.get=function(n,t){return n?(n=this.Z(n),0<n.length?String(n[0]):t):t};function rp(n,t,e){ep(n,t),0<e.length&&(n.i=null,n.g.set(Fr(n,t),Dl(e)),n.h+=e.length)}N.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var i=t[e];const a=encodeURIComponent(String(i)),l=this.Z(i);for(i=0;i<l.length;i++){var o=a;l[i]!==""&&(o+="="+encodeURIComponent(String(l[i]))),n.push(o)}}return this.i=n.join("&")};function Fr(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function gR(n,t){t&&!n.j&&(bn(n),n.i=null,n.g.forEach(function(e,i){var o=i.toLowerCase();i!=o&&(ep(this,i),rp(this,o,e))},n)),n.j=t}var pR=class{constructor(n,t){this.g=n,this.map=t}};function ip(n){this.l=n||mR,G.PerformanceNavigationTiming?(n=G.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(G.g&&G.g.Ka&&G.g.Ka()&&G.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var mR=10;function sp(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function op(n){return n.h?1:n.g?n.g.size:0}function fl(n,t){return n.h?n.h==t:n.g?n.g.has(t):!1}function zl(n,t){n.g?n.g.add(t):n.h=t}function ap(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}ip.prototype.cancel=function(){if(this.i=up(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function up(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let t=n.i;for(const e of n.g.values())t=t.concat(e.F);return t}return Dl(n.i)}var _R=class{stringify(n){return G.JSON.stringify(n,void 0)}parse(n){return G.JSON.parse(n,void 0)}};function yR(){this.g=new _R}function vR(n,t,e){const i=e||"";try{Zg(n,function(o,a){let l=o;zi(o)&&(l=kl(o)),t.push(i+a+"="+encodeURIComponent(l))})}catch(o){throw t.push(i+"type="+encodeURIComponent("_badmap")),o}}function ER(n,t){const e=new Wo;if(G.Image){const i=new Image;i.onload=so(ao,e,i,"TestLoadImage: loaded",!0,t),i.onerror=so(ao,e,i,"TestLoadImage: error",!1,t),i.onabort=so(ao,e,i,"TestLoadImage: abort",!1,t),i.ontimeout=so(ao,e,i,"TestLoadImage: timeout",!1,t),G.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else t(!1)}function ao(n,t,e,i,o){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,o(i)}catch{}}function Yi(n){this.l=n.ec||null,this.j=n.ob||!1}Lt(Yi,ql);Yi.prototype.g=function(){return new jo(this.l,this.j)};Yi.prototype.i=function(n){return function(){return n}}({});function jo(n,t){Mt.call(this),this.F=n,this.u=t,this.m=void 0,this.readyState=Gl,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Lt(jo,Mt);var Gl=0;N=jo.prototype;N.open=function(n,t){if(this.readyState!=Gl)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,ki(this)};N.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.F||G).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))};N.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xi(this)),this.readyState=Gl};N.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,ki(this)),this.g&&(this.readyState=3,ki(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof G.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;lp(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function lp(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}N.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?Xi(this):ki(this),this.readyState==3&&lp(this)}};N.Za=function(n){this.g&&(this.response=this.responseText=n,Xi(this))};N.Ya=function(n){this.g&&(this.response=n,Xi(this))};N.ka=function(){this.g&&Xi(this)};function Xi(n){n.readyState=4,n.l=null,n.j=null,n.A=null,ki(n)}N.setRequestHeader=function(n,t){this.v.append(n,t)};N.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};N.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)e=e.value,n.push(e[0]+": "+e[1]),e=t.next();return n.join(`\r
`)};function ki(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(jo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var TR=G.JSON.parse;function It(n){Mt.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=cp,this.L=this.M=!1}Lt(It,Mt);var cp="",wR=/^https?$/i,IR=["POST","PUT"];N=It.prototype;N.Oa=function(n){this.M=n};N.ha=function(n,t,e,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);t=t?t.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ul.g(),this.C=this.u?wd(this.u):wd(ul),this.g.onreadystatechange=Zt(this.La,this);try{this.G=!0,this.g.open(t,String(n),!0),this.G=!1}catch(a){Rd(this,a);return}if(n=e||"",e=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var o in i)e.set(o,i[o]);else if(typeof i.keys=="function"&&typeof i.get=="function")for(const a of i.keys())e.set(a,i.get(a));else throw Error("Unknown input type for opt_headers: "+String(i));i=Array.from(e.keys()).find(a=>a.toLowerCase()=="content-type"),o=G.FormData&&n instanceof G.FormData,!(0<=Cg(IR,t))||i||o||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,l]of e)this.g.setRequestHeader(a,l);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{dp(this),0<this.B&&((this.L=AR(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Zt(this.ua,this)):this.A=Bl(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){Rd(this,a)}};function AR(n){return Vr&&typeof n.timeout=="number"&&n.ontimeout!==void 0}N.ua=function(){typeof Vl<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,zt(this,"timeout"),this.abort(8))};function Rd(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,hp(n),Yo(n)}function hp(n){n.F||(n.F=!0,zt(n,"complete"),zt(n,"error"))}N.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,zt(this,"complete"),zt(this,"abort"),Yo(this))};N.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Yo(this,!0)),It.$.N.call(this)};N.La=function(){this.s||(this.G||this.v||this.l?fp(this):this.kb())};N.kb=function(){fp(this)};function fp(n){if(n.h&&typeof Vl<"u"&&(!n.C[1]||Ke(n)!=4||n.da()!=2)){if(n.v&&Ke(n)==4)Bl(n.La,0,n);else if(zt(n,"readystatechange"),Ke(n)==4){n.h=!1;try{const l=n.da();t:switch(l){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break t;default:t=!1}var e;if(!(e=t)){var i;if(i=l===0){var o=String(n.I).match(tp)[1]||null;!o&&G.self&&G.self.location&&(o=G.self.location.protocol.slice(0,-1)),i=!wR.test(o?o.toLowerCase():"")}e=i}if(e)zt(n,"complete"),zt(n,"success");else{n.m=6;try{var a=2<Ke(n)?n.g.statusText:""}catch{a=""}n.j=a+" ["+n.da()+"]",hp(n)}}finally{Yo(n)}}}}function Yo(n,t){if(n.g){dp(n);const e=n.g,i=n.C[0]?()=>{}:null;n.g=null,n.C=null,t||zt(n,"ready");try{e.onreadystatechange=i}catch{}}}function dp(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(G.clearTimeout(n.A),n.A=null)}N.isActive=function(){return!!this.g};function Ke(n){return n.g?n.g.readyState:0}N.da=function(){try{return 2<Ke(this)?this.g.status:-1}catch{return-1}};N.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};N.Wa=function(n){if(this.g){var t=this.g.responseText;return n&&t.indexOf(n)==0&&(t=t.substring(n.length)),TR(t)}};function Sd(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case cp:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function RR(n){const t={};n=(n.g&&2<=Ke(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let i=0;i<n.length;i++){if(Di(n[i]))continue;var e=Y1(n[i]);const o=e[0];if(e=e[1],typeof e!="string")continue;e=e.trim();const a=t[o]||[];t[o]=a,a.push(e)}W1(t,function(i){return i.join(", ")})}N.Ia=function(){return this.m};N.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function gp(n){let t="";return bl(n,function(e,i){t+=i,t+=":",t+=e,t+=`\r
`}),t}function Hl(n,t,e){t:{for(i in e){var i=!1;break t}i=!0}i||(e=gp(e),typeof n=="string"?e!=null&&encodeURIComponent(String(e)):pt(n,t,e))}function mi(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function pp(n){this.Ga=0,this.j=[],this.l=new Wo,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=mi("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=mi("baseRetryDelayMs",5e3,n),this.hb=mi("retryDelaySeedMs",1e4,n),this.eb=mi("forwardChannelMaxRetries",2,n),this.xa=mi("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new ip(n&&n.concurrentRequestLimit),this.Ja=new yR,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}N=pp.prototype;N.ra=8;N.H=1;function Kl(n){if(mp(n),n.H==3){var t=n.W++,e=cn(n.I);if(pt(e,"SID",n.K),pt(e,"RID",t),pt(e,"TYPE","terminate"),Ji(n,e),t=new Qi(n,n.l,t),t.L=2,t.v=Qo(cn(e)),e=!1,G.navigator&&G.navigator.sendBeacon)try{e=G.navigator.sendBeacon(t.v.toString(),"")}catch{}!e&&G.Image&&(new Image().src=t.v,e=!0),e||(t.g=Ap(t.l,null),t.g.ha(t.v)),t.G=Date.now(),ji(t)}wp(n)}function Xo(n){n.g&&(jl(n),n.g.cancel(),n.g=null)}function mp(n){Xo(n),n.u&&(G.clearTimeout(n.u),n.u=null),So(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&G.clearTimeout(n.m),n.m=null)}function Jo(n){if(!sp(n.i)&&!n.m){n.m=!0;var t=n.Na;bi||Ug(),Ni||(bi(),Ni=!0),Fl.add(t,n),n.C=0}}function SR(n,t){return op(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=t.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=Hi(Zt(n.Na,n,t),Tp(n,n.C)),n.C++,!0)}N.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const o=new Qi(this,this.l,n);let a=this.s;if(this.U&&(a?(a=xg(a),bg(a,this.U)):a=this.U),this.o!==null||this.O||(o.I=a,a=null),this.P)t:{for(var t=0,e=0;e<this.j.length;e++){e:{var i=this.j[e];if("__data__"in i.map&&(i=i.map.__data__,typeof i=="string")){i=i.length;break e}i=void 0}if(i===void 0)break;if(t+=i,4096<t){t=e;break t}if(t===4096||e===this.j.length-1){t=e+1;break t}}t=1e3}else t=1e3;t=_p(this,o,t),e=cn(this.I),pt(e,"RID",n),pt(e,"CVER",22),this.F&&pt(e,"X-HTTP-Session-Id",this.F),Ji(this,e),a&&(this.O?t="headers="+encodeURIComponent(String(gp(a)))+"&"+t:this.o&&Hl(e,this.o,a)),zl(this.i,o),this.bb&&pt(e,"TYPE","init"),this.P?(pt(e,"$req",t),pt(e,"SID","null"),o.aa=!0,cl(o,e,null)):cl(o,e,t),this.H=2}}else this.H==3&&(n?Cd(this,n):this.j.length==0||sp(this.i)||Cd(this))};function Cd(n,t){var e;t?e=t.m:e=n.W++;const i=cn(n.I);pt(i,"SID",n.K),pt(i,"RID",e),pt(i,"AID",n.V),Ji(n,i),n.o&&n.s&&Hl(i,n.o,n.s),e=new Qi(n,n.l,e,n.C+1),n.o===null&&(e.I=n.s),t&&(n.j=t.F.concat(n.j)),t=_p(n,e,1e3),e.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),zl(n.i,e),cl(e,i,t)}function Ji(n,t){n.na&&bl(n.na,function(e,i){pt(t,i,e)}),n.h&&Zg({},function(e,i){pt(t,i,e)})}function _p(n,t,e){e=Math.min(n.j.length,e);var i=n.h?Zt(n.h.Va,n.h,n):null;t:{var o=n.j;let a=-1;for(;;){const l=["count="+e];a==-1?0<e?(a=o[0].g,l.push("ofs="+a)):a=0:l.push("ofs="+a);let h=!0;for(let d=0;d<e;d++){let m=o[d].g;const _=o[d].map;if(m-=a,0>m)a=Math.max(0,o[d].g-100),h=!1;else try{vR(_,l,"req"+m+"_")}catch{i&&i(_)}}if(h){i=l.join("&");break t}}}return n=n.j.splice(0,e),t.F=n,i}function yp(n){if(!n.g&&!n.u){n.ba=1;var t=n.Ma;bi||Ug(),Ni||(bi(),Ni=!0),Fl.add(t,n),n.A=0}}function Ql(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=Hi(Zt(n.Ma,n),Tp(n,n.A)),n.A++,!0)}N.Ma=function(){if(this.u=null,vp(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=Hi(Zt(this.jb,this),n)}};N.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,se(10),Xo(this),vp(this))};function jl(n){n.B!=null&&(G.clearTimeout(n.B),n.B=null)}function vp(n){n.g=new Qi(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var t=cn(n.wa);pt(t,"RID","rpc"),pt(t,"SID",n.K),pt(t,"AID",n.V),pt(t,"CI",n.G?"0":"1"),!n.G&&n.qa&&pt(t,"TO",n.qa),pt(t,"TYPE","xmlhttp"),Ji(n,t),n.o&&n.s&&Hl(t,n.o,n.s),n.L&&n.g.setTimeout(n.L);var e=n.g;n=n.pa,e.L=1,e.v=Qo(cn(t)),e.s=null,e.S=!0,jg(e,n)}N.ib=function(){this.v!=null&&(this.v=null,Xo(this),Ql(this),se(19))};function So(n){n.v!=null&&(G.clearTimeout(n.v),n.v=null)}function Ep(n,t){var e=null;if(n.g==t){So(n),jl(n),n.g=null;var i=2}else if(fl(n.i,t))e=t.F,ap(n.i,t),i=1;else return;if(n.H!=0){if(t.i)if(i==1){e=t.s?t.s.length:0,t=Date.now()-t.G;var o=n.C;i=zo(),zt(i,new Gg(i,e)),Jo(n)}else yp(n);else if(o=t.o,o==3||o==0&&0<t.ca||!(i==1&&SR(n,t)||i==2&&Ql(n)))switch(e&&0<e.length&&(t=n.i,t.i=t.i.concat(e)),o){case 1:Gn(n,5);break;case 4:Gn(n,10);break;case 3:Gn(n,6);break;default:Gn(n,2)}}}function Tp(n,t){let e=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(e*=2),e*t}function Gn(n,t){if(n.l.info("Error code "+t),t==2){var e=null;n.h&&(e=null);var i=Zt(n.pb,n);e||(e=new Kn("//www.google.com/images/cleardot.gif"),G.location&&G.location.protocol=="http"||Ao(e,"https"),Qo(e)),ER(e.toString(),i)}else se(2);n.H=0,n.h&&n.h.za(t),wp(n),mp(n)}N.pb=function(n){n?(this.l.info("Successfully pinged google.com"),se(2)):(this.l.info("Failed to ping google.com"),se(1))};function wp(n){if(n.H=0,n.ma=[],n.h){const t=up(n.i);(t.length!=0||n.j.length!=0)&&(_d(n.ma,t),_d(n.ma,n.j),n.i.i.length=0,Dl(n.j),n.j.length=0),n.h.ya()}}function Ip(n,t,e){var i=e instanceof Kn?cn(e):new Kn(e);if(i.g!="")t&&(i.g=t+"."+i.g),Ro(i,i.m);else{var o=G.location;i=o.protocol,t=t?t+"."+o.hostname:o.hostname,o=+o.port;var a=new Kn(null);i&&Ao(a,i),t&&(a.g=t),o&&Ro(a,o),e&&(a.l=e),i=a}return e=n.F,t=n.Da,e&&t&&pt(i,e,t),pt(i,"VER",n.ra),Ji(n,i),i}function Ap(n,t,e){if(t&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return t=e&&n.Ha&&!n.va?new It(new Yi({ob:!0})):new It(n.va),t.Oa(n.J),t}N.isActive=function(){return!!this.h&&this.h.isActive(this)};function Rp(){}N=Rp.prototype;N.Ba=function(){};N.Aa=function(){};N.za=function(){};N.ya=function(){};N.isActive=function(){return!0};N.Va=function(){};function Co(){if(Vr&&!(10<=Number(U1)))throw Error("Environmental error: no available transport.")}Co.prototype.g=function(n,t){return new _e(n,t)};function _e(n,t){Mt.call(this),this.g=new pp(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(n?n["X-WebChannel-Client-Profile"]=t.Ca:n={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=n,(n=t&&t.cc)&&!Di(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Di(t)&&(this.g.F=t,n=this.h,n!==null&&t in n&&(n=this.h,t in n&&delete n[t])),this.j=new Ur(this)}Lt(_e,Mt);_e.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,t=this.l,e=this.h||void 0;se(0),n.Y=t,n.na=e||{},n.G=n.aa,n.I=Ip(n,null,n.Y),Jo(n)};_e.prototype.close=function(){Kl(this.g)};_e.prototype.u=function(n){var t=this.g;if(typeof n=="string"){var e={};e.__data__=n,n=e}else this.v&&(e={},e.__data__=kl(n),n=e);t.j.push(new pR(t.fb++,n)),t.H==3&&Jo(t)};_e.prototype.N=function(){this.g.h=null,delete this.j,Kl(this.g),delete this.g,_e.$.N.call(this)};function Sp(n){$l.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var t=n.__sm__;if(t){t:{for(const e in t){n=e;break t}n=void 0}(this.i=n)&&(n=this.i,t=t!==null&&n in t?t[n]:void 0),this.data=t}else this.data=n}Lt(Sp,$l);function Cp(){Wl.call(this),this.status=1}Lt(Cp,Wl);function Ur(n){this.g=n}Lt(Ur,Rp);Ur.prototype.Ba=function(){zt(this.g,"a")};Ur.prototype.Aa=function(n){zt(this.g,new Sp(n))};Ur.prototype.za=function(n){zt(this.g,new Cp)};Ur.prototype.ya=function(){zt(this.g,"b")};function CR(){this.blockSize=-1}function Ue(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Lt(Ue,CR);Ue.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Gu(n,t,e){e||(e=0);var i=Array(16);if(typeof t=="string")for(var o=0;16>o;++o)i[o]=t.charCodeAt(e++)|t.charCodeAt(e++)<<8|t.charCodeAt(e++)<<16|t.charCodeAt(e++)<<24;else for(o=0;16>o;++o)i[o]=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;t=n.g[0],e=n.g[1],o=n.g[2];var a=n.g[3],l=t+(a^e&(o^a))+i[0]+3614090360&4294967295;t=e+(l<<7&4294967295|l>>>25),l=a+(o^t&(e^o))+i[1]+3905402710&4294967295,a=t+(l<<12&4294967295|l>>>20),l=o+(e^a&(t^e))+i[2]+606105819&4294967295,o=a+(l<<17&4294967295|l>>>15),l=e+(t^o&(a^t))+i[3]+3250441966&4294967295,e=o+(l<<22&4294967295|l>>>10),l=t+(a^e&(o^a))+i[4]+4118548399&4294967295,t=e+(l<<7&4294967295|l>>>25),l=a+(o^t&(e^o))+i[5]+1200080426&4294967295,a=t+(l<<12&4294967295|l>>>20),l=o+(e^a&(t^e))+i[6]+2821735955&4294967295,o=a+(l<<17&4294967295|l>>>15),l=e+(t^o&(a^t))+i[7]+4249261313&4294967295,e=o+(l<<22&4294967295|l>>>10),l=t+(a^e&(o^a))+i[8]+1770035416&4294967295,t=e+(l<<7&4294967295|l>>>25),l=a+(o^t&(e^o))+i[9]+2336552879&4294967295,a=t+(l<<12&4294967295|l>>>20),l=o+(e^a&(t^e))+i[10]+4294925233&4294967295,o=a+(l<<17&4294967295|l>>>15),l=e+(t^o&(a^t))+i[11]+2304563134&4294967295,e=o+(l<<22&4294967295|l>>>10),l=t+(a^e&(o^a))+i[12]+1804603682&4294967295,t=e+(l<<7&4294967295|l>>>25),l=a+(o^t&(e^o))+i[13]+4254626195&4294967295,a=t+(l<<12&4294967295|l>>>20),l=o+(e^a&(t^e))+i[14]+2792965006&4294967295,o=a+(l<<17&4294967295|l>>>15),l=e+(t^o&(a^t))+i[15]+1236535329&4294967295,e=o+(l<<22&4294967295|l>>>10),l=t+(o^a&(e^o))+i[1]+4129170786&4294967295,t=e+(l<<5&4294967295|l>>>27),l=a+(e^o&(t^e))+i[6]+3225465664&4294967295,a=t+(l<<9&4294967295|l>>>23),l=o+(t^e&(a^t))+i[11]+643717713&4294967295,o=a+(l<<14&4294967295|l>>>18),l=e+(a^t&(o^a))+i[0]+3921069994&4294967295,e=o+(l<<20&4294967295|l>>>12),l=t+(o^a&(e^o))+i[5]+3593408605&4294967295,t=e+(l<<5&4294967295|l>>>27),l=a+(e^o&(t^e))+i[10]+38016083&4294967295,a=t+(l<<9&4294967295|l>>>23),l=o+(t^e&(a^t))+i[15]+3634488961&4294967295,o=a+(l<<14&4294967295|l>>>18),l=e+(a^t&(o^a))+i[4]+3889429448&4294967295,e=o+(l<<20&4294967295|l>>>12),l=t+(o^a&(e^o))+i[9]+568446438&4294967295,t=e+(l<<5&4294967295|l>>>27),l=a+(e^o&(t^e))+i[14]+3275163606&4294967295,a=t+(l<<9&4294967295|l>>>23),l=o+(t^e&(a^t))+i[3]+4107603335&4294967295,o=a+(l<<14&4294967295|l>>>18),l=e+(a^t&(o^a))+i[8]+1163531501&4294967295,e=o+(l<<20&4294967295|l>>>12),l=t+(o^a&(e^o))+i[13]+2850285829&4294967295,t=e+(l<<5&4294967295|l>>>27),l=a+(e^o&(t^e))+i[2]+4243563512&4294967295,a=t+(l<<9&4294967295|l>>>23),l=o+(t^e&(a^t))+i[7]+1735328473&4294967295,o=a+(l<<14&4294967295|l>>>18),l=e+(a^t&(o^a))+i[12]+2368359562&4294967295,e=o+(l<<20&4294967295|l>>>12),l=t+(e^o^a)+i[5]+4294588738&4294967295,t=e+(l<<4&4294967295|l>>>28),l=a+(t^e^o)+i[8]+2272392833&4294967295,a=t+(l<<11&4294967295|l>>>21),l=o+(a^t^e)+i[11]+1839030562&4294967295,o=a+(l<<16&4294967295|l>>>16),l=e+(o^a^t)+i[14]+4259657740&4294967295,e=o+(l<<23&4294967295|l>>>9),l=t+(e^o^a)+i[1]+2763975236&4294967295,t=e+(l<<4&4294967295|l>>>28),l=a+(t^e^o)+i[4]+1272893353&4294967295,a=t+(l<<11&4294967295|l>>>21),l=o+(a^t^e)+i[7]+4139469664&4294967295,o=a+(l<<16&4294967295|l>>>16),l=e+(o^a^t)+i[10]+3200236656&4294967295,e=o+(l<<23&4294967295|l>>>9),l=t+(e^o^a)+i[13]+681279174&4294967295,t=e+(l<<4&4294967295|l>>>28),l=a+(t^e^o)+i[0]+3936430074&4294967295,a=t+(l<<11&4294967295|l>>>21),l=o+(a^t^e)+i[3]+3572445317&4294967295,o=a+(l<<16&4294967295|l>>>16),l=e+(o^a^t)+i[6]+76029189&4294967295,e=o+(l<<23&4294967295|l>>>9),l=t+(e^o^a)+i[9]+3654602809&4294967295,t=e+(l<<4&4294967295|l>>>28),l=a+(t^e^o)+i[12]+3873151461&4294967295,a=t+(l<<11&4294967295|l>>>21),l=o+(a^t^e)+i[15]+530742520&4294967295,o=a+(l<<16&4294967295|l>>>16),l=e+(o^a^t)+i[2]+3299628645&4294967295,e=o+(l<<23&4294967295|l>>>9),l=t+(o^(e|~a))+i[0]+4096336452&4294967295,t=e+(l<<6&4294967295|l>>>26),l=a+(e^(t|~o))+i[7]+1126891415&4294967295,a=t+(l<<10&4294967295|l>>>22),l=o+(t^(a|~e))+i[14]+2878612391&4294967295,o=a+(l<<15&4294967295|l>>>17),l=e+(a^(o|~t))+i[5]+4237533241&4294967295,e=o+(l<<21&4294967295|l>>>11),l=t+(o^(e|~a))+i[12]+1700485571&4294967295,t=e+(l<<6&4294967295|l>>>26),l=a+(e^(t|~o))+i[3]+2399980690&4294967295,a=t+(l<<10&4294967295|l>>>22),l=o+(t^(a|~e))+i[10]+4293915773&4294967295,o=a+(l<<15&4294967295|l>>>17),l=e+(a^(o|~t))+i[1]+2240044497&4294967295,e=o+(l<<21&4294967295|l>>>11),l=t+(o^(e|~a))+i[8]+1873313359&4294967295,t=e+(l<<6&4294967295|l>>>26),l=a+(e^(t|~o))+i[15]+4264355552&4294967295,a=t+(l<<10&4294967295|l>>>22),l=o+(t^(a|~e))+i[6]+2734768916&4294967295,o=a+(l<<15&4294967295|l>>>17),l=e+(a^(o|~t))+i[13]+1309151649&4294967295,e=o+(l<<21&4294967295|l>>>11),l=t+(o^(e|~a))+i[4]+4149444226&4294967295,t=e+(l<<6&4294967295|l>>>26),l=a+(e^(t|~o))+i[11]+3174756917&4294967295,a=t+(l<<10&4294967295|l>>>22),l=o+(t^(a|~e))+i[2]+718787259&4294967295,o=a+(l<<15&4294967295|l>>>17),l=e+(a^(o|~t))+i[9]+3951481745&4294967295,n.g[0]=n.g[0]+t&4294967295,n.g[1]=n.g[1]+(o+(l<<21&4294967295|l>>>11))&4294967295,n.g[2]=n.g[2]+o&4294967295,n.g[3]=n.g[3]+a&4294967295}Ue.prototype.j=function(n,t){t===void 0&&(t=n.length);for(var e=t-this.blockSize,i=this.m,o=this.h,a=0;a<t;){if(o==0)for(;a<=e;)Gu(this,n,a),a+=this.blockSize;if(typeof n=="string"){for(;a<t;)if(i[o++]=n.charCodeAt(a++),o==this.blockSize){Gu(this,i),o=0;break}}else for(;a<t;)if(i[o++]=n[a++],o==this.blockSize){Gu(this,i),o=0;break}}this.h=o,this.i+=t};Ue.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var t=1;t<n.length-8;++t)n[t]=0;var e=8*this.i;for(t=n.length-8;t<n.length;++t)n[t]=e&255,e/=256;for(this.j(n),n=Array(16),t=e=0;4>t;++t)for(var i=0;32>i;i+=8)n[e++]=this.g[t]>>>i&255;return n};function ht(n,t){this.h=t;for(var e=[],i=!0,o=n.length-1;0<=o;o--){var a=n[o]|0;i&&a==t||(e[o]=a,i=!1)}this.g=e}var PR={};function Yl(n){return-128<=n&&128>n?L1(n,function(t){return new ht([t|0],0>t?-1:0)}):new ht([n|0],0>n?-1:0)}function Qe(n){if(isNaN(n)||!isFinite(n))return Rr;if(0>n)return $t(Qe(-n));for(var t=[],e=1,i=0;n>=e;i++)t[i]=n/e|0,e*=dl;return new ht(t,0)}function Pp(n,t){if(n.length==0)throw Error("number format error: empty string");if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(n.charAt(0)=="-")return $t(Pp(n.substring(1),t));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var e=Qe(Math.pow(t,8)),i=Rr,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),l=parseInt(n.substring(o,o+a),t);8>a?(a=Qe(Math.pow(t,a)),i=i.R(a).add(Qe(l))):(i=i.R(e),i=i.add(Qe(l)))}return i}var dl=4294967296,Rr=Yl(0),gl=Yl(1),Pd=Yl(16777216);N=ht.prototype;N.ea=function(){if(Pe(this))return-$t(this).ea();for(var n=0,t=1,e=0;e<this.g.length;e++){var i=this.D(e);n+=(0<=i?i:dl+i)*t,t*=dl}return n};N.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(ln(this))return"0";if(Pe(this))return"-"+$t(this).toString(n);for(var t=Qe(Math.pow(n,6)),e=this,i="";;){var o=Vo(e,t).g;e=Po(e,o.R(t));var a=((0<e.g.length?e.g[0]:e.h)>>>0).toString(n);if(e=o,ln(e))return a+i;for(;6>a.length;)a="0"+a;i=a+i}};N.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function ln(n){if(n.h!=0)return!1;for(var t=0;t<n.g.length;t++)if(n.g[t]!=0)return!1;return!0}function Pe(n){return n.h==-1}N.X=function(n){return n=Po(this,n),Pe(n)?-1:ln(n)?0:1};function $t(n){for(var t=n.g.length,e=[],i=0;i<t;i++)e[i]=~n.g[i];return new ht(e,~n.h).add(gl)}N.abs=function(){return Pe(this)?$t(this):this};N.add=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0,o=0;o<=t;o++){var a=i+(this.D(o)&65535)+(n.D(o)&65535),l=(a>>>16)+(this.D(o)>>>16)+(n.D(o)>>>16);i=l>>>16,a&=65535,l&=65535,e[o]=l<<16|a}return new ht(e,e[e.length-1]&-2147483648?-1:0)};function Po(n,t){return n.add($t(t))}N.R=function(n){if(ln(this)||ln(n))return Rr;if(Pe(this))return Pe(n)?$t(this).R($t(n)):$t($t(this).R(n));if(Pe(n))return $t(this.R($t(n)));if(0>this.X(Pd)&&0>n.X(Pd))return Qe(this.ea()*n.ea());for(var t=this.g.length+n.g.length,e=[],i=0;i<2*t;i++)e[i]=0;for(i=0;i<this.g.length;i++)for(var o=0;o<n.g.length;o++){var a=this.D(i)>>>16,l=this.D(i)&65535,h=n.D(o)>>>16,d=n.D(o)&65535;e[2*i+2*o]+=l*d,uo(e,2*i+2*o),e[2*i+2*o+1]+=a*d,uo(e,2*i+2*o+1),e[2*i+2*o+1]+=l*h,uo(e,2*i+2*o+1),e[2*i+2*o+2]+=a*h,uo(e,2*i+2*o+2)}for(i=0;i<t;i++)e[i]=e[2*i+1]<<16|e[2*i];for(i=t;i<2*t;i++)e[i]=0;return new ht(e,0)};function uo(n,t){for(;(n[t]&65535)!=n[t];)n[t+1]+=n[t]>>>16,n[t]&=65535,t++}function _i(n,t){this.g=n,this.h=t}function Vo(n,t){if(ln(t))throw Error("division by zero");if(ln(n))return new _i(Rr,Rr);if(Pe(n))return t=Vo($t(n),t),new _i($t(t.g),$t(t.h));if(Pe(t))return t=Vo(n,$t(t)),new _i($t(t.g),t.h);if(30<n.g.length){if(Pe(n)||Pe(t))throw Error("slowDivide_ only works with positive integers.");for(var e=gl,i=t;0>=i.X(n);)e=Vd(e),i=Vd(i);var o=vr(e,1),a=vr(i,1);for(i=vr(i,2),e=vr(e,2);!ln(i);){var l=a.add(i);0>=l.X(n)&&(o=o.add(e),a=l),i=vr(i,1),e=vr(e,1)}return t=Po(n,o.R(t)),new _i(o,t)}for(o=Rr;0<=n.X(t);){for(e=Math.max(1,Math.floor(n.ea()/t.ea())),i=Math.ceil(Math.log(e)/Math.LN2),i=48>=i?1:Math.pow(2,i-48),a=Qe(e),l=a.R(t);Pe(l)||0<l.X(n);)e-=i,a=Qe(e),l=a.R(t);ln(a)&&(a=gl),o=o.add(a),n=Po(n,l)}return new _i(o,n)}N.gb=function(n){return Vo(this,n).h};N.and=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0;i<t;i++)e[i]=this.D(i)&n.D(i);return new ht(e,this.h&n.h)};N.or=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0;i<t;i++)e[i]=this.D(i)|n.D(i);return new ht(e,this.h|n.h)};N.xor=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0;i<t;i++)e[i]=this.D(i)^n.D(i);return new ht(e,this.h^n.h)};function Vd(n){for(var t=n.g.length+1,e=[],i=0;i<t;i++)e[i]=n.D(i)<<1|n.D(i-1)>>>31;return new ht(e,n.h)}function vr(n,t){var e=t>>5;t%=32;for(var i=n.g.length-e,o=[],a=0;a<i;a++)o[a]=0<t?n.D(a+e)>>>t|n.D(a+e+1)<<32-t:n.D(a+e);return new ht(o,n.h)}Co.prototype.createWebChannel=Co.prototype.g;_e.prototype.send=_e.prototype.u;_e.prototype.open=_e.prototype.m;_e.prototype.close=_e.prototype.close;Go.NO_ERROR=0;Go.TIMEOUT=8;Go.HTTP_ERROR=6;Hg.COMPLETE="complete";Kg.EventType=Ki;Ki.OPEN="a";Ki.CLOSE="b";Ki.ERROR="c";Ki.MESSAGE="d";Mt.prototype.listen=Mt.prototype.O;It.prototype.listenOnce=It.prototype.P;It.prototype.getLastError=It.prototype.Sa;It.prototype.getLastErrorCode=It.prototype.Ia;It.prototype.getStatus=It.prototype.da;It.prototype.getResponseJson=It.prototype.Wa;It.prototype.getResponseText=It.prototype.ja;It.prototype.send=It.prototype.ha;It.prototype.setWithCredentials=It.prototype.Oa;Ue.prototype.digest=Ue.prototype.l;Ue.prototype.reset=Ue.prototype.reset;Ue.prototype.update=Ue.prototype.j;ht.prototype.add=ht.prototype.add;ht.prototype.multiply=ht.prototype.R;ht.prototype.modulo=ht.prototype.gb;ht.prototype.compare=ht.prototype.X;ht.prototype.toNumber=ht.prototype.ea;ht.prototype.toString=ht.prototype.toString;ht.prototype.getBits=ht.prototype.D;ht.fromNumber=Qe;ht.fromString=Pp;var VR=function(){return new Co},DR=function(){return zo()},Hu=Go,xR=Hg,bR=Zn,Dd={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},NR=Yi,lo=Kg,OR=It,MR=Ue,Sr=ht;const xd="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Br="10.5.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jn=new Tg("@firebase/firestore");function yi(){return jn.logLevel}function M(n,...t){if(jn.logLevel<=st.DEBUG){const e=t.map(Xl);jn.debug(`Firestore (${Br}): ${n}`,...e)}}function hn(n,...t){if(jn.logLevel<=st.ERROR){const e=t.map(Xl);jn.error(`Firestore (${Br}): ${n}`,...e)}}function Dr(n,...t){if(jn.logLevel<=st.WARN){const e=t.map(Xl);jn.warn(`Firestore (${Br}): ${n}`,...e)}}function Xl(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(n="Unexpected state"){const t=`FIRESTORE (${Br}) INTERNAL ASSERTION FAILED: `+n;throw hn(t),new Error(t)}function _t(n,t){n||W()}function j(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends kr{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class LR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Xt.UNAUTHENTICATED))}shutdown(){}}class kR{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class FR{constructor(t){this.t=t,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let i=this.i;const o=d=>this.i!==i?(i=this.i,e(d)):Promise.resolve();let a=new Sn;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Sn,t.enqueueRetryable(()=>o(this.currentUser))};const l=()=>{const d=a;t.enqueueRetryable(async()=>{await d.promise,await o(this.currentUser)})},h=d=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.auth.addAuthTokenListener(this.o),l()};this.t.onInit(d=>h(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?h(d):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Sn)}},0),l()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(i=>this.i!==t?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(_t(typeof i.accessToken=="string"),new Vp(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return _t(t===null||typeof t=="string"),new Xt(t)}}class UR{constructor(t,e,i){this.l=t,this.h=e,this.P=i,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class BR{constructor(t,e,i){this.l=t,this.h=e,this.P=i}getToken(){return Promise.resolve(new UR(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable(()=>e(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class qR{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $R{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const i=a=>{a.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.R;return this.R=a.token,M("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?e(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable(()=>i(a))};const o=a=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>o(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?o(a):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(_t(typeof e.token=="string"),this.R=e.token,new qR(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let i="";for(;i.length<20;){const o=WR(40);for(let a=0;a<o.length;++a)i.length<20&&o[a]<e&&(i+=t.charAt(o[a]%t.length))}return i}}function at(n,t){return n<t?-1:n>t?1:0}function xr(n,t,e){return n.length===t.length&&n.every((i,o)=>e(i,t[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new L(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new L(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new L(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new L(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return xt.fromMillis(Date.now())}static fromDate(t){return xt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*e));return new xt(e,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?at(this.nanoseconds,t.nanoseconds):at(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(t){this.timestamp=t}static fromTimestamp(t){return new K(t)}static min(){return new K(new xt(0,0))}static max(){return new K(new xt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(t,e,i){e===void 0?e=0:e>t.length&&W(),i===void 0?i=t.length-e:i>t.length-e&&W(),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return Fi.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Fi?t.forEach(i=>{e.push(i)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let o=0;o<i;o++){const a=t.get(o),l=e.get(o);if(a<l)return-1;if(a>l)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class mt extends Fi{construct(t,e,i){return new mt(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new L(C.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(o=>o.length>0))}return new mt(e)}static emptyPath(){return new mt([])}}const zR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Wt extends Fi{construct(t,e,i){return new Wt(t,e,i)}static isValidIdentifier(t){return zR.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Wt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Wt(["__name__"])}static fromServerFormat(t){const e=[];let i="",o=0;const a=()=>{if(i.length===0)throw new L(C.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let l=!1;for(;o<t.length;){const h=t[o];if(h==="\\"){if(o+1===t.length)throw new L(C.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const d=t[o+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new L(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=d,o+=2}else h==="`"?(l=!l,o++):h!=="."||l?(i+=h,o++):(a(),o++)}if(a(),l)throw new L(C.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Wt(e)}static emptyPath(){return new Wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(t){this.path=t}static fromPath(t){return new U(mt.fromString(t))}static fromName(t){return new U(mt.fromString(t).popFirst(5))}static empty(){return new U(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&mt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return mt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new U(new mt(t.slice()))}}function GR(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=K.fromTimestamp(i===1e9?new xt(e+1,0):new xt(e,i));return new Pn(o,U.empty(),t)}function HR(n){return new Pn(n.readTime,n.key,-1)}class Pn{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new Pn(K.min(),U.empty(),-1)}static max(){return new Pn(K.max(),U.empty(),-1)}}function KR(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=U.comparator(n.documentKey,t.documentKey),e!==0?e:at(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zi(n){if(n.code!==C.FAILED_PRECONDITION||n.message!==QR)throw n;M("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new D((i,o)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(i,o)},this.catchCallback=a=>{this.wrapFailure(e,a).next(i,o)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof D?e:D.resolve(e)}catch(e){return D.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):D.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):D.reject(e)}static resolve(t){return new D((e,i)=>{e(t)})}static reject(t){return new D((e,i)=>{i(t)})}static waitFor(t){return new D((e,i)=>{let o=0,a=0,l=!1;t.forEach(h=>{++o,h.next(()=>{++a,l&&a===o&&e()},d=>i(d))}),l=!0,a===o&&e()})}static or(t){let e=D.resolve(!1);for(const i of t)e=e.next(o=>o?D.resolve(o):i());return e}static forEach(t,e){const i=[];return t.forEach((o,a)=>{i.push(e.call(this,o,a))}),this.waitFor(i)}static mapArray(t,e){return new D((i,o)=>{const a=t.length,l=new Array(a);let h=0;for(let d=0;d<a;d++){const m=d;e(t[m]).next(_=>{l[m]=_,++h,h===a&&i(l)},_=>o(_))}})}static doWhile(t,e){return new D((i,o)=>{const a=()=>{t()===!0?e().next(()=>{a()},o):i()};a()})}}function ts(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=i=>this.se(i),this.oe=i=>e.writeSequenceNumber(i))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}Jl._e=-1;function Zo(n){return n==null}function Do(n){return n===0&&1/n==-1/0}function YR(n){return typeof n=="number"&&Number.isInteger(n)&&!Do(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function qr(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function xp(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(t,e){this.comparator=t,this.root=e||qt.EMPTY}insert(t,e){return new Tt(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,qt.BLACK,null,null))}remove(t){return new Tt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,qt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(t,i.key);if(o===0)return e+i.left.size;o<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,i)=>(t(e,i),!1))}toString(){const t=[];return this.inorderTraversal((e,i)=>(t.push(`${e}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new co(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new co(this.root,t,this.comparator,!1)}getReverseIterator(){return new co(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new co(this.root,t,this.comparator,!0)}}class co{constructor(t,e,i,o){this.isReverse=o,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=e?i(t.key,e):1,e&&o&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class qt{constructor(t,e,i,o,a){this.key=t,this.value=e,this.color=i??qt.RED,this.left=o??qt.EMPTY,this.right=a??qt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,o,a){return new qt(t??this.key,e??this.value,i??this.color,o??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let o=this;const a=i(t,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(t,e,i),null):a===0?o.copy(null,e,null,null,null):o.copy(null,null,null,null,o.right.insert(t,e,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return qt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,o=this;if(e(t,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(t,e),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),e(t,o.key)===0){if(o.right.isEmpty())return qt.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(t,e))}return o.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,qt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,qt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();const t=this.left.check();if(t!==this.right.check())throw W();return t+(this.isRed()?0:1)}}qt.EMPTY=null,qt.RED=!0,qt.BLACK=!1;qt.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(t,e,i,o,a){return this}insert(t,e,i){return new qt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(t){this.comparator=t,this.data=new Tt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,i)=>(t(e),!1))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,t[1])>=0)return;e(o.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Nd(this.data.getIterator())}getIteratorFrom(t){return new Nd(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(i=>{e=e.add(i)}),e}isEqual(t){if(!(t instanceof Gt)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const o=e.getNext().key,a=i.getNext().key;if(this.comparator(o,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Gt(this.comparator);return e.data=t,e}}class Nd{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(t){this.fields=t,t.sort(Wt.comparator)}static empty(){return new ke([])}unionWith(t){let e=new Gt(Wt.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new ke(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return xr(this.fields,t.fields,(e,i)=>e.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(o){try{return atob(o)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new bp("Invalid base64 string: "+a):a}}(t);return new ee(e)}static fromUint8Array(t){const e=function(o){let a="";for(let l=0;l<o.length;++l)a+=String.fromCharCode(o[l]);return a}(t);return new ee(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const i=new Uint8Array(e.length);for(let o=0;o<e.length;o++)i[o]=e.charCodeAt(o);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return at(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ee.EMPTY_BYTE_STRING=new ee("");const XR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vn(n){if(_t(!!n),typeof n=="string"){let t=0;const e=XR.exec(n);if(_t(!!e),e[1]){let o=e[1];o=(o+"000000000").substr(0,9),t=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Ct(n.seconds),nanos:Ct(n.nanos)}}function Ct(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Yn(n){return typeof n=="string"?ee.fromBase64String(n):ee.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zl(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="server_timestamp"}function tc(n){const t=n.mapValue.fields.__previous_value__;return Zl(t)?tc(t):t}function Ui(n){const t=Vn(n.mapValue.fields.__local_write_time__.timestampValue);return new xt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(t,e,i,o,a,l,h,d,m){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=o,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=m}}class Bi{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Bi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Bi&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Xn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Zl(n)?4:ZR(n)?9007199254740991:10:W()}function Xe(n,t){if(n===t)return!0;const e=Xn(n);if(e!==Xn(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Ui(n).isEqual(Ui(t));case 3:return function(o,a){if(typeof o.timestampValue=="string"&&typeof a.timestampValue=="string"&&o.timestampValue.length===a.timestampValue.length)return o.timestampValue===a.timestampValue;const l=Vn(o.timestampValue),h=Vn(a.timestampValue);return l.seconds===h.seconds&&l.nanos===h.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(o,a){return Yn(o.bytesValue).isEqual(Yn(a.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(o,a){return Ct(o.geoPointValue.latitude)===Ct(a.geoPointValue.latitude)&&Ct(o.geoPointValue.longitude)===Ct(a.geoPointValue.longitude)}(n,t);case 2:return function(o,a){if("integerValue"in o&&"integerValue"in a)return Ct(o.integerValue)===Ct(a.integerValue);if("doubleValue"in o&&"doubleValue"in a){const l=Ct(o.doubleValue),h=Ct(a.doubleValue);return l===h?Do(l)===Do(h):isNaN(l)&&isNaN(h)}return!1}(n,t);case 9:return xr(n.arrayValue.values||[],t.arrayValue.values||[],Xe);case 10:return function(o,a){const l=o.mapValue.fields||{},h=a.mapValue.fields||{};if(bd(l)!==bd(h))return!1;for(const d in l)if(l.hasOwnProperty(d)&&(h[d]===void 0||!Xe(l[d],h[d])))return!1;return!0}(n,t);default:return W()}}function qi(n,t){return(n.values||[]).find(e=>Xe(e,t))!==void 0}function br(n,t){if(n===t)return 0;const e=Xn(n),i=Xn(t);if(e!==i)return at(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return at(n.booleanValue,t.booleanValue);case 2:return function(a,l){const h=Ct(a.integerValue||a.doubleValue),d=Ct(l.integerValue||l.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1}(n,t);case 3:return Od(n.timestampValue,t.timestampValue);case 4:return Od(Ui(n),Ui(t));case 5:return at(n.stringValue,t.stringValue);case 6:return function(a,l){const h=Yn(a),d=Yn(l);return h.compareTo(d)}(n.bytesValue,t.bytesValue);case 7:return function(a,l){const h=a.split("/"),d=l.split("/");for(let m=0;m<h.length&&m<d.length;m++){const _=at(h[m],d[m]);if(_!==0)return _}return at(h.length,d.length)}(n.referenceValue,t.referenceValue);case 8:return function(a,l){const h=at(Ct(a.latitude),Ct(l.latitude));return h!==0?h:at(Ct(a.longitude),Ct(l.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(a,l){const h=a.values||[],d=l.values||[];for(let m=0;m<h.length&&m<d.length;++m){const _=br(h[m],d[m]);if(_)return _}return at(h.length,d.length)}(n.arrayValue,t.arrayValue);case 10:return function(a,l){if(a===ho.mapValue&&l===ho.mapValue)return 0;if(a===ho.mapValue)return 1;if(l===ho.mapValue)return-1;const h=a.fields||{},d=Object.keys(h),m=l.fields||{},_=Object.keys(m);d.sort(),_.sort();for(let w=0;w<d.length&&w<_.length;++w){const P=at(d[w],_[w]);if(P!==0)return P;const x=br(h[d[w]],m[_[w]]);if(x!==0)return x}return at(d.length,_.length)}(n.mapValue,t.mapValue);default:throw W()}}function Od(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return at(n,t);const e=Vn(n),i=Vn(t),o=at(e.seconds,i.seconds);return o!==0?o:at(e.nanos,i.nanos)}function Nr(n){return pl(n)}function pl(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){const i=Vn(e);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(e){return Yn(e).toBase64()}(n.bytesValue):"referenceValue"in n?function(e){return U.fromName(e).toString()}(n.referenceValue):"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let i="[",o=!0;for(const a of e.values||[])o?o=!1:i+=",",i+=pl(a);return i+"]"}(n.arrayValue):"mapValue"in n?function(e){const i=Object.keys(e.fields||{}).sort();let o="{",a=!0;for(const l of i)a?a=!1:o+=",",o+=`${l}:${pl(e.fields[l])}`;return o+"}"}(n.mapValue):W()}function Md(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function ml(n){return!!n&&"integerValue"in n}function ec(n){return!!n&&"arrayValue"in n}function Ld(n){return!!n&&"nullValue"in n}function kd(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function po(n){return!!n&&"mapValue"in n}function Ai(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return qr(n.mapValue.fields,(e,i)=>t.mapValue.fields[e]=Ai(i)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Ai(n.arrayValue.values[e]);return t}return Object.assign({},n)}function ZR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(t){this.value=t}static empty(){return new Ve({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!po(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ai(e)}setAll(t){let e=Wt.emptyPath(),i={},o=[];t.forEach((l,h)=>{if(!e.isImmediateParentOf(h)){const d=this.getFieldsMap(e);this.applyChanges(d,i,o),i={},o=[],e=h.popLast()}l?i[h.lastSegment()]=Ai(l):o.push(h.lastSegment())});const a=this.getFieldsMap(e);this.applyChanges(a,i,o)}delete(t){const e=this.field(t.popLast());po(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Xe(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let o=e.mapValue.fields[t.get(i)];po(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=o),e=o}return e.mapValue.fields}applyChanges(t,e,i){qr(e,(o,a)=>t[o]=a);for(const o of i)delete t[o]}clone(){return new Ve(Ai(this.value))}}function Np(n){const t=[];return qr(n.fields,(e,i)=>{const o=new Wt([e]);if(po(i)){const a=Np(i.mapValue).fields;if(a.length===0)t.push(o);else for(const l of a)t.push(o.child(l))}else t.push(o)}),new ke(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(t,e,i,o,a,l,h){this.key=t,this.documentType=e,this.version=i,this.readTime=o,this.createTime=a,this.data=l,this.documentState=h}static newInvalidDocument(t){return new Jt(t,0,K.min(),K.min(),K.min(),Ve.empty(),0)}static newFoundDocument(t,e,i,o){return new Jt(t,1,e,K.min(),i,o,0)}static newNoDocument(t,e){return new Jt(t,2,e,K.min(),K.min(),Ve.empty(),0)}static newUnknownDocument(t,e){return new Jt(t,3,e,K.min(),K.min(),Ve.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ve.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ve.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Jt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Jt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(t,e){this.position=t,this.inclusive=e}}function Fd(n,t,e){let i=0;for(let o=0;o<n.position.length;o++){const a=t[o],l=n.position[o];if(a.field.isKeyField()?i=U.comparator(U.fromName(l.referenceValue),e.key):i=br(l,e.data.field(a.field)),a.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ud(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Xe(n.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(t,e="asc"){this.field=t,this.dir=e}}function tS(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{}class Pt extends Op{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new nS(t,e,i):e==="array-contains"?new sS(t,i):e==="in"?new oS(t,i):e==="not-in"?new aS(t,i):e==="array-contains-any"?new uS(t,i):new Pt(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new rS(t,i):new iS(t,i)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&this.matchesComparison(br(e,this.value)):e!==null&&Xn(this.value)===Xn(e)&&this.matchesComparison(br(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return W()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Be extends Op{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new Be(t,e)}matches(t){return Mp(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Mp(n){return n.op==="and"}function Lp(n){return eS(n)&&Mp(n)}function eS(n){for(const t of n.filters)if(t instanceof Be)return!1;return!0}function _l(n){if(n instanceof Pt)return n.field.canonicalString()+n.op.toString()+Nr(n.value);if(Lp(n))return n.filters.map(t=>_l(t)).join(",");{const t=n.filters.map(e=>_l(e)).join(",");return`${n.op}(${t})`}}function kp(n,t){return n instanceof Pt?function(i,o){return o instanceof Pt&&i.op===o.op&&i.field.isEqual(o.field)&&Xe(i.value,o.value)}(n,t):n instanceof Be?function(i,o){return o instanceof Be&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce((a,l,h)=>a&&kp(l,o.filters[h]),!0):!1}(n,t):void W()}function Fp(n){return n instanceof Pt?function(e){return`${e.field.canonicalString()} ${e.op} ${Nr(e.value)}`}(n):n instanceof Be?function(e){return e.op.toString()+" {"+e.getFilters().map(Fp).join(" ,")+"}"}(n):"Filter"}class nS extends Pt{constructor(t,e,i){super(t,e,i),this.key=U.fromName(i.referenceValue)}matches(t){const e=U.comparator(t.key,this.key);return this.matchesComparison(e)}}class rS extends Pt{constructor(t,e){super(t,"in",e),this.keys=Up("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class iS extends Pt{constructor(t,e){super(t,"not-in",e),this.keys=Up("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Up(n,t){var e;return(((e=t.arrayValue)===null||e===void 0?void 0:e.values)||[]).map(i=>U.fromName(i.referenceValue))}class sS extends Pt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return ec(e)&&qi(e.arrayValue,this.value)}}class oS extends Pt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&qi(this.value.arrayValue,e)}}class aS extends Pt{constructor(t,e){super(t,"not-in",e)}matches(t){if(qi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&!qi(this.value.arrayValue,e)}}class uS extends Pt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!ec(e)||!e.arrayValue.values)&&e.arrayValue.values.some(i=>qi(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(t,e=null,i=[],o=[],a=null,l=null,h=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=o,this.limit=a,this.startAt=l,this.endAt=h,this.ce=null}}function Bd(n,t=null,e=[],i=[],o=null,a=null,l=null){return new lS(n,t,e,i,o,a,l)}function nc(n){const t=j(n);if(t.ce===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(i=>_l(i)).join(","),e+="|ob:",e+=t.orderBy.map(i=>function(a){return a.field.canonicalString()+a.dir}(i)).join(","),Zo(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(i=>Nr(i)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(i=>Nr(i)).join(",")),t.ce=e}return t.ce}function rc(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!tS(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!kp(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!Ud(n.startAt,t.startAt)&&Ud(n.endAt,t.endAt)}function yl(n){return U.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(t,e=null,i=[],o=[],a=null,l="F",h=null,d=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=o,this.limit=a,this.limitType=l,this.startAt=h,this.endAt=d,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function cS(n,t,e,i,o,a,l,h){return new es(n,t,e,i,o,a,l,h)}function Bp(n){return new es(n)}function qd(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function qp(n){return n.collectionGroup!==null}function Ri(n){const t=j(n);if(t.le===null){t.le=[];const e=new Set;for(const a of t.explicitOrderBy)t.le.push(a),e.add(a.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let h=new Gt(Wt.comparator);return l.filters.forEach(d=>{d.getFlattenedFilters().forEach(m=>{m.isInequality()&&(h=h.add(m.field))})}),h})(t).forEach(a=>{e.has(a.canonicalString())||a.isKeyField()||t.le.push(new bo(a,i))}),e.has(Wt.keyField().canonicalString())||t.le.push(new bo(Wt.keyField(),i))}return t.le}function je(n){const t=j(n);return t.he||(t.he=hS(t,Ri(n))),t.he}function hS(n,t){if(n.limitType==="F")return Bd(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(o=>{const a=o.dir==="desc"?"asc":"desc";return new bo(o.field,a)});const e=n.endAt?new xo(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new xo(n.startAt.position,n.startAt.inclusive):null;return Bd(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function vl(n,t){const e=n.filters.concat([t]);return new es(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function El(n,t,e){return new es(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function ta(n,t){return rc(je(n),je(t))&&n.limitType===t.limitType}function $p(n){return`${nc(je(n))}|lt:${n.limitType}`}function Er(n){return`Query(target=${function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map(o=>Fp(o)).join(", ")}]`),Zo(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map(o=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(o)).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(o=>Nr(o)).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(o=>Nr(o)).join(",")),`Target(${i})`}(je(n))}; limitType=${n.limitType})`}function ea(n,t){return t.isFoundDocument()&&function(i,o){const a=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(a):U.isDocumentKey(i.path)?i.path.isEqual(a):i.path.isImmediateParentOf(a)}(n,t)&&function(i,o){for(const a of Ri(i))if(!a.field.isKeyField()&&o.data.field(a.field)===null)return!1;return!0}(n,t)&&function(i,o){for(const a of i.filters)if(!a.matches(o))return!1;return!0}(n,t)&&function(i,o){return!(i.startAt&&!function(l,h,d){const m=Fd(l,h,d);return l.inclusive?m<=0:m<0}(i.startAt,Ri(i),o)||i.endAt&&!function(l,h,d){const m=Fd(l,h,d);return l.inclusive?m>=0:m>0}(i.endAt,Ri(i),o))}(n,t)}function fS(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Wp(n){return(t,e)=>{let i=!1;for(const o of Ri(n)){const a=dS(o,t,e);if(a!==0)return a;i=i||o.field.isKeyField()}return 0}}function dS(n,t,e){const i=n.field.isKeyField()?U.comparator(t.key,e.key):function(a,l,h){const d=l.data.field(a),m=h.data.field(a);return d!==null&&m!==null?br(d,m):W()}(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return W()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i!==void 0){for(const[o,a]of i)if(this.equalsFn(o,t))return a}}has(t){return this.get(t)!==void 0}set(t,e){const i=this.mapKeyFn(t),o=this.inner[i];if(o===void 0)return this.inner[i]=[[t,e]],void this.innerSize++;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],t))return void(o[a]=[t,e]);o.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],t))return i.length===1?delete this.inner[e]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(t){qr(this.inner,(e,i)=>{for(const[o,a]of i)t(o,a)})}isEmpty(){return xp(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS=new Tt(U.comparator);function fn(){return gS}const zp=new Tt(U.comparator);function Ti(...n){let t=zp;for(const e of n)t=t.insert(e.key,e);return t}function Gp(n){let t=zp;return n.forEach((e,i)=>t=t.insert(e,i.overlayedDocument)),t}function Hn(){return Si()}function Hp(){return Si()}function Si(){return new $r(n=>n.toString(),(n,t)=>n.isEqual(t))}const pS=new Tt(U.comparator),mS=new Gt(U.comparator);function nt(...n){let t=mS;for(const e of n)t=t.add(e);return t}const _S=new Gt(at);function yS(){return _S}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kp(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Do(t)?"-0":t}}function Qp(n){return{integerValue:""+n}}function vS(n,t){return YR(t)?Qp(t):Kp(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(){this._=void 0}}function ES(n,t,e){return n instanceof No?function(o,a){const l={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return a&&Zl(a)&&(a=tc(a)),a&&(l.fields.__previous_value__=a),{mapValue:l}}(e,t):n instanceof $i?Yp(n,t):n instanceof Wi?Xp(n,t):function(o,a){const l=jp(o,a),h=$d(l)+$d(o.Ie);return ml(l)&&ml(o.Ie)?Qp(h):Kp(o.serializer,h)}(n,t)}function TS(n,t,e){return n instanceof $i?Yp(n,t):n instanceof Wi?Xp(n,t):e}function jp(n,t){return n instanceof Oo?function(i){return ml(i)||function(a){return!!a&&"doubleValue"in a}(i)}(t)?t:{integerValue:0}:null}class No extends na{}class $i extends na{constructor(t){super(),this.elements=t}}function Yp(n,t){const e=Jp(t);for(const i of n.elements)e.some(o=>Xe(o,i))||e.push(i);return{arrayValue:{values:e}}}class Wi extends na{constructor(t){super(),this.elements=t}}function Xp(n,t){let e=Jp(t);for(const i of n.elements)e=e.filter(o=>!Xe(o,i));return{arrayValue:{values:e}}}class Oo extends na{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function $d(n){return Ct(n.integerValue||n.doubleValue)}function Jp(n){return ec(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function wS(n,t){return n.field.isEqual(t.field)&&function(i,o){return i instanceof $i&&o instanceof $i||i instanceof Wi&&o instanceof Wi?xr(i.elements,o.elements,Xe):i instanceof Oo&&o instanceof Oo?Xe(i.Ie,o.Ie):i instanceof No&&o instanceof No}(n.transform,t.transform)}class IS{constructor(t,e){this.version=t,this.transformResults=e}}class Fe{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Fe}static exists(t){return new Fe(void 0,t)}static updateTime(t){return new Fe(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function mo(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class ra{}function Zp(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new ic(n.key,Fe.none()):new ns(n.key,n.data,Fe.none());{const e=n.data,i=Ve.empty();let o=new Gt(Wt.comparator);for(let a of t.fields)if(!o.has(a)){let l=e.field(a);l===null&&a.length>1&&(a=a.popLast(),l=e.field(a)),l===null?i.delete(a):i.set(a,l),o=o.add(a)}return new tr(n.key,i,new ke(o.toArray()),Fe.none())}}function AS(n,t,e){n instanceof ns?function(o,a,l){const h=o.value.clone(),d=zd(o.fieldTransforms,a,l.transformResults);h.setAll(d),a.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(n,t,e):n instanceof tr?function(o,a,l){if(!mo(o.precondition,a))return void a.convertToUnknownDocument(l.version);const h=zd(o.fieldTransforms,a,l.transformResults),d=a.data;d.setAll(tm(o)),d.setAll(h),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()}(n,t,e):function(o,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()}(0,t,e)}function Ci(n,t,e,i){return n instanceof ns?function(a,l,h,d){if(!mo(a.precondition,l))return h;const m=a.value.clone(),_=Gd(a.fieldTransforms,d,l);return m.setAll(_),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null}(n,t,e,i):n instanceof tr?function(a,l,h,d){if(!mo(a.precondition,l))return h;const m=Gd(a.fieldTransforms,d,l),_=l.data;return _.setAll(tm(a)),_.setAll(m),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),h===null?null:h.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(w=>w.field))}(n,t,e,i):function(a,l,h){return mo(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):h}(n,t,e)}function RS(n,t){let e=null;for(const i of n.fieldTransforms){const o=t.data.field(i.field),a=jp(i.transform,o||null);a!=null&&(e===null&&(e=Ve.empty()),e.set(i.field,a))}return e||null}function Wd(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&xr(i,o,(a,l)=>wS(a,l))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class ns extends ra{constructor(t,e,i,o=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class tr extends ra{constructor(t,e,i,o,a=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=o,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function tm(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}}),t}function zd(n,t,e){const i=new Map;_t(n.length===e.length);for(let o=0;o<e.length;o++){const a=n[o],l=a.transform,h=t.data.field(a.field);i.set(a.field,TS(l,h,e[o]))}return i}function Gd(n,t,e){const i=new Map;for(const o of n){const a=o.transform,l=e.data.field(o.field);i.set(o.field,ES(a,l,t))}return i}class ic extends ra{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class SS extends ra{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(t,e,i,o){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let o=0;o<this.mutations.length;o++){const a=this.mutations[o];a.key.isEqual(t.key)&&AS(a,t,i[o])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=Ci(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=Ci(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=Hp();return this.mutations.forEach(o=>{const a=t.get(o.key),l=a.overlayedDocument;let h=this.applyToLocalView(l,a.mutatedFields);h=e.has(o.key)?null:h;const d=Zp(l,h);d!==null&&i.set(o.key,d),l.isValidDocument()||l.convertToNoDocument(K.min())}),i}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),nt())}isEqual(t){return this.batchId===t.batchId&&xr(this.mutations,t.mutations,(e,i)=>Wd(e,i))&&xr(this.baseMutations,t.baseMutations,(e,i)=>Wd(e,i))}}class sc{constructor(t,e,i,o){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=o}static from(t,e,i){_t(t.mutations.length===i.length);let o=function(){return pS}();const a=t.mutations;for(let l=0;l<a.length;l++)o=o.insert(a[l].key,i[l].version);return new sc(t,e,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St,it;function DS(n){switch(n){default:return W();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function em(n){if(n===void 0)return hn("GRPC error has no .code"),C.UNKNOWN;switch(n){case St.OK:return C.OK;case St.CANCELLED:return C.CANCELLED;case St.UNKNOWN:return C.UNKNOWN;case St.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case St.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case St.INTERNAL:return C.INTERNAL;case St.UNAVAILABLE:return C.UNAVAILABLE;case St.UNAUTHENTICATED:return C.UNAUTHENTICATED;case St.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case St.NOT_FOUND:return C.NOT_FOUND;case St.ALREADY_EXISTS:return C.ALREADY_EXISTS;case St.PERMISSION_DENIED:return C.PERMISSION_DENIED;case St.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case St.ABORTED:return C.ABORTED;case St.OUT_OF_RANGE:return C.OUT_OF_RANGE;case St.UNIMPLEMENTED:return C.UNIMPLEMENTED;case St.DATA_LOSS:return C.DATA_LOSS;default:return W()}}(it=St||(St={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS=new Sr([4294967295,4294967295],0);function Hd(n){const t=xS().encode(n),e=new MR;return e.update(t),new Uint8Array(e.digest())}function Kd(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),i=t.getUint32(4,!0),o=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Sr([e,i],0),new Sr([o,a],0)]}class oc{constructor(t,e,i){if(this.bitmap=t,this.padding=e,this.hashCount=i,e<0||e>=8)throw new wi(`Invalid padding: ${e}`);if(i<0)throw new wi(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new wi(`Invalid hash count: ${i}`);if(t.length===0&&e!==0)throw new wi(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=Sr.fromNumber(this.Te)}de(t,e,i){let o=t.add(e.multiply(Sr.fromNumber(i)));return o.compare(bS)===1&&(o=new Sr([o.getBits(0),o.getBits(1)],0)),o.modulo(this.Ee).toNumber()}Ae(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Te===0)return!1;const e=Hd(t),[i,o]=Kd(e);for(let a=0;a<this.hashCount;a++){const l=this.de(i,o,a);if(!this.Ae(l))return!1}return!0}static create(t,e,i){const o=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),l=new oc(a,o,e);return i.forEach(h=>l.insert(h)),l}insert(t){if(this.Te===0)return;const e=Hd(t),[i,o]=Kd(e);for(let a=0;a<this.hashCount;a++){const l=this.de(i,o,a);this.Re(l)}}Re(t){const e=Math.floor(t/8),i=t%8;this.bitmap[e]|=1<<i}}class wi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(t,e,i,o,a){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,e,i){const o=new Map;return o.set(t,rs.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new ia(K.min(),o,new Tt(at),fn(),nt())}}class rs{constructor(t,e,i,o,a){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new rs(i,e,nt(),nt(),nt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(t,e,i,o){this.Ve=t,this.removedTargetIds=e,this.key=i,this.me=o}}class nm{constructor(t,e){this.targetId=t,this.fe=e}}class rm{constructor(t,e,i=ee.EMPTY_BYTE_STRING,o=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=o}}class Qd{constructor(){this.ge=0,this.pe=Yd(),this.ye=ee.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=nt(),e=nt(),i=nt();return this.pe.forEach((o,a)=>{switch(a){case 0:t=t.add(o);break;case 2:e=e.add(o);break;case 1:i=i.add(o);break;default:W()}}),new rs(this.ye,this.we,t,e,i)}Fe(){this.Se=!1,this.pe=Yd()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}}class NS{constructor(t){this.Le=t,this.ke=new Map,this.qe=fn(),this.Qe=jd(),this.Ke=new Tt(at)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,e=>{const i=this.ze(e);switch(t.state){case 0:this.je(e)&&i.Ce(t.resumeToken);break;case 1:i.Ne(),i.be||i.Fe(),i.Ce(t.resumeToken);break;case 2:i.Ne(),i.be||this.removeTarget(e);break;case 3:this.je(e)&&(i.Be(),i.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),i.Ce(t.resumeToken));break;default:W()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach((i,o)=>{this.je(o)&&e(o)})}Je(t){const e=t.targetId,i=t.fe.count,o=this.Ye(e);if(o){const a=o.target;if(yl(a))if(i===0){const l=new U(a.path);this.We(e,l,Jt.newNoDocument(l,K.min()))}else _t(i===1);else{const l=this.Ze(e);if(l!==i){const h=this.Xe(t),d=h?this.et(h,t,l):1;if(d!==0){this.He(e);const m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,m)}}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:a=0}=e;let l,h;try{l=Yn(i).toUint8Array()}catch(d){if(d instanceof bp)return Dr("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{h=new oc(l,o,a)}catch(d){return Dr(d instanceof wi?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return h.Te===0?null:h}et(t,e,i){return e.fe.count===i-this.rt(t,e.targetId)?0:2}rt(t,e){const i=this.Le.getRemoteKeysForTarget(e);let o=0;return i.forEach(a=>{const l=this.Le.nt(),h=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;t.mightContain(h)||(this.We(e,a,null),o++)}),o}it(t){const e=new Map;this.ke.forEach((a,l)=>{const h=this.Ye(l);if(h){if(a.current&&yl(h.target)){const d=new U(h.target.path);this.qe.get(d)!==null||this.st(l,d)||this.We(l,d,Jt.newNoDocument(d,t))}a.De&&(e.set(l,a.ve()),a.Fe())}});let i=nt();this.Qe.forEach((a,l)=>{let h=!0;l.forEachWhile(d=>{const m=this.Ye(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(i=i.add(a))}),this.qe.forEach((a,l)=>l.setReadTime(t));const o=new ia(t,e,this.Ke,this.qe,i);return this.qe=fn(),this.Qe=jd(),this.Ke=new Tt(at),o}Ue(t,e){if(!this.je(t))return;const i=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,i),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,i){if(!this.je(t))return;const o=this.ze(t);this.st(t,e)?o.Me(e,1):o.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),i&&(this.qe=this.qe.insert(e,i))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new Qd,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new Gt(at),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=this.Ye(t)!==null;return e||M("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}He(t){this.ke.set(t,new Qd),this.Le.getRemoteKeysForTarget(t).forEach(e=>{this.We(t,e,null)})}st(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function jd(){return new Tt(U.comparator)}function Yd(){return new Tt(U.comparator)}const OS=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),MS=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),LS=(()=>({and:"AND",or:"OR"}))();class kS{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Tl(n,t){return n.useProto3Json||Zo(t)?t:{value:t}}function Mo(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function im(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function FS(n,t){return Mo(n,t.toTimestamp())}function Ye(n){return _t(!!n),K.fromTimestamp(function(e){const i=Vn(e);return new xt(i.seconds,i.nanos)}(n))}function ac(n,t){return function(i){return new mt(["projects",i.projectId,"databases",i.database])}(n).child("documents").child(t).canonicalString()}function sm(n){const t=mt.fromString(n);return _t(lm(t)),t}function wl(n,t){return ac(n.databaseId,t.path)}function Ku(n,t){const e=sm(t);if(e.get(1)!==n.databaseId.projectId)throw new L(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new L(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new U(om(e))}function Il(n,t){return ac(n.databaseId,t)}function US(n){const t=sm(n);return t.length===4?mt.emptyPath():om(t)}function Al(n){return new mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function om(n){return _t(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Xd(n,t,e){return{name:wl(n,t),fields:e.value.mapValue.fields}}function BS(n,t){let e;if("targetChange"in t){t.targetChange;const i=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:W()}(t.targetChange.targetChangeType||"NO_CHANGE"),o=t.targetChange.targetIds||[],a=function(m,_){return m.useProto3Json?(_t(_===void 0||typeof _=="string"),ee.fromBase64String(_||"")):(_t(_===void 0||_ instanceof Uint8Array),ee.fromUint8Array(_||new Uint8Array))}(n,t.targetChange.resumeToken),l=t.targetChange.cause,h=l&&function(m){const _=m.code===void 0?C.UNKNOWN:em(m.code);return new L(_,m.message||"")}(l);e=new rm(i,o,a,h||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const o=Ku(n,i.document.name),a=Ye(i.document.updateTime),l=i.document.createTime?Ye(i.document.createTime):K.min(),h=new Ve({mapValue:{fields:i.document.fields}}),d=Jt.newFoundDocument(o,a,l,h),m=i.targetIds||[],_=i.removedTargetIds||[];e=new _o(m,_,d.key,d)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const o=Ku(n,i.document),a=i.readTime?Ye(i.readTime):K.min(),l=Jt.newNoDocument(o,a),h=i.removedTargetIds||[];e=new _o([],h,l.key,l)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const o=Ku(n,i.document),a=i.removedTargetIds||[];e=new _o([],a,o,null)}else{if(!("filter"in t))return W();{t.filter;const i=t.filter;i.targetId;const{count:o=0,unchangedNames:a}=i,l=new VS(o,a),h=i.targetId;e=new nm(h,l)}}return e}function qS(n,t){let e;if(t instanceof ns)e={update:Xd(n,t.key,t.value)};else if(t instanceof ic)e={delete:wl(n,t.key)};else if(t instanceof tr)e={update:Xd(n,t.key,t.data),updateMask:YS(t.fieldMask)};else{if(!(t instanceof SS))return W();e={verify:wl(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(i=>function(a,l){const h=l.transform;if(h instanceof No)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof $i)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Wi)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Oo)return{fieldPath:l.field.canonicalString(),increment:h.Ie};throw W()}(0,i))),t.precondition.isNone||(e.currentDocument=function(o,a){return a.updateTime!==void 0?{updateTime:FS(o,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:W()}(n,t.precondition)),e}function $S(n,t){return n&&n.length>0?(_t(t!==void 0),n.map(e=>function(o,a){let l=o.updateTime?Ye(o.updateTime):Ye(a);return l.isEqual(K.min())&&(l=Ye(a)),new IS(l,o.transformResults||[])}(e,t))):[]}function WS(n,t){return{documents:[Il(n,t.path)]}}function zS(n,t){const e={structuredQuery:{}},i=t.path;t.collectionGroup!==null?(e.parent=Il(n,i),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=Il(n,i.popLast()),e.structuredQuery.from=[{collectionId:i.lastSegment()}]);const o=function(d){if(d.length!==0)return um(Be.create(d,"and"))}(t.filters);o&&(e.structuredQuery.where=o);const a=function(d){if(d.length!==0)return d.map(m=>function(w){return{field:Tr(w.field),direction:KS(w.dir)}}(m))}(t.orderBy);a&&(e.structuredQuery.orderBy=a);const l=Tl(n,t.limit);return l!==null&&(e.structuredQuery.limit=l),t.startAt&&(e.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(t.startAt)),t.endAt&&(e.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(t.endAt)),e}function GS(n){let t=US(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let o=null;if(i>0){_t(i===1);const _=e.from[0];_.allDescendants?o=_.collectionId:t=t.child(_.collectionId)}let a=[];e.where&&(a=function(w){const P=am(w);return P instanceof Be&&Lp(P)?P.getFilters():[P]}(e.where));let l=[];e.orderBy&&(l=function(w){return w.map(P=>function(z){return new bo(wr(z.field),function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(z.direction))}(P))}(e.orderBy));let h=null;e.limit&&(h=function(w){let P;return P=typeof w=="object"?w.value:w,Zo(P)?null:P}(e.limit));let d=null;e.startAt&&(d=function(w){const P=!!w.before,x=w.values||[];return new xo(x,P)}(e.startAt));let m=null;return e.endAt&&(m=function(w){const P=!w.before,x=w.values||[];return new xo(x,P)}(e.endAt)),cS(t,o,l,a,h,"F",d,m)}function HS(n,t){const e=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W()}}(t.purpose);return e==null?null:{"goog-listen-tags":e}}function am(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=wr(e.unaryFilter.field);return Pt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=wr(e.unaryFilter.field);return Pt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=wr(e.unaryFilter.field);return Pt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=wr(e.unaryFilter.field);return Pt.create(l,"!=",{nullValue:"NULL_VALUE"});default:return W()}}(n):n.fieldFilter!==void 0?function(e){return Pt.create(wr(e.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return Be.create(e.compositeFilter.filters.map(i=>am(i)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return W()}}(e.compositeFilter.op))}(n):W()}function KS(n){return OS[n]}function QS(n){return MS[n]}function jS(n){return LS[n]}function Tr(n){return{fieldPath:n.canonicalString()}}function wr(n){return Wt.fromServerFormat(n.fieldPath)}function um(n){return n instanceof Pt?function(e){if(e.op==="=="){if(kd(e.value))return{unaryFilter:{field:Tr(e.field),op:"IS_NAN"}};if(Ld(e.value))return{unaryFilter:{field:Tr(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(kd(e.value))return{unaryFilter:{field:Tr(e.field),op:"IS_NOT_NAN"}};if(Ld(e.value))return{unaryFilter:{field:Tr(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Tr(e.field),op:QS(e.op),value:e.value}}}(n):n instanceof Be?function(e){const i=e.getFilters().map(o=>um(o));return i.length===1?i[0]:{compositeFilter:{op:jS(e.op),filters:i}}}(n):W()}function YS(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function lm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(t,e,i,o,a=K.min(),l=K.min(),h=ee.EMPTY_BYTE_STRING,d=null){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(t){return new In(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new In(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new In(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new In(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(t){this.ut=t}}function JS(n){const t=GS({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?El(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(){this.on=new tC}addToCollectionParentIndex(t,e){return this.on.add(e),D.resolve()}getCollectionParents(t,e){return D.resolve(this.on.getEntries(e))}addFieldIndex(t,e){return D.resolve()}deleteFieldIndex(t,e){return D.resolve()}deleteAllFieldIndexes(t){return D.resolve()}createTargetIndexes(t,e){return D.resolve()}getDocumentsMatchingTarget(t,e){return D.resolve(null)}getIndexType(t,e){return D.resolve(0)}getFieldIndexes(t,e){return D.resolve([])}getNextCollectionGroupToUpdate(t){return D.resolve(null)}getMinOffset(t,e){return D.resolve(Pn.min())}getMinOffsetFromCollectionGroup(t,e){return D.resolve(Pn.min())}updateCollectionGroup(t,e,i){return D.resolve()}updateIndexEntries(t,e){return D.resolve()}}class tC{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),o=this.index[e]||new Gt(mt.comparator),a=!o.has(i);return this.index[e]=o.add(i),a}has(t){const e=t.lastSegment(),i=t.popLast(),o=this.index[e];return o&&o.has(i)}getEntries(t){return(this.index[t]||new Gt(mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(t){this.xn=t}next(){return this.xn+=2,this.xn}static On(){return new Or(0)}static Nn(){return new Or(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(){this.changes=new $r(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Jt.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return i!==void 0?D.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(t,e,i,o){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=o}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next(o=>(i=o,this.remoteDocumentCache.getEntry(t,e))).next(o=>(i!==null&&Ci(i.mutation,o,ke.empty(),xt.now()),o))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.getLocalViewOfDocuments(t,i,nt()).next(()=>i))}getLocalViewOfDocuments(t,e,i=nt()){const o=Hn();return this.populateOverlays(t,o,e).next(()=>this.computeViews(t,e,o,i).next(a=>{let l=Ti();return a.forEach((h,d)=>{l=l.insert(h,d.overlayedDocument)}),l}))}getOverlayedDocuments(t,e){const i=Hn();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,nt()))}populateOverlays(t,e,i){const o=[];return i.forEach(a=>{e.has(a)||o.push(a)}),this.documentOverlayCache.getOverlays(t,o).next(a=>{a.forEach((l,h)=>{e.set(l,h)})})}computeViews(t,e,i,o){let a=fn();const l=Si(),h=function(){return Si()}();return e.forEach((d,m)=>{const _=i.get(m.key);o.has(m.key)&&(_===void 0||_.mutation instanceof tr)?a=a.insert(m.key,m):_!==void 0?(l.set(m.key,_.mutation.getFieldMask()),Ci(_.mutation,m,_.mutation.getFieldMask(),xt.now())):l.set(m.key,ke.empty())}),this.recalculateAndSaveOverlays(t,a).next(d=>(d.forEach((m,_)=>l.set(m,_)),e.forEach((m,_)=>{var w;return h.set(m,new nC(_,(w=l.get(m))!==null&&w!==void 0?w:null))}),h))}recalculateAndSaveOverlays(t,e){const i=Si();let o=new Tt((l,h)=>l-h),a=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(l=>{for(const h of l)h.keys().forEach(d=>{const m=e.get(d);if(m===null)return;let _=i.get(d)||ke.empty();_=h.applyToLocalView(m,_),i.set(d,_);const w=(o.get(h.batchId)||nt()).add(d);o=o.insert(h.batchId,w)})}).next(()=>{const l=[],h=o.getReverseIterator();for(;h.hasNext();){const d=h.getNext(),m=d.key,_=d.value,w=Hp();_.forEach(P=>{if(!a.has(P)){const x=Zp(e.get(P),i.get(P));x!==null&&w.set(P,x),a=a.add(P)}}),l.push(this.documentOverlayCache.saveOverlays(t,m,w))}return D.waitFor(l)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,e,i,o){return function(l){return U.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):qp(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,o):this.getDocumentsMatchingCollectionQuery(t,e,i,o)}getNextDocuments(t,e,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,o).next(a=>{const l=o-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,o-a.size):D.resolve(Hn());let h=-1,d=a;return l.next(m=>D.forEach(m,(_,w)=>(h<w.largestBatchId&&(h=w.largestBatchId),a.get(_)?D.resolve():this.remoteDocumentCache.getEntry(t,_).next(P=>{d=d.insert(_,P)}))).next(()=>this.populateOverlays(t,m,a)).next(()=>this.computeViews(t,d,m,nt())).next(_=>({batchId:h,changes:Gp(_)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new U(e)).next(i=>{let o=Ti();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o})}getDocumentsMatchingCollectionGroupQuery(t,e,i,o){const a=e.collectionGroup;let l=Ti();return this.indexManager.getCollectionParents(t,a).next(h=>D.forEach(h,d=>{const m=function(w,P){return new es(P,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)}(e,d.child(a));return this.getDocumentsMatchingCollectionQuery(t,m,i,o).next(_=>{_.forEach((w,P)=>{l=l.insert(w,P)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(t,e,i,o){let a;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next(l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,a,o))).next(l=>{a.forEach((d,m)=>{const _=m.getKey();l.get(_)===null&&(l=l.insert(_,Jt.newInvalidDocument(_)))});let h=Ti();return l.forEach((d,m)=>{const _=a.get(d);_!==void 0&&Ci(_.mutation,m,ke.empty(),xt.now()),ea(e,m)&&(h=h.insert(d,m))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(t){this.serializer=t,this.ur=new Map,this.cr=new Map}getBundleMetadata(t,e){return D.resolve(this.ur.get(e))}saveBundleMetadata(t,e){return this.ur.set(e.id,function(o){return{id:o.id,version:o.version,createTime:Ye(o.createTime)}}(e)),D.resolve()}getNamedQuery(t,e){return D.resolve(this.cr.get(e))}saveNamedQuery(t,e){return this.cr.set(e.name,function(o){return{name:o.name,query:JS(o.bundledQuery),readTime:Ye(o.readTime)}}(e)),D.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(){this.overlays=new Tt(U.comparator),this.lr=new Map}getOverlay(t,e){return D.resolve(this.overlays.get(e))}getOverlays(t,e){const i=Hn();return D.forEach(e,o=>this.getOverlay(t,o).next(a=>{a!==null&&i.set(o,a)})).next(()=>i)}saveOverlays(t,e,i){return i.forEach((o,a)=>{this.lt(t,e,a)}),D.resolve()}removeOverlaysForBatchId(t,e,i){const o=this.lr.get(i);return o!==void 0&&(o.forEach(a=>this.overlays=this.overlays.remove(a)),this.lr.delete(i)),D.resolve()}getOverlaysForCollection(t,e,i){const o=Hn(),a=e.length+1,l=new U(e.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const d=h.getNext().value,m=d.getKey();if(!e.isPrefixOf(m.path))break;m.path.length===a&&d.largestBatchId>i&&o.set(d.getKey(),d)}return D.resolve(o)}getOverlaysForCollectionGroup(t,e,i,o){let a=new Tt((m,_)=>m-_);const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===e&&m.largestBatchId>i){let _=a.get(m.largestBatchId);_===null&&(_=Hn(),a=a.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const h=Hn(),d=a.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((m,_)=>h.set(m,_)),!(h.size()>=o)););return D.resolve(h)}lt(t,e,i){const o=this.overlays.get(i.key);if(o!==null){const l=this.lr.get(o.largestBatchId).delete(i.key);this.lr.set(o.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new PS(e,i));let a=this.lr.get(e);a===void 0&&(a=nt(),this.lr.set(e,a)),this.lr.set(e,a.add(i.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(){this.hr=new Gt(Ot.Pr),this.Ir=new Gt(Ot.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(t,e){const i=new Ot(t,e);this.hr=this.hr.add(i),this.Ir=this.Ir.add(i)}Er(t,e){t.forEach(i=>this.addReference(i,e))}removeReference(t,e){this.dr(new Ot(t,e))}Ar(t,e){t.forEach(i=>this.removeReference(i,e))}Rr(t){const e=new U(new mt([])),i=new Ot(e,t),o=new Ot(e,t+1),a=[];return this.Ir.forEachInRange([i,o],l=>{this.dr(l),a.push(l.key)}),a}Vr(){this.hr.forEach(t=>this.dr(t))}dr(t){this.hr=this.hr.delete(t),this.Ir=this.Ir.delete(t)}mr(t){const e=new U(new mt([])),i=new Ot(e,t),o=new Ot(e,t+1);let a=nt();return this.Ir.forEachInRange([i,o],l=>{a=a.add(l.key)}),a}containsKey(t){const e=new Ot(t,0),i=this.hr.firstAfterOrEqual(e);return i!==null&&t.isEqual(i.key)}}class Ot{constructor(t,e){this.key=t,this.gr=e}static Pr(t,e){return U.comparator(t.key,e.key)||at(t.gr,e.gr)}static Tr(t,e){return at(t.gr,e.gr)||U.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.pr=1,this.yr=new Gt(Ot.Pr)}checkEmpty(t){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,i,o){const a=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new CS(a,e,i,o);this.mutationQueue.push(l);for(const h of o)this.yr=this.yr.add(new Ot(h.key,a)),this.indexManager.addToCollectionParentIndex(t,h.key.path.popLast());return D.resolve(l)}lookupMutationBatch(t,e){return D.resolve(this.wr(e))}getNextMutationBatchAfterBatchId(t,e){const i=e+1,o=this.Sr(i),a=o<0?0:o;return D.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(t){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new Ot(e,0),o=new Ot(e,Number.POSITIVE_INFINITY),a=[];return this.yr.forEachInRange([i,o],l=>{const h=this.wr(l.gr);a.push(h)}),D.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Gt(at);return e.forEach(o=>{const a=new Ot(o,0),l=new Ot(o,Number.POSITIVE_INFINITY);this.yr.forEachInRange([a,l],h=>{i=i.add(h.gr)})}),D.resolve(this.br(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,o=i.length+1;let a=i;U.isDocumentKey(a)||(a=a.child(""));const l=new Ot(new U(a),0);let h=new Gt(at);return this.yr.forEachWhile(d=>{const m=d.key.path;return!!i.isPrefixOf(m)&&(m.length===o&&(h=h.add(d.gr)),!0)},l),D.resolve(this.br(h))}br(t){const e=[];return t.forEach(i=>{const o=this.wr(i);o!==null&&e.push(o)}),e}removeMutationBatch(t,e){_t(this.Dr(e.batchId,"removed")===0),this.mutationQueue.shift();let i=this.yr;return D.forEach(e.mutations,o=>{const a=new Ot(o.key,e.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,o.key)}).next(()=>{this.yr=i})}Fn(t){}containsKey(t,e){const i=new Ot(e,0),o=this.yr.firstAfterOrEqual(i);return D.resolve(e.isEqual(o&&o.key))}performConsistencyCheck(t){return this.mutationQueue.length,D.resolve()}Dr(t,e){return this.Sr(t)}Sr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}wr(t){const e=this.Sr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(t){this.Cr=t,this.docs=function(){return new Tt(U.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,o=this.docs.get(i),a=o?o.size:0,l=this.Cr(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return D.resolve(i?i.document.mutableCopy():Jt.newInvalidDocument(e))}getEntries(t,e){let i=fn();return e.forEach(o=>{const a=this.docs.get(o);i=i.insert(o,a?a.document.mutableCopy():Jt.newInvalidDocument(o))}),D.resolve(i)}getDocumentsMatchingQuery(t,e,i,o){let a=fn();const l=e.path,h=new U(l.child("")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){const{key:m,value:{document:_}}=d.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||KR(HR(_),i)<=0||(o.has(_.key)||ea(e,_))&&(a=a.insert(_.key,_.mutableCopy()))}return D.resolve(a)}getAllFromCollectionGroup(t,e,i,o){W()}vr(t,e){return D.forEach(this.docs,i=>e(i))}newChangeBuffer(t){return new uC(this)}getSize(t){return D.resolve(this.size)}}class uC extends eC{constructor(t){super(),this._r=t}applyChanges(t){const e=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?e.push(this._r.addEntry(t,o)):this._r.removeEntry(i)}),D.waitFor(e)}getFromCache(t,e){return this._r.getEntry(t,e)}getAllFromCache(t,e){return this._r.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(t){this.persistence=t,this.Fr=new $r(e=>nc(e),rc),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Mr=0,this.Or=new uc,this.targetCount=0,this.Nr=Or.On()}forEachTarget(t,e){return this.Fr.forEach((i,o)=>e(o)),D.resolve()}getLastRemoteSnapshotVersion(t){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return D.resolve(this.Mr)}allocateTargetId(t){return this.highestTargetId=this.Nr.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.Mr&&(this.Mr=e),D.resolve()}kn(t){this.Fr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Nr=new Or(e),this.highestTargetId=e),t.sequenceNumber>this.Mr&&(this.Mr=t.sequenceNumber)}addTargetData(t,e){return this.kn(e),this.targetCount+=1,D.resolve()}updateTargetData(t,e){return this.kn(e),D.resolve()}removeTargetData(t,e){return this.Fr.delete(e.target),this.Or.Rr(e.targetId),this.targetCount-=1,D.resolve()}removeTargets(t,e,i){let o=0;const a=[];return this.Fr.forEach((l,h)=>{h.sequenceNumber<=e&&i.get(h.targetId)===null&&(this.Fr.delete(l),a.push(this.removeMatchingKeysForTargetId(t,h.targetId)),o++)}),D.waitFor(a).next(()=>o)}getTargetCount(t){return D.resolve(this.targetCount)}getTargetData(t,e){const i=this.Fr.get(e)||null;return D.resolve(i)}addMatchingKeys(t,e,i){return this.Or.Er(e,i),D.resolve()}removeMatchingKeys(t,e,i){this.Or.Ar(e,i);const o=this.persistence.referenceDelegate,a=[];return o&&e.forEach(l=>{a.push(o.markPotentiallyOrphaned(t,l))}),D.waitFor(a)}removeMatchingKeysForTargetId(t,e){return this.Or.Rr(e),D.resolve()}getMatchingKeysForTargetId(t,e){const i=this.Or.mr(e);return D.resolve(i)}containsKey(t,e){return D.resolve(this.Or.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(t,e){this.Br={},this.overlays={},this.Lr=new Jl(0),this.kr=!1,this.kr=!0,this.referenceDelegate=t(this),this.qr=new lC(this),this.indexManager=new ZS,this.remoteDocumentCache=function(o){return new aC(o)}(i=>this.referenceDelegate.Qr(i)),this.serializer=new XS(e),this.Kr=new iC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new sC,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.Br[t.toKey()];return i||(i=new oC(e,this.referenceDelegate),this.Br[t.toKey()]=i),i}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(t,e,i){M("MemoryPersistence","Starting transaction:",t);const o=new hC(this.Lr.next());return this.referenceDelegate.$r(),i(o).next(a=>this.referenceDelegate.Ur(o).next(()=>a)).toPromise().then(a=>(o.raiseOnCommittedEvent(),a))}Wr(t,e){return D.or(Object.values(this.Br).map(i=>()=>i.containsKey(t,e)))}}class hC extends jR{constructor(t){super(),this.currentSequenceNumber=t}}class lc{constructor(t){this.persistence=t,this.Gr=new uc,this.zr=null}static jr(t){return new lc(t)}get Hr(){if(this.zr)return this.zr;throw W()}addReference(t,e,i){return this.Gr.addReference(i,e),this.Hr.delete(i.toString()),D.resolve()}removeReference(t,e,i){return this.Gr.removeReference(i,e),this.Hr.add(i.toString()),D.resolve()}markPotentiallyOrphaned(t,e){return this.Hr.add(e.toString()),D.resolve()}removeTarget(t,e){this.Gr.Rr(e.targetId).forEach(o=>this.Hr.add(o.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next(o=>{o.forEach(a=>this.Hr.add(a.toString()))}).next(()=>i.removeTargetData(t,e))}$r(){this.zr=new Set}Ur(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.Hr,i=>{const o=U.fromPath(i);return this.Jr(t,o).next(a=>{a||e.removeEntry(o,K.min())})}).next(()=>(this.zr=null,e.apply(t)))}updateLimboDocument(t,e){return this.Jr(t,e).next(i=>{i?this.Hr.delete(e.toString()):this.Hr.add(e.toString())})}Qr(t){return 0}Jr(t,e){return D.or([()=>D.resolve(this.Gr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Wr(t,e)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(t,e,i,o){this.targetId=t,this.fromCache=e,this.ki=i,this.qi=o}static Qi(t,e){let i=nt(),o=nt();for(const a of e.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:o=o.add(a.doc.key)}return new cc(t,e.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(t,e){this.Gi=t,this.indexManager=e,this.Ki=!0}getDocumentsMatchingQuery(t,e,i,o){const a={result:null};return this.zi(t,e).next(l=>{a.result=l}).next(()=>{if(!a.result)return this.ji(t,e,o,i).next(l=>{a.result=l})}).next(()=>{if(a.result)return;const l=new fC;return this.Hi(t,e,l).next(h=>{if(a.result=h,this.$i)return this.Ji(t,e,l,h.size)})}).next(()=>a.result)}Ji(t,e,i,o){return i.documentReadCount<this.Ui?(yi()<=st.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",Er(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),D.resolve()):(yi()<=st.DEBUG&&M("QueryEngine","Query:",Er(e),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.Wi*o?(yi()<=st.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",Er(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,je(e))):D.resolve())}zi(t,e){if(qd(e))return D.resolve(null);let i=je(e);return this.indexManager.getIndexType(t,i).next(o=>o===0?null:(e.limit!==null&&o===1&&(e=El(e,null,"F"),i=je(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next(a=>{const l=nt(...a);return this.Gi.getDocuments(t,l).next(h=>this.indexManager.getMinOffset(t,i).next(d=>{const m=this.Yi(e,h);return this.Zi(e,m,l,d.readTime)?this.zi(t,El(e,null,"F")):this.Xi(t,m,e,d)}))})))}ji(t,e,i,o){return qd(e)||o.isEqual(K.min())?D.resolve(null):this.Gi.getDocuments(t,i).next(a=>{const l=this.Yi(e,a);return this.Zi(e,l,i,o)?D.resolve(null):(yi()<=st.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Er(e)),this.Xi(t,l,e,GR(o,-1)).next(h=>h))})}Yi(t,e){let i=new Gt(Wp(t));return e.forEach((o,a)=>{ea(t,a)&&(i=i.add(a))}),i}Zi(t,e,i,o){if(t.limit===null)return!1;if(i.size!==e.size)return!0;const a=t.limitType==="F"?e.last():e.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(o)>0)}Hi(t,e,i){return yi()<=st.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",Er(e)),this.Gi.getDocumentsMatchingQuery(t,e,Pn.min(),i)}Xi(t,e,i,o){return this.Gi.getDocumentsMatchingQuery(t,i,o).next(a=>(e.forEach(l=>{a=a.insert(l.key,l)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(t,e,i,o){this.persistence=t,this.es=e,this.serializer=o,this.ts=new Tt(at),this.ns=new $r(a=>nc(a),rc),this.rs=new Map,this.ss=t.getRemoteDocumentCache(),this.qr=t.getTargetCache(),this.Kr=t.getBundleCache(),this.os(i)}os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new rC(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.ts))}}function pC(n,t,e,i){return new gC(n,t,e,i)}async function cm(n,t){const e=j(n);return await e.persistence.runTransaction("Handle user change","readonly",i=>{let o;return e.mutationQueue.getAllMutationBatches(i).next(a=>(o=a,e.os(t),e.mutationQueue.getAllMutationBatches(i))).next(a=>{const l=[],h=[];let d=nt();for(const m of o){l.push(m.batchId);for(const _ of m.mutations)d=d.add(_.key)}for(const m of a){h.push(m.batchId);for(const _ of m.mutations)d=d.add(_.key)}return e.localDocuments.getDocuments(i,d).next(m=>({_s:m,removedBatchIds:l,addedBatchIds:h}))})})}function mC(n,t){const e=j(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const o=t.batch.keys(),a=e.ss.newChangeBuffer({trackRemovals:!0});return function(h,d,m,_){const w=m.batch,P=w.keys();let x=D.resolve();return P.forEach(z=>{x=x.next(()=>_.getEntry(d,z)).next(X=>{const F=m.docVersions.get(z);_t(F!==null),X.version.compareTo(F)<0&&(w.applyToRemoteDocument(X,m),X.isValidDocument()&&(X.setReadTime(m.commitVersion),_.addEntry(X)))})}),x.next(()=>h.mutationQueue.removeMutationBatch(d,w))}(e,i,t,a).next(()=>a.apply(i)).next(()=>e.mutationQueue.performConsistencyCheck(i)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(i,o,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(h){let d=nt();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(d=d.add(h.batch.mutations[m].key));return d}(t))).next(()=>e.localDocuments.getDocuments(i,o))})}function hm(n){const t=j(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.qr.getLastRemoteSnapshotVersion(e))}function _C(n,t){const e=j(n),i=t.snapshotVersion;let o=e.ts;return e.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=e.ss.newChangeBuffer({trackRemovals:!0});o=e.ts;const h=[];t.targetChanges.forEach((_,w)=>{const P=o.get(w);if(!P)return;h.push(e.qr.removeMatchingKeys(a,_.removedDocuments,w).next(()=>e.qr.addMatchingKeys(a,_.addedDocuments,w)));let x=P.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(w)!==null?x=x.withResumeToken(ee.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):_.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(_.resumeToken,i)),o=o.insert(w,x),function(X,F,lt){return X.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-X.snapshotVersion.toMicroseconds()>=3e8?!0:lt.addedDocuments.size+lt.modifiedDocuments.size+lt.removedDocuments.size>0}(P,x,_)&&h.push(e.qr.updateTargetData(a,x))});let d=fn(),m=nt();if(t.documentUpdates.forEach(_=>{t.resolvedLimboDocuments.has(_)&&h.push(e.persistence.referenceDelegate.updateLimboDocument(a,_))}),h.push(yC(a,l,t.documentUpdates).next(_=>{d=_.us,m=_.cs})),!i.isEqual(K.min())){const _=e.qr.getLastRemoteSnapshotVersion(a).next(w=>e.qr.setTargetsMetadata(a,a.currentSequenceNumber,i));h.push(_)}return D.waitFor(h).next(()=>l.apply(a)).next(()=>e.localDocuments.getLocalViewOfDocuments(a,d,m)).next(()=>d)}).then(a=>(e.ts=o,a))}function yC(n,t,e){let i=nt(),o=nt();return e.forEach(a=>i=i.add(a)),t.getEntries(n,i).next(a=>{let l=fn();return e.forEach((h,d)=>{const m=a.get(h);d.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(h)),d.isNoDocument()&&d.version.isEqual(K.min())?(t.removeEntry(h,d.readTime),l=l.insert(h,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(t.addEntry(d),l=l.insert(h,d)):M("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",d.version)}),{us:l,cs:o}})}function vC(n,t){const e=j(n);return e.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function EC(n,t){const e=j(n);return e.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return e.qr.getTargetData(i,t).next(a=>a?(o=a,D.resolve(o)):e.qr.allocateTargetId(i).next(l=>(o=new In(t,l,"TargetPurposeListen",i.currentSequenceNumber),e.qr.addTargetData(i,o).next(()=>o))))}).then(i=>{const o=e.ts.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(e.ts=e.ts.insert(i.targetId,i),e.ns.set(t,i.targetId)),i})}async function Rl(n,t,e){const i=j(n),o=i.ts.get(t),a=e?"readwrite":"readwrite-primary";try{e||await i.persistence.runTransaction("Release target",a,l=>i.persistence.referenceDelegate.removeTarget(l,o))}catch(l){if(!ts(l))throw l;M("LocalStore",`Failed to update sequence numbers for target ${t}: ${l}`)}i.ts=i.ts.remove(t),i.ns.delete(o.target)}function Jd(n,t,e){const i=j(n);let o=K.min(),a=nt();return i.persistence.runTransaction("Execute query","readwrite",l=>function(d,m,_){const w=j(d),P=w.ns.get(_);return P!==void 0?D.resolve(w.ts.get(P)):w.qr.getTargetData(m,_)}(i,l,je(t)).next(h=>{if(h)return o=h.lastLimboFreeSnapshotVersion,i.qr.getMatchingKeysForTargetId(l,h.targetId).next(d=>{a=d})}).next(()=>i.es.getDocumentsMatchingQuery(l,t,e?o:K.min(),e?a:nt())).next(h=>(TC(i,fS(t),h),{documents:h,ls:a})))}function TC(n,t,e){let i=n.rs.get(t)||K.min();e.forEach((o,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)}),n.rs.set(t,i)}class Zd{constructor(){this.activeTargetIds=yS()}ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}As(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Es(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class wC{constructor(){this.eo=new Zd,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t){return this.eo.ds(t),this.no[t]||"not-current"}updateQueryState(t,e,i){this.no[t]=e}removeLocalQueryTarget(t){this.eo.As(t)}isLocalQueryTarget(t){return this.eo.activeTargetIds.has(t)}clearQueryState(t){delete this.no[t]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(t){return this.eo.activeTargetIds.has(t)}start(){return this.eo=new Zd,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{ro(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(t){this.ao.push(t)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ao)t(0)}_o(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ao)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fo=null;function Qu(){return fo===null?fo=function(){return 268435456+Math.round(2147483648*Math.random())}():fo++,"0x"+fo.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(t){this.co=t.co,this.lo=t.lo}ho(t){this.Po=t}Io(t){this.To=t}onMessage(t){this.Eo=t}close(){this.lo()}send(t){this.co(t)}Ao(){this.Po()}Ro(t){this.To(t)}Vo(t){this.Eo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class SC extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const i=e.ssl?"https":"http",o=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.mo=i+"://"+e.host,this.fo=`projects/${o}/databases/${a}`,this.po=this.databaseId.database==="(default)"?`project_id=${o}`:`project_id=${o}&database_id=${a}`}get yo(){return!1}wo(e,i,o,a,l){const h=Qu(),d=this.So(e,i);M("RestConnection",`Sending RPC '${e}' ${h}:`,d,o);const m={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(m,a,l),this.Do(e,d,m,o).then(_=>(M("RestConnection",`Received RPC '${e}' ${h}: `,_),_),_=>{throw Dr("RestConnection",`RPC '${e}' ${h} failed with error: `,_,"url: ",d,"request:",o),_})}Co(e,i,o,a,l,h){return this.wo(e,i,o,a,l)}bo(e,i,o){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Br}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((a,l)=>e[l]=a),o&&o.headers.forEach((a,l)=>e[l]=a)}So(e,i){const o=AC[e];return`${this.mo}/v1/${i}:${o}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Do(t,e,i,o){const a=Qu();return new Promise((l,h)=>{const d=new OR;d.setWithCredentials(!0),d.listenOnce(xR.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Hu.NO_ERROR:const _=d.getResponseJson();M(Yt,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(_)),l(_);break;case Hu.TIMEOUT:M(Yt,`RPC '${t}' ${a} timed out`),h(new L(C.DEADLINE_EXCEEDED,"Request time out"));break;case Hu.HTTP_ERROR:const w=d.getStatus();if(M(Yt,`RPC '${t}' ${a} failed with status:`,w,"response text:",d.getResponseText()),w>0){let P=d.getResponseJson();Array.isArray(P)&&(P=P[0]);const x=P==null?void 0:P.error;if(x&&x.status&&x.message){const z=function(F){const lt=F.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(lt)>=0?lt:C.UNKNOWN}(x.status);h(new L(z,x.message))}else h(new L(C.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new L(C.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{M(Yt,`RPC '${t}' ${a} completed.`)}});const m=JSON.stringify(o);M(Yt,`RPC '${t}' ${a} sending request:`,o),d.send(e,"POST",m,i,15)})}vo(t,e,i){const o=Qu(),a=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=VR(),h=DR(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.xmlHttpFactory=new NR({})),this.bo(d.initMessageHeaders,e,i),d.encodeInitMessageHeaders=!0;const _=a.join("");M(Yt,`Creating RPC '${t}' stream ${o}: ${_}`,d);const w=l.createWebChannel(_,d);let P=!1,x=!1;const z=new RC({co:F=>{x?M(Yt,`Not sending because RPC '${t}' stream ${o} is closed:`,F):(P||(M(Yt,`Opening RPC '${t}' stream ${o} transport.`),w.open(),P=!0),M(Yt,`RPC '${t}' stream ${o} sending:`,F),w.send(F))},lo:()=>w.close()}),X=(F,lt,bt)=>{F.listen(lt,yt=>{try{bt(yt)}catch(Ht){setTimeout(()=>{throw Ht},0)}})};return X(w,lo.EventType.OPEN,()=>{x||M(Yt,`RPC '${t}' stream ${o} transport opened.`)}),X(w,lo.EventType.CLOSE,()=>{x||(x=!0,M(Yt,`RPC '${t}' stream ${o} transport closed`),z.Ro())}),X(w,lo.EventType.ERROR,F=>{x||(x=!0,Dr(Yt,`RPC '${t}' stream ${o} transport errored:`,F),z.Ro(new L(C.UNAVAILABLE,"The operation could not be completed")))}),X(w,lo.EventType.MESSAGE,F=>{var lt;if(!x){const bt=F.data[0];_t(!!bt);const yt=bt,Ht=yt.error||((lt=yt[0])===null||lt===void 0?void 0:lt.error);if(Ht){M(Yt,`RPC '${t}' stream ${o} received error:`,Ht);const Kt=Ht.status;let ye=function(Gr){const as=St[Gr];if(as!==void 0)return em(as)}(Kt),ve=Ht.message;ye===void 0&&(ye=C.INTERNAL,ve="Unknown error status: "+Kt+" with message "+Ht.message),x=!0,z.Ro(new L(ye,ve)),w.close()}else M(Yt,`RPC '${t}' stream ${o} received:`,bt),z.Vo(bt)}}),X(h,bR.STAT_EVENT,F=>{F.stat===Dd.PROXY?M(Yt,`RPC '${t}' stream ${o} detected buffering proxy`):F.stat===Dd.NOPROXY&&M(Yt,`RPC '${t}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{z.Ao()},0),z}}function ju(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(n){return new kS(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(t,e,i=1e3,o=1.5,a=6e4){this.si=t,this.timerId=e,this.Fo=i,this.Mo=o,this.xo=a,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(t){this.cancel();const e=Math.floor(this.Oo+this.qo()),i=Math.max(0,Date.now()-this.Bo),o=Math.max(0,e-i);o>0&&M("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.Oo} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,o,()=>(this.Bo=Date.now(),t())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(t,e,i,o,a,l,h,d){this.si=t,this.Ko=i,this.$o=o,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new fm(t,e)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(t){this.t_(),this.stream.send(t)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(t,e){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,t!==4?this.zo.reset():e&&e.code===C.RESOURCE_EXHAUSTED?(hn(e.toString()),hn("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):e&&e.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Io(e)}r_(){}auth(){this.state=1;const t=this.i_(this.Uo),e=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,o])=>{this.Uo===e&&this.s_(i,o)},i=>{t(()=>{const o=new L(C.UNKNOWN,"Fetching auth token failed: "+i.message);return this.o_(o)})})}s_(t,e){const i=this.i_(this.Uo);this.stream=this.__(t,e),this.stream.ho(()=>{i(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(o=>{i(()=>this.o_(o))}),this.stream.onMessage(o=>{i(()=>this.onMessage(o))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(t){return M("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}i_(t){return e=>{this.si.enqueueAndForget(()=>this.Uo===t?e():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class CC extends dm{constructor(t,e,i,o,a,l){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,o,l),this.serializer=a}__(t,e){return this.connection.vo("Listen",t,e)}onMessage(t){this.zo.reset();const e=BS(this.serializer,t),i=function(a){if(!("targetChange"in a))return K.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?K.min():l.readTime?Ye(l.readTime):K.min()}(t);return this.listener.a_(e,i)}u_(t){const e={};e.database=Al(this.serializer),e.addTarget=function(a,l){let h;const d=l.target;if(h=yl(d)?{documents:WS(a,d)}:{query:zS(a,d)},h.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){h.resumeToken=im(a,l.resumeToken);const m=Tl(a,l.expectedCount);m!==null&&(h.expectedCount=m)}else if(l.snapshotVersion.compareTo(K.min())>0){h.readTime=Mo(a,l.snapshotVersion.toTimestamp());const m=Tl(a,l.expectedCount);m!==null&&(h.expectedCount=m)}return h}(this.serializer,t);const i=HS(this.serializer,t);i&&(e.labels=i),this.e_(e)}c_(t){const e={};e.database=Al(this.serializer),e.removeTarget=t,this.e_(e)}}class PC extends dm{constructor(t,e,i,o,a,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,o,l),this.serializer=a,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(t,e){return this.connection.vo("Write",t,e)}onMessage(t){if(_t(!!t.streamToken),this.lastStreamToken=t.streamToken,this.l_){this.zo.reset();const e=$S(t.writeResults,t.commitTime),i=Ye(t.commitTime);return this.listener.I_(i,e)}return _t(!t.writeResults||t.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const t={};t.database=Al(this.serializer),this.e_(t)}P_(t){const e={streamToken:this.lastStreamToken,writes:t.map(i=>qS(this.serializer,i))};this.e_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC extends class{}{constructor(t,e,i,o){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=o,this.d_=!1}A_(){if(this.d_)throw new L(C.FAILED_PRECONDITION,"The client has already been terminated.")}wo(t,e,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.wo(t,e,i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new L(C.UNKNOWN,o.toString())})}Co(t,e,i,o){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Co(t,e,i,a,l,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(C.UNKNOWN,a.toString())})}terminate(){this.d_=!0}}class DC{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(t){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.p_("Offline")))}set(t){this.S_(),this.V_=0,t==="Online"&&(this.f_=!1),this.p_(t)}p_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}y_(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(hn(e),this.f_=!1):M("OnlineStateTracker",e)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(t,e,i,o,a){this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=a,this.F_.ro(l=>{i.enqueueAndForget(async()=>{er(this)&&(M("RemoteStore","Restarting streams for network reachability change."),await async function(d){const m=j(d);m.C_.add(4),await is(m),m.M_.set("Unknown"),m.C_.delete(4),await oa(m)}(this))})}),this.M_=new DC(i,o)}}async function oa(n){if(er(n))for(const t of n.v_)await t(!0)}async function is(n){for(const t of n.v_)await t(!1)}function gm(n,t){const e=j(n);e.D_.has(t.targetId)||(e.D_.set(t.targetId,t),dc(e)?fc(e):Wr(e).Ho()&&hc(e,t))}function pm(n,t){const e=j(n),i=Wr(e);e.D_.delete(t),i.Ho()&&mm(e,t),e.D_.size===0&&(i.Ho()?i.Zo():er(e)&&e.M_.set("Unknown"))}function hc(n,t){if(n.x_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(K.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Wr(n).u_(t)}function mm(n,t){n.x_.Oe(t),Wr(n).c_(t)}function fc(n){n.x_=new NS({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>n.D_.get(t)||null,nt:()=>n.datastore.serializer.databaseId}),Wr(n).start(),n.M_.g_()}function dc(n){return er(n)&&!Wr(n).jo()&&n.D_.size>0}function er(n){return j(n).C_.size===0}function _m(n){n.x_=void 0}async function bC(n){n.D_.forEach((t,e)=>{hc(n,t)})}async function NC(n,t){_m(n),dc(n)?(n.M_.w_(t),fc(n)):n.M_.set("Unknown")}async function OC(n,t,e){if(n.M_.set("Online"),t instanceof rm&&t.state===2&&t.cause)try{await async function(o,a){const l=a.cause;for(const h of a.targetIds)o.D_.has(h)&&(await o.remoteSyncer.rejectListen(h,l),o.D_.delete(h),o.x_.removeTarget(h))}(n,t)}catch(i){M("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),await Lo(n,i)}else if(t instanceof _o?n.x_.$e(t):t instanceof nm?n.x_.Je(t):n.x_.Ge(t),!e.isEqual(K.min()))try{const i=await hm(n.localStore);e.compareTo(i)>=0&&await function(a,l){const h=a.x_.it(l);return h.targetChanges.forEach((d,m)=>{if(d.resumeToken.approximateByteSize()>0){const _=a.D_.get(m);_&&a.D_.set(m,_.withResumeToken(d.resumeToken,l))}}),h.targetMismatches.forEach((d,m)=>{const _=a.D_.get(d);if(!_)return;a.D_.set(d,_.withResumeToken(ee.EMPTY_BYTE_STRING,_.snapshotVersion)),mm(a,d);const w=new In(_.target,d,m,_.sequenceNumber);hc(a,w)}),a.remoteSyncer.applyRemoteEvent(h)}(n,e)}catch(i){M("RemoteStore","Failed to raise snapshot:",i),await Lo(n,i)}}async function Lo(n,t,e){if(!ts(t))throw t;n.C_.add(1),await is(n),n.M_.set("Offline"),e||(e=()=>hm(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{M("RemoteStore","Retrying IndexedDB access"),await e(),n.C_.delete(1),await oa(n)})}function ym(n,t){return t().catch(e=>Lo(n,e,t))}async function aa(n){const t=j(n),e=Dn(t);let i=t.b_.length>0?t.b_[t.b_.length-1].batchId:-1;for(;MC(t);)try{const o=await vC(t.localStore,i);if(o===null){t.b_.length===0&&e.Zo();break}i=o.batchId,LC(t,o)}catch(o){await Lo(t,o)}vm(t)&&Em(t)}function MC(n){return er(n)&&n.b_.length<10}function LC(n,t){n.b_.push(t);const e=Dn(n);e.Ho()&&e.h_&&e.P_(t.mutations)}function vm(n){return er(n)&&!Dn(n).jo()&&n.b_.length>0}function Em(n){Dn(n).start()}async function kC(n){Dn(n).E_()}async function FC(n){const t=Dn(n);for(const e of n.b_)t.P_(e.mutations)}async function UC(n,t,e){const i=n.b_.shift(),o=sc.from(i,t,e);await ym(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await aa(n)}async function BC(n,t){t&&Dn(n).h_&&await async function(i,o){if(function(l){return DS(l)&&l!==C.ABORTED}(o.code)){const a=i.b_.shift();Dn(i).Yo(),await ym(i,()=>i.remoteSyncer.rejectFailedWrite(a.batchId,o)),await aa(i)}}(n,t),vm(n)&&Em(n)}async function eg(n,t){const e=j(n);e.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");const i=er(e);e.C_.add(3),await is(e),i&&e.M_.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.C_.delete(3),await oa(e)}async function qC(n,t){const e=j(n);t?(e.C_.delete(2),await oa(e)):t||(e.C_.add(2),await is(e),e.M_.set("Unknown"))}function Wr(n){return n.O_||(n.O_=function(e,i,o){const a=j(e);return a.A_(),new CC(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{ho:bC.bind(null,n),Io:NC.bind(null,n),a_:OC.bind(null,n)}),n.v_.push(async t=>{t?(n.O_.Yo(),dc(n)?fc(n):n.M_.set("Unknown")):(await n.O_.stop(),_m(n))})),n.O_}function Dn(n){return n.N_||(n.N_=function(e,i,o){const a=j(e);return a.A_(),new PC(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{ho:kC.bind(null,n),Io:BC.bind(null,n),T_:FC.bind(null,n),I_:UC.bind(null,n)}),n.v_.push(async t=>{t?(n.N_.Yo(),await aa(n)):(await n.N_.stop(),n.b_.length>0&&(M("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))})),n.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(t,e,i,o,a){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=o,this.removalCallback=a,this.deferred=new Sn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,o,a){const l=Date.now()+i,h=new gc(t,e,l,o,a);return h.start(i),h}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(C.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pc(n,t){if(hn("AsyncQueue",`${t}: ${n}`),ts(n))return new L(C.UNAVAILABLE,`${t}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(t){this.comparator=t?(e,i)=>t(e,i)||U.comparator(e.key,i.key):(e,i)=>U.comparator(e.key,i.key),this.keyedMap=Ti(),this.sortedSet=new Tt(this.comparator)}static emptySet(t){return new Cr(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,i)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Cr)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){const o=e.getNext().key,a=i.getNext().key;if(!o.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const i=new Cr;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(){this.B_=new Tt(U.comparator)}track(t){const e=t.doc.key,i=this.B_.get(e);i?t.type!==0&&i.type===3?this.B_=this.B_.insert(e,t):t.type===3&&i.type!==1?this.B_=this.B_.insert(e,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.B_=this.B_.insert(e,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.B_=this.B_.insert(e,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.B_=this.B_.remove(e):t.type===1&&i.type===2?this.B_=this.B_.insert(e,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.B_=this.B_.insert(e,{type:2,doc:t.doc}):W():this.B_=this.B_.insert(e,t)}L_(){const t=[];return this.B_.inorderTraversal((e,i)=>{t.push(i)}),t}}class Mr{constructor(t,e,i,o,a,l,h,d,m){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(t,e,i,o,a){const l=[];return e.forEach(h=>{l.push({type:0,doc:h})}),new Mr(t,e,Cr.emptySet(e),l,i,o,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ta(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let o=0;o<e.length;o++)if(e[o].type!==i[o].type||!e[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(){this.k_=void 0,this.listeners=[]}}class WC{constructor(){this.queries=new $r(t=>$p(t),ta),this.onlineState="Unknown",this.q_=new Set}}async function zC(n,t){const e=j(n),i=t.query;let o=!1,a=e.queries.get(i);if(a||(o=!0,a=new $C),o)try{a.k_=await e.onListen(i)}catch(l){const h=pc(l,`Initialization of query '${Er(t.query)}' failed`);return void t.onError(h)}e.queries.set(i,a),a.listeners.push(t),t.Q_(e.onlineState),a.k_&&t.K_(a.k_)&&mc(e)}async function GC(n,t){const e=j(n),i=t.query;let o=!1;const a=e.queries.get(i);if(a){const l=a.listeners.indexOf(t);l>=0&&(a.listeners.splice(l,1),o=a.listeners.length===0)}if(o)return e.queries.delete(i),e.onUnlisten(i)}function HC(n,t){const e=j(n);let i=!1;for(const o of t){const a=o.query,l=e.queries.get(a);if(l){for(const h of l.listeners)h.K_(o)&&(i=!0);l.k_=o}}i&&mc(e)}function KC(n,t,e){const i=j(n),o=i.queries.get(t);if(o)for(const a of o.listeners)a.onError(e);i.queries.delete(t)}function mc(n){n.q_.forEach(t=>{t.next()})}class QC{constructor(t,e,i){this.query=t,this.U_=e,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=i||{}}K_(t){if(!this.options.includeMetadataChanges){const i=[];for(const o of t.docChanges)o.type!==3&&i.push(o);t=new Mr(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.W_?this.z_(t)&&(this.U_.next(t),e=!0):this.j_(t,this.onlineState)&&(this.H_(t),e=!0),this.G_=t,e}onError(t){this.U_.error(t)}Q_(t){this.onlineState=t;let e=!1;return this.G_&&!this.W_&&this.j_(this.G_,t)&&(this.H_(this.G_),e=!0),e}j_(t,e){if(!t.fromCache)return!0;const i=e!=="Offline";return(!this.options.J_||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}z_(t){if(t.docChanges.length>0)return!0;const e=this.G_&&this.G_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}H_(t){t=Mr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.W_=!0,this.U_.next(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(t){this.key=t}}class wm{constructor(t){this.key=t}}class jC{constructor(t,e){this.query=t,this.ia=e,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=nt(),this.mutatedKeys=nt(),this._a=Wp(t),this.aa=new Cr(this._a)}get ua(){return this.ia}ca(t,e){const i=e?e.la:new ng,o=e?e.aa:this.aa;let a=e?e.mutatedKeys:this.mutatedKeys,l=o,h=!1;const d=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(t.inorderTraversal((_,w)=>{const P=o.get(_),x=ea(this.query,w)?w:null,z=!!P&&this.mutatedKeys.has(P.key),X=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let F=!1;P&&x?P.data.isEqual(x.data)?z!==X&&(i.track({type:3,doc:x}),F=!0):this.ha(P,x)||(i.track({type:2,doc:x}),F=!0,(d&&this._a(x,d)>0||m&&this._a(x,m)<0)&&(h=!0)):!P&&x?(i.track({type:0,doc:x}),F=!0):P&&!x&&(i.track({type:1,doc:P}),F=!0,(d||m)&&(h=!0)),F&&(x?(l=l.add(x),a=X?a.add(_):a.delete(_)):(l=l.delete(_),a=a.delete(_)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),a=a.delete(_.key),i.track({type:1,doc:_})}return{aa:l,la:i,Zi:h,mutatedKeys:a}}ha(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i){const o=this.aa;this.aa=t.aa,this.mutatedKeys=t.mutatedKeys;const a=t.la.L_();a.sort((m,_)=>function(P,x){const z=X=>{switch(X){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return z(P)-z(x)}(m.type,_.type)||this._a(m.doc,_.doc)),this.Pa(i);const l=e?this.Ia():[],h=this.oa.size===0&&this.current?1:0,d=h!==this.sa;return this.sa=h,a.length!==0||d?{snapshot:new Mr(this.query,t.aa,o,a,t.mutatedKeys,h===0,d,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ta:l}:{Ta:l}}Q_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new ng,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(t){return!this.ia.has(t)&&!!this.aa.has(t)&&!this.aa.get(t).hasLocalMutations}Pa(t){t&&(t.addedDocuments.forEach(e=>this.ia=this.ia.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.ia=this.ia.delete(e)),this.current=t.current)}Ia(){if(!this.current)return[];const t=this.oa;this.oa=nt(),this.aa.forEach(i=>{this.Ea(i.key)&&(this.oa=this.oa.add(i.key))});const e=[];return t.forEach(i=>{this.oa.has(i)||e.push(new wm(i))}),this.oa.forEach(i=>{t.has(i)||e.push(new Tm(i))}),e}da(t){this.ia=t.ls,this.oa=nt();const e=this.ca(t.documents);return this.applyChanges(e,!0)}Aa(){return Mr.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class YC{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}}class XC{constructor(t){this.key=t,this.Ra=!1}}class JC{constructor(t,e,i,o,a,l){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=o,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Va={},this.ma=new $r(h=>$p(h),ta),this.fa=new Map,this.ga=new Set,this.pa=new Tt(U.comparator),this.ya=new Map,this.wa=new uc,this.Sa={},this.ba=new Map,this.Da=Or.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function ZC(n,t){const e=lP(n);let i,o;const a=e.ma.get(t);if(a)i=a.targetId,e.sharedClientState.addLocalQueryTarget(i),o=a.view.Aa();else{const l=await EC(e.localStore,je(t)),h=e.sharedClientState.addLocalQueryTarget(l.targetId);i=l.targetId,o=await tP(e,t,i,h==="current",l.resumeToken),e.isPrimaryClient&&gm(e.remoteStore,l)}return o}async function tP(n,t,e,i,o){n.va=(w,P,x)=>async function(X,F,lt,bt){let yt=F.view.ca(lt);yt.Zi&&(yt=await Jd(X.localStore,F.query,!1).then(({documents:ye})=>F.view.ca(ye,yt)));const Ht=bt&&bt.targetChanges.get(F.targetId),Kt=F.view.applyChanges(yt,X.isPrimaryClient,Ht);return ig(X,F.targetId,Kt.Ta),Kt.snapshot}(n,w,P,x);const a=await Jd(n.localStore,t,!0),l=new jC(t,a.ls),h=l.ca(a.documents),d=rs.createSynthesizedTargetChangeForCurrentChange(e,i&&n.onlineState!=="Offline",o),m=l.applyChanges(h,n.isPrimaryClient,d);ig(n,e,m.Ta);const _=new YC(t,e,l);return n.ma.set(t,_),n.fa.has(e)?n.fa.get(e).push(t):n.fa.set(e,[t]),m.snapshot}async function eP(n,t){const e=j(n),i=e.ma.get(t),o=e.fa.get(i.targetId);if(o.length>1)return e.fa.set(i.targetId,o.filter(a=>!ta(a,t))),void e.ma.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(i.targetId),e.sharedClientState.isActiveQueryTarget(i.targetId)||await Rl(e.localStore,i.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(i.targetId),pm(e.remoteStore,i.targetId),Sl(e,i.targetId)}).catch(Zi)):(Sl(e,i.targetId),await Rl(e.localStore,i.targetId,!0))}async function nP(n,t,e){const i=cP(n);try{const o=await function(l,h){const d=j(l),m=xt.now(),_=h.reduce((x,z)=>x.add(z.key),nt());let w,P;return d.persistence.runTransaction("Locally write mutations","readwrite",x=>{let z=fn(),X=nt();return d.ss.getEntries(x,_).next(F=>{z=F,z.forEach((lt,bt)=>{bt.isValidDocument()||(X=X.add(lt))})}).next(()=>d.localDocuments.getOverlayedDocuments(x,z)).next(F=>{w=F;const lt=[];for(const bt of h){const yt=RS(bt,w.get(bt.key).overlayedDocument);yt!=null&&lt.push(new tr(bt.key,yt,Np(yt.value.mapValue),Fe.exists(!0)))}return d.mutationQueue.addMutationBatch(x,m,lt,h)}).next(F=>{P=F;const lt=F.applyToLocalDocumentSet(w,X);return d.documentOverlayCache.saveOverlays(x,F.batchId,lt)})}).then(()=>({batchId:P.batchId,changes:Gp(w)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(o.batchId),function(l,h,d){let m=l.Sa[l.currentUser.toKey()];m||(m=new Tt(at)),m=m.insert(h,d),l.Sa[l.currentUser.toKey()]=m}(i,o.batchId,e),await ss(i,o.changes),await aa(i.remoteStore)}catch(o){const a=pc(o,"Failed to persist write");e.reject(a)}}async function Im(n,t){const e=j(n);try{const i=await _C(e.localStore,t);t.targetChanges.forEach((o,a)=>{const l=e.ya.get(a);l&&(_t(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1),o.addedDocuments.size>0?l.Ra=!0:o.modifiedDocuments.size>0?_t(l.Ra):o.removedDocuments.size>0&&(_t(l.Ra),l.Ra=!1))}),await ss(e,i,t)}catch(i){await Zi(i)}}function rg(n,t,e){const i=j(n);if(i.isPrimaryClient&&e===0||!i.isPrimaryClient&&e===1){const o=[];i.ma.forEach((a,l)=>{const h=l.view.Q_(t);h.snapshot&&o.push(h.snapshot)}),function(l,h){const d=j(l);d.onlineState=h;let m=!1;d.queries.forEach((_,w)=>{for(const P of w.listeners)P.Q_(h)&&(m=!0)}),m&&mc(d)}(i.eventManager,t),o.length&&i.Va.a_(o),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function rP(n,t,e){const i=j(n);i.sharedClientState.updateQueryState(t,"rejected",e);const o=i.ya.get(t),a=o&&o.key;if(a){let l=new Tt(U.comparator);l=l.insert(a,Jt.newNoDocument(a,K.min()));const h=nt().add(a),d=new ia(K.min(),new Map,new Tt(at),l,h);await Im(i,d),i.pa=i.pa.remove(a),i.ya.delete(t),_c(i)}else await Rl(i.localStore,t,!1).then(()=>Sl(i,t,e)).catch(Zi)}async function iP(n,t){const e=j(n),i=t.batch.batchId;try{const o=await mC(e.localStore,t);Rm(e,i,null),Am(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await ss(e,o)}catch(o){await Zi(o)}}async function sP(n,t,e){const i=j(n);try{const o=await function(l,h){const d=j(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let _;return d.mutationQueue.lookupMutationBatch(m,h).next(w=>(_t(w!==null),_=w.keys(),d.mutationQueue.removeMutationBatch(m,w))).next(()=>d.mutationQueue.performConsistencyCheck(m)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(m,_,h)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_)).next(()=>d.localDocuments.getDocuments(m,_))})}(i.localStore,t);Rm(i,t,e),Am(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),await ss(i,o)}catch(o){await Zi(o)}}function Am(n,t){(n.ba.get(t)||[]).forEach(e=>{e.resolve()}),n.ba.delete(t)}function Rm(n,t,e){const i=j(n);let o=i.Sa[i.currentUser.toKey()];if(o){const a=o.get(t);a&&(e?a.reject(e):a.resolve(),o=o.remove(t)),i.Sa[i.currentUser.toKey()]=o}}function Sl(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.fa.get(t))n.ma.delete(i),e&&n.Va.Fa(i,e);n.fa.delete(t),n.isPrimaryClient&&n.wa.Rr(t).forEach(i=>{n.wa.containsKey(i)||Sm(n,i)})}function Sm(n,t){n.ga.delete(t.path.canonicalString());const e=n.pa.get(t);e!==null&&(pm(n.remoteStore,e),n.pa=n.pa.remove(t),n.ya.delete(e),_c(n))}function ig(n,t,e){for(const i of e)i instanceof Tm?(n.wa.addReference(i.key,t),oP(n,i)):i instanceof wm?(M("SyncEngine","Document no longer in limbo: "+i.key),n.wa.removeReference(i.key,t),n.wa.containsKey(i.key)||Sm(n,i.key)):W()}function oP(n,t){const e=t.key,i=e.path.canonicalString();n.pa.get(e)||n.ga.has(i)||(M("SyncEngine","New document in limbo: "+e),n.ga.add(i),_c(n))}function _c(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const t=n.ga.values().next().value;n.ga.delete(t);const e=new U(mt.fromString(t)),i=n.Da.next();n.ya.set(i,new XC(e)),n.pa=n.pa.insert(e,i),gm(n.remoteStore,new In(je(Bp(e.path)),i,"TargetPurposeLimboResolution",Jl._e))}}async function ss(n,t,e){const i=j(n),o=[],a=[],l=[];i.ma.isEmpty()||(i.ma.forEach((h,d)=>{l.push(i.va(d,t,e).then(m=>{if((m||e)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(d.targetId,m!=null&&m.fromCache?"not-current":"current"),m){o.push(m);const _=cc.Qi(d.targetId,m);a.push(_)}}))}),await Promise.all(l),i.Va.a_(o),await async function(d,m){const _=j(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>D.forEach(m,P=>D.forEach(P.ki,x=>_.persistence.referenceDelegate.addReference(w,P.targetId,x)).next(()=>D.forEach(P.qi,x=>_.persistence.referenceDelegate.removeReference(w,P.targetId,x)))))}catch(w){if(!ts(w))throw w;M("LocalStore","Failed to update sequence numbers: "+w)}for(const w of m){const P=w.targetId;if(!w.fromCache){const x=_.ts.get(P),z=x.snapshotVersion,X=x.withLastLimboFreeSnapshotVersion(z);_.ts=_.ts.insert(P,X)}}}(i.localStore,a))}async function aP(n,t){const e=j(n);if(!e.currentUser.isEqual(t)){M("SyncEngine","User change. New user:",t.toKey());const i=await cm(e.localStore,t);e.currentUser=t,function(a,l){a.ba.forEach(h=>{h.forEach(d=>{d.reject(new L(C.CANCELLED,l))})}),a.ba.clear()}(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await ss(e,i._s)}}function uP(n,t){const e=j(n),i=e.ya.get(t);if(i&&i.Ra)return nt().add(i.key);{let o=nt();const a=e.fa.get(t);if(!a)return o;for(const l of a){const h=e.ma.get(l);o=o.unionWith(h.view.ua)}return o}}function lP(n){const t=j(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=Im.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=uP.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=rP.bind(null,t),t.Va.a_=HC.bind(null,t.eventManager),t.Va.Fa=KC.bind(null,t.eventManager),t}function cP(n){const t=j(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=iP.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=sP.bind(null,t),t}class sg{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=sa(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return pC(this.persistence,new dC,t.initialUser,this.serializer)}createPersistence(t){return new cC(lc.jr,this.serializer)}createSharedClientState(t){return new wC}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class hP{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>rg(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=aP.bind(null,this.syncEngine),await qC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new WC}()}createDatastore(t){const e=sa(t.databaseInfo.databaseId),i=function(a){return new SC(a)}(t.databaseInfo);return function(a,l,h,d){return new VC(a,l,h,d)}(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return function(i,o,a,l,h){return new xC(i,o,a,l,h)}(this.localStore,this.datastore,t.asyncQueue,e=>rg(this.syncEngine,e,0),function(){return tg.D()?new tg:new IC}())}createSyncEngine(t,e){return function(o,a,l,h,d,m,_){const w=new JC(o,a,l,h,d,m);return _&&(w.Ca=!0),w}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(e){const i=j(e);M("RemoteStore","RemoteStore shutting down."),i.C_.add(5),await is(i),i.F_.shutdown(),i.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Oa(this.observer.next,t)}error(t){this.observer.error?this.Oa(this.observer.error,t):hn("Uncaught Error in snapshot listener:",t.toString())}Na(){this.muted=!0}Oa(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(t,e,i,o){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=o,this.user=Xt.UNAUTHENTICATED,this.clientId=Dp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,async a=>{M("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(i,a=>(M("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new L(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Sn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const i=pc(e,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function Yu(n,t){n.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");const e=await n.getConfiguration();await t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener(async o=>{i.isEqual(o)||(await cm(t.localStore,o),i=o)}),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}async function og(n,t){n.asyncQueue.verifyOperationInProgress();const e=await pP(n);M("FirestoreClient","Initializing OnlineComponentProvider");const i=await n.getConfiguration();await t.initialize(e,i),n.setCredentialChangeListener(o=>eg(t.remoteStore,o)),n.setAppCheckTokenChangeListener((o,a)=>eg(t.remoteStore,a)),n._onlineComponents=t}function gP(n){return n.name==="FirebaseError"?n.code===C.FAILED_PRECONDITION||n.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function pP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M("FirestoreClient","Using user provided OfflineComponentProvider");try{await Yu(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!gP(e))throw e;Dr("Error using user provided cache. Falling back to memory cache: "+e),await Yu(n,new sg)}}else M("FirestoreClient","Using default OfflineComponentProvider"),await Yu(n,new sg);return n._offlineComponents}async function Cm(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(M("FirestoreClient","Using user provided OnlineComponentProvider"),await og(n,n._uninitializedComponentsProvider._online)):(M("FirestoreClient","Using default OnlineComponentProvider"),await og(n,new hP))),n._onlineComponents}function mP(n){return Cm(n).then(t=>t.syncEngine)}async function _P(n){const t=await Cm(n),e=t.eventManager;return e.onListen=ZC.bind(null,t.syncEngine),e.onUnlisten=eP.bind(null,t.syncEngine),e}function yP(n,t,e={}){const i=new Sn;return n.asyncQueue.enqueueAndForget(async()=>function(a,l,h,d,m){const _=new fP({next:P=>{l.enqueueAndForget(()=>GC(a,w)),P.fromCache&&d.source==="server"?m.reject(new L(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(P)},error:P=>m.reject(P)}),w=new QC(h,_,{includeMetadataChanges:!0,J_:!0});return zC(a,w)}(await _P(n),n.asyncQueue,t,e,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(n,t,e){if(!e)throw new L(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function vP(n,t,e,i){if(t===!0&&i===!0)throw new L(C.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function ug(n){if(!U.isDocumentKey(n))throw new L(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function lg(n){if(U.isDocumentKey(n))throw new L(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ua(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":W()}function Jn(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new L(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=ua(n);throw new L(C.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(t){var e,i;if(t.host===void 0){if(t.ssl!==void 0)throw new L(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(e=t.ssl)===null||e===void 0||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new L(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}vP("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Pm((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,o){return i.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class la{constructor(t,e,i,o){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new L(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new L(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cg(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new LR;switch(i.type){case"firstParty":return new BR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new L(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const i=ag.get(e);i&&(M("ComponentProvider","Removing Datastore"),ag.delete(e),i.terminate())}(this),Promise.resolve()}}function EP(n,t,e,i={}){var o;const a=(n=Jn(n,la))._getSettings(),l=`${t}:${e}`;if(a.host!=="firestore.googleapis.com"&&a.host!==l&&Dr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},a),{host:l,ssl:!1})),i.mockUserToken){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=Xt.MOCK_USER;else{h=dA(i.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new L(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Xt(m)}n._authCredentials=new kR(new Vp(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new zr(this.firestore,t,this._query)}}class me{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new me(this.firestore,t,this._key)}}class Cn extends zr{constructor(t,e,i){super(t,e,Bp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new me(this.firestore,null,new U(t))}withConverter(t){return new Cn(this.firestore,t,this._path)}}function hg(n,t,...e){if(n=Pr(n),Vm("collection","path",t),n instanceof la){const i=mt.fromString(t,...e);return lg(i),new Cn(n,null,i)}{if(!(n instanceof me||n instanceof Cn))throw new L(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(mt.fromString(t,...e));return lg(i),new Cn(n.firestore,null,i)}}function Cl(n,t,...e){if(n=Pr(n),arguments.length===1&&(t=Dp.newId()),Vm("doc","path",t),n instanceof la){const i=mt.fromString(t,...e);return ug(i),new me(n,null,new U(i))}{if(!(n instanceof me||n instanceof Cn))throw new L(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(mt.fromString(t,...e));return ug(i),new me(n.firestore,n instanceof Cn?n.converter:null,new U(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new fm(this,"async_queue_retry"),this.iu=()=>{const e=ju();e&&M("AsyncQueue","Visibility state changed to "+e.visibilityState),this.zo.Qo()};const t=ju();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.su(),this.ou(t)}enterRestrictedMode(t){if(!this.Za){this.Za=!0,this.nu=t||!1;const e=ju();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this.iu)}}enqueue(t){if(this.su(),this.Za)return new Promise(()=>{});const e=new Sn;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ya.push(t),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(t){if(!ts(t))throw t;M("AsyncQueue","Operation failed with retryable error: "+t)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(t){const e=this.Ja.then(()=>(this.tu=!0,t().catch(i=>{this.eu=i,this.tu=!1;const o=function(l){let h=l.message||"";return l.stack&&(h=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),h}(i);throw hn("INTERNAL UNHANDLED ERROR: ",o),i}).then(i=>(this.tu=!1,i))));return this.Ja=e,e}enqueueAfterDelay(t,e,i){this.su(),this.ru.indexOf(t)>-1&&(e=0);const o=gc.createAndSchedule(this,t,e,i,a=>this.au(a));return this.Xa.push(o),o}su(){this.eu&&W()}verifyOperationInProgress(){}async uu(){let t;do t=this.Ja,await t;while(t!==this.Ja)}cu(t){for(const e of this.Xa)if(e.timerId===t)return!0;return!1}lu(t){return this.uu().then(()=>{this.Xa.sort((e,i)=>e.targetTimeMs-i.targetTimeMs);for(const e of this.Xa)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.uu()})}hu(t){this.ru.push(t)}au(t){const e=this.Xa.indexOf(t);this.Xa.splice(e,1)}}class os extends la{constructor(t,e,i,o){super(t,e,i,o),this.type="firestore",this._queue=function(){return new TP}(),this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||xm(this),this._firestoreClient.terminate()}}function wP(n,t){const e=typeof n=="object"?n:_1(),i=typeof n=="string"?n:t||"(default)",o=d1(e,"firestore").getImmediate({identifier:i});if(!o._initialized){const a=hA("firestore");a&&EP(o,...a)}return o}function Dm(n){return n._firestoreClient||xm(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function xm(n){var t,e,i;const o=n._freezeSettings(),a=function(h,d,m,_){return new JR(h,d,m,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Pm(_.experimentalLongPollingOptions),_.useFetchStreams)}(n._databaseId,((t=n._app)===null||t===void 0?void 0:t.options.appId)||"",n._persistenceKey,o);n._firestoreClient=new dP(n._authCredentials,n._appCheckCredentials,n._queue,a),!((e=o.localCache)===null||e===void 0)&&e._offlineComponentProvider&&(!((i=o.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:o.localCache.kind,_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Lr(ee.fromBase64String(t))}catch(e){throw new L(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Lr(ee.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new L(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Wt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new L(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new L(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return at(this._lat,t._lat)||at(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP=/^__.*__$/;class AP{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new tr(t,this.data,this.fieldMask,e,this.fieldTransforms):new ns(t,this.data,e,this.fieldTransforms)}}function Nm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}class Ec{constructor(t,e,i,o,a,l){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=o,a===void 0&&this.Pu(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(t){return new Ec(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(t){var e;const i=(e=this.path)===null||e===void 0?void 0:e.child(t),o=this.Tu({path:i,du:!1});return o.Au(t),o}Ru(t){var e;const i=(e=this.path)===null||e===void 0?void 0:e.child(t),o=this.Tu({path:i,du:!1});return o.Pu(),o}Vu(t){return this.Tu({path:void 0,du:!0})}mu(t){return ko(t,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}Pu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Au(this.path.get(t))}Au(t){if(t.length===0)throw this.mu("Document fields must not be empty");if(Nm(this.Iu)&&IP.test(t))throw this.mu('Document fields cannot begin and end with "__"')}}class RP{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||sa(t)}pu(t,e,i,o=!1){return new Ec({Iu:t,methodName:e,gu:i,path:Wt.emptyPath(),du:!1,fu:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Tc(n){const t=n._freezeSettings(),e=sa(n._databaseId);return new RP(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Om(n,t,e,i,o,a={}){const l=n.pu(a.merge||a.mergeFields?2:0,t,e,o);km("Data must be an object, but it was:",l,i);const h=Mm(i,l);let d,m;if(a.merge)d=new ke(l.fieldMask),m=l.fieldTransforms;else if(a.mergeFields){const _=[];for(const w of a.mergeFields){const P=CP(t,w,e);if(!l.contains(P))throw new L(C.INVALID_ARGUMENT,`Field '${P}' is specified in your field mask but missing from your input data.`);VP(_,P)||_.push(P)}d=new ke(_),m=l.fieldTransforms.filter(w=>d.covers(w.field))}else d=null,m=l.fieldTransforms;return new AP(new Ve(h),d,m)}function SP(n,t,e,i=!1){return wc(e,n.pu(i?4:3,t))}function wc(n,t){if(Lm(n=Pr(n)))return km("Unsupported field value:",t,n),Mm(n,t);if(n instanceof bm)return function(i,o){if(!Nm(o.Iu))throw o.mu(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.mu(`${i._methodName}() is not currently supported inside arrays`);const a=i._toFieldTransform(o);a&&o.fieldTransforms.push(a)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.du&&t.Iu!==4)throw t.mu("Nested arrays are not supported");return function(i,o){const a=[];let l=0;for(const h of i){let d=wc(h,o.Vu(l));d==null&&(d={nullValue:"NULL_VALUE"}),a.push(d),l++}return{arrayValue:{values:a}}}(n,t)}return function(i,o){if((i=Pr(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return vS(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const a=xt.fromDate(i);return{timestampValue:Mo(o.serializer,a)}}if(i instanceof xt){const a=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Mo(o.serializer,a)}}if(i instanceof vc)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Lr)return{bytesValue:im(o.serializer,i._byteString)};if(i instanceof me){const a=o.databaseId,l=i.firestore._databaseId;if(!l.isEqual(a))throw o.mu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:ac(i.firestore._databaseId||o.databaseId,i._key.path)}}throw o.mu(`Unsupported field value: ${ua(i)}`)}(n,t)}function Mm(n,t){const e={};return xp(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):qr(n,(i,o)=>{const a=wc(o,t.Eu(i));a!=null&&(e[i]=a)}),{mapValue:{fields:e}}}function Lm(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xt||n instanceof vc||n instanceof Lr||n instanceof me||n instanceof bm)}function km(n,t,e){if(!Lm(e)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(e)){const i=ua(e);throw i==="an object"?t.mu(n+" a custom object"):t.mu(n+" "+i)}}function CP(n,t,e){if((t=Pr(t))instanceof yc)return t._internalPath;if(typeof t=="string")return Fm(n,t);throw ko("Field path arguments must be of type string or ",n,!1,void 0,e)}const PP=new RegExp("[~\\*/\\[\\]]");function Fm(n,t,e){if(t.search(PP)>=0)throw ko(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new yc(...t.split("."))._internalPath}catch{throw ko(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function ko(n,t,e,i,o){const a=i&&!i.isEmpty(),l=o!==void 0;let h=`Function ${t}() called with invalid data`;e&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(a||l)&&(d+=" (found",a&&(d+=` in field ${i}`),l&&(d+=` in document ${o}`),d+=")"),new L(C.INVALID_ARGUMENT,h+n+d)}function VP(n,t){return n.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(t,e,i,o,a){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=o,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new DP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Bm("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class DP extends Um{data(){return super.data()}}function Bm(n,t){return typeof t=="string"?Fm(n,t):t instanceof yc?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ic{}class bP extends Ic{}function NP(n,t,...e){let i=[];t instanceof Ic&&i.push(t),i=i.concat(e),function(a){const l=a.filter(d=>d instanceof Rc).length,h=a.filter(d=>d instanceof Ac).length;if(l>1||l>0&&h>0)throw new L(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const o of i)n=o._apply(n);return n}class Ac extends bP{constructor(t,e,i){super(),this._field=t,this._op=e,this._value=i,this.type="where"}static _create(t,e,i){return new Ac(t,e,i)}_apply(t){const e=this._parse(t);return qm(t._query,e),new zr(t.firestore,t.converter,vl(t._query,e))}_parse(t){const e=Tc(t.firestore);return function(a,l,h,d,m,_,w){let P;if(m.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new L(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){dg(w,_);const x=[];for(const z of w)x.push(fg(d,a,z));P={arrayValue:{values:x}}}else P=fg(d,a,w)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||dg(w,_),P=SP(h,l,w,_==="in"||_==="not-in");return Pt.create(m,_,P)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}class Rc extends Ic{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new Rc(t,e)}_parse(t){const e=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return e.length===1?e[0]:Be.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:(function(o,a){let l=o;const h=a.getFlattenedFilters();for(const d of h)qm(l,d),l=vl(l,d)}(t._query,e),new zr(t.firestore,t.converter,vl(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function fg(n,t,e){if(typeof(e=Pr(e))=="string"){if(e==="")throw new L(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!qp(t)&&e.indexOf("/")!==-1)throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const i=t.path.child(mt.fromString(e));if(!U.isDocumentKey(i))throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Md(n,new U(i))}if(e instanceof me)return Md(n,e._key);throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ua(e)}.`)}function dg(n,t){if(!Array.isArray(n)||n.length===0)throw new L(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function qm(n,t){const e=function(o,a){for(const l of o)for(const h of l.getFlattenedFilters())if(a.indexOf(h.op)>=0)return h.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(e!==null)throw e===t.op?new L(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new L(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class OP{convertValue(t,e="none"){switch(Xn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ct(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Yn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw W()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const i={};return qr(t,(o,a)=>{i[o]=this.convertValue(a,e)}),i}convertGeoPoint(t){return new vc(Ct(t.latitude),Ct(t.longitude))}convertArray(t,e){return(t.values||[]).map(i=>this.convertValue(i,e))}convertServerTimestamp(t,e){switch(e){case"previous":const i=tc(t);return i==null?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(Ui(t));default:return null}}convertTimestamp(t){const e=Vn(t);return new xt(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=mt.fromString(t);_t(lm(i));const o=new Bi(i.get(1),i.get(3)),a=new U(i.popFirst(5));return o.isEqual(e)||hn(`Document ${a} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(n,t,e){let i;return i=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class MP extends Um{constructor(t,e,i,o,a,l){super(t,e,i,o,l),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new yo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const i=this._document.data.field(Bm("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}}class yo extends MP{data(t={}){return super.data(t)}}class LP{constructor(t,e,i,o){this._firestore=t,this._userDataWriter=e,this._snapshot=o,this.metadata=new go(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach(i=>{t.call(e,new yo(this._firestore,this._userDataWriter,i.key,i,new go(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new L(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(o,a){if(o._snapshot.oldDocs.isEmpty()){let l=0;return o._snapshot.docChanges.map(h=>{const d=new yo(o._firestore,o._userDataWriter,h.doc.key,h.doc,new go(o._snapshot.mutatedKeys.has(h.doc.key),o._snapshot.fromCache),o.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}})}{let l=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(h=>a||h.type!==3).map(h=>{const d=new yo(o._firestore,o._userDataWriter,h.doc.key,h.doc,new go(o._snapshot.mutatedKeys.has(h.doc.key),o._snapshot.fromCache),o.query.converter);let m=-1,_=-1;return h.type!==0&&(m=l.indexOf(h.doc.key),l=l.delete(h.doc.key)),h.type!==1&&(l=l.add(h.doc),_=l.indexOf(h.doc.key)),{type:kP(h.type),doc:d,oldIndex:m,newIndex:_}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function kP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}class FP extends OP{constructor(t){super(),this.firestore=t}convertBytes(t){return new Lr(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new me(this.firestore,null,e)}}function UP(n){n=Jn(n,zr);const t=Jn(n.firestore,os),e=Dm(t),i=new FP(t);return xP(n._query),yP(e,n._query).then(o=>new LP(t,i,n,o))}function BP(n,t,e){n=Jn(n,me);const i=Jn(n.firestore,os),o=$m(n.converter,t,e);return Sc(i,[Om(Tc(i),"setDoc",n._key,o,n.converter!==null,e).toMutation(n._key,Fe.none())])}function qP(n){return Sc(Jn(n.firestore,os),[new ic(n._key,Fe.none())])}function $P(n,t){const e=Jn(n.firestore,os),i=Cl(n),o=$m(n.converter,t);return Sc(e,[Om(Tc(n.firestore),"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,Fe.exists(!1))]).then(()=>i)}function Sc(n,t){return function(i,o){const a=new Sn;return i.asyncQueue.enqueueAndForget(async()=>nP(await mP(i),o,a)),a.promise}(Dm(n),t)}(function(t,e=!0){(function(o){Br=o})(m1),wo(new Pi("firestore",(i,{instanceIdentifier:o,options:a})=>{const l=i.getProvider("app").getImmediate(),h=new os(new FR(i.getProvider("auth-internal")),new $R(i.getProvider("app-check-internal")),function(m,_){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new L(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bi(m.options.projectId,_)}(l,o),l);return a=Object.assign({useFetchStreams:e},a),h._setSettings(a),h},"PUBLIC").setMultipleInstances(!0)),Ar(xd,"4.3.2",t),Ar(xd,"4.3.2","esm2017")})();const WP=(n={})=>{n={collection:"",data:{},model:{id:!1,name:""},options:{},events:[],...n},n.data={...n.model};const t=kI(),e=wP(Ag(t.public.firebase)),i=gg({busy:!1,data:n.data,async create(){if(i.data.id||!1)return;const a=hg(e,n.collection),l=await $P(a,i.data);return i.data.id=l.id,i.eventDispatch("created"),i.eventDispatch("saved"),l},async update(){const o=i.data.id||!1;if(!o)return;const a=Cl(e,n.collection,o),l=await BP(a,i.data);return i.eventDispatch("updated"),i.eventDispatch("saved"),l},async save(){return i.data.id?i.update():i.create()},async delete(o={}){const a=o.id||!1;if(!a)return;const l=await qP(Cl(e,n.collection,a));return i.eventDispatch("deleted"),l},async setData(o){i.data={...n.model,...o}},async resetData(){i.data={...n.model}},async eventDispatch(o){i.events.forEach(([a,l])=>{a==o&&l()})},events:n.events,options:n.options,search:{busy:!1,params:{orderBy:"id",limit:25},data:[],pagination:{},async submit(){let o=[];const a=hg(e,n.collection),l=NP(a);(await UP(l)).forEach(d=>{o.push({...n.model,...d.data(),id:d.id})}),i.search.data=o}}});return i},zP=Ge("div",{style:{width:"5px"}},null,-1),GP=Ge("th",{style:{width:"50px"}},null,-1),HP=Ge("th",null,"Name",-1),KP=Ge("th",{style:{width:"50px"}},null,-1),QP=Ge("td",null,null,-1),jP={class:"d-flex pe-2",style:{gap:"10px"}},tV={__name:"crud",props:{model:{type:String,default:""},tableRowActions:{type:Object,default:()=>({})}},setup(n){const t=n,e=(d={})=>({...d}),i=WP(eA[t.model]||{});i.events.push(["saved",()=>{i.resetData(),i.search.submit(),h.hide()}]),i.events.push(["deleted",()=>{i.resetData(),i.search.submit()}]),i.search.submit();const o={VBtn:{size:35,flat:!0}},a=pg.merge({delete:{title:"Delete",icon:"mdi-delete",color:"error",onClick:(d,m)=>{}},edit:{title:"Edit",icon:"mdi-pencil",color:"primary",onClick(d,m){i.setData({...m.item}),h.show()}}},t.tableRowActions),l=(d,m)=>{if(typeof d=="object"){for(let _ in d){const w=d[_];typeof w=="function"&&(d[_]=P=>w(P,m))}return d}},h=gg({visible:!1,show(){h.visible=!0},hide(){h.visible=!1}});return(d,m)=>(eo(),xu("div",null,[Ut(zI,Ou({items:Le(i).search.data},Le(i).options.datatable),{top:Bt(()=>[Ut(FI,{flat:""},{append:Bt(()=>[Ut(gi,{icon:"mdi-plus",onClick:m[0]||(m[0]=_=>h.show())}),zP]),default:Bt(()=>[Ut(UI,null,{default:Bt(()=>[no(ro(Le(i).options.plural),1)]),_:1})]),_:1})]),headers:Bt(_=>[Ge("tr",null,[GP,bu(d.$slots,"table-header",io(Nu(e(_))),()=>[HP]),KP])]),item:Bt(_=>[Ge("tr",null,[QP,bu(d.$slots,"table-row",io(Nu(e(_))),()=>[Ge("td",null,ro(_.item.name),1)]),Ge("td",null,[Ut(od,{defaults:o},{default:Bt(()=>[Ut(BI,{location:"start"},{activator:Bt(w=>[Ut(gi,Ou({icon:"mdi-dots-horizontal"},w.props),null,16)]),default:Bt(()=>[Ut(od,{defaults:o},{default:Bt(()=>[Ge("div",jP,[(eo(!0),xu(ad,null,qI(Le(a),w=>(eo(),xu(ad,null,[w?(eo(),$I(gi,io(Ou({key:0},l(w,_))),null,16)):WI("",!0)],64))),256))])]),_:2},1024)]),_:2},1024)]),_:2},1024)])])]),_:3},16,["items"]),Ut(JI,{modelValue:h.visible,"onUpdate:modelValue":m[4]||(m[4]=_=>h.visible=_),location:"end",width:"600"},{default:Bt(()=>[Ut(GI,{onSubmit:m[3]||(m[3]=HI(_=>Le(i).save(),["prevent"]))},{default:Bt(()=>[Ut(KI,null,{default:Bt(()=>[no(ro(Le(i).data.id?"Edit":"Create")+" "+ro(Le(i).options.singular),1)]),_:1}),Ut(QI,null,{default:Bt(()=>[bu(d.$slots,"form",io(Nu(e({model:Le(i)}))),()=>[Ut(jI,{label:"Name",modelValue:Le(i).data.name,"onUpdate:modelValue":m[1]||(m[1]=_=>Le(i).data.name=_)},null,8,["modelValue"])])]),_:3}),Ut(YI,null,{default:Bt(()=>[Ut(gi,{onClick:m[2]||(m[2]=_=>{Le(i).resetData(),h.hide()})},{default:Bt(()=>[no("Close")]),_:1}),Ut(XI),Ut(gi,{type:"submit"},{default:Bt(()=>[no("Save")]),_:1})]),_:1})]),_:3})]),_:3},8,["modelValue"])]))}};export{tV as _,WP as u};
